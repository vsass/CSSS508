<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c3c2c9e745155556954bc4da23476b10.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<title>csss508_lecture5</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #97947a;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #97947a;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2b2b2b; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #dcc6e0; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #ffd700; } /* Attribute */
    code span.bn { color: #dcc6e0; } /* BaseN */
    code span.bu { color: #f5ab35; } /* BuiltIn */
    code span.cf { color: #ffa07a; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffa07a; } /* Constant */
    code span.co { color: #d4d0ab; } /* Comment */
    code span.cv { color: #d4d0ab; font-style: italic; } /* CommentVar */
    code span.do { color: #d4d0ab; font-style: italic; } /* Documentation */
    code span.dt { color: #dcc6e0; } /* DataType */
    code span.dv { color: #dcc6e0; } /* DecVal */
    code span.er { color: #dcc6e0; } /* Error */
    code span.ex { color: #ffd700; } /* Extension */
    code span.fl { color: #f5ab35; } /* Float */
    code span.fu { color: #ffd700; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; } /* Keyword */
    code span.op { color: #00e0e0; } /* Operator */
    code span.ot { color: #ffa07a; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.sc { color: #00e0e0; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #f5ab35; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #d4d0ab; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-6fe6460b726009f9af8cb90cbd032d82.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="title-slide" class="slide level2 center" data-menu-title="Importing, Exporting, and Cleaning Data" data-background="#1e4655" data-background-image="../../images/csss-logo.png" data-background-position="center top 5%" data-background-size="50%"><h2></h2>
<p><span class="custom-title">Importing, Exporting, &amp; Cleaning Data</span></p>
<p><span class="custom-subtitle">CS&amp;SS 508 • Lecture 5</span></p>
<p><span class="custom-subtitle2">28 October 2025</span></p>
<p><span class="custom-subtitle3">Victoria Sass</span></p>
</section><section><section id="roadmap" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Roadmap</h1>

</section><section class="slide level2"><div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<h3 id="last-time-we-learned">Last time, we learned:</h3>
<ul>
<li>Types of Data
<ul>
<li>Logical Operators</li>
</ul>
</li>
<li>Using <code>dplyr</code> to:
<ul>
<li>Subset data</li>
<li>Modify data</li>
<li>Summarize data</li>
<li>Merge data</li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<h3 id="today-we-will-cover">Today, we will cover:</h3>
<ul>
<li>Importing and Exporting Data</li>
<li>Tidying and Reshaping Data</li>
<li>Types of Data
<ul>
<li>Working with Factors</li>
<li>Wrangling Date/Date-Time Data</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/research_process_import.png" class="quarto-figure quarto-figure-center" style="width:7in"></p>
</figure>
</div>
</div>
</section><section id="office-hours" class="slide level2"><h2>Office Hours</h2>
<p>I’ll be holding office hours at a different day/time this week:</p>
<p><br></p>
<div class="r-stack">
<div class="fragment fade-down" data-fragment-index="1">
<div class="fragment grow" data-fragment-index="1">
<p><span style="color:#1e4655">Thursday (April 25th) from 10am - 12pm</span></p>
</div>
</div>
</div>
</section></section><section><section id="importing-and-exporting-data" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Importing and Exporting Data</h1>

</section><section id="data-packages" class="slide level2"><h2>Data Packages</h2>
<p>R has a <em>big</em> user base. If you are working with a popular data source, it will often have a devoted R package on <em>CRAN</em> or <em>Github</em>.</p>
<div class="fragment">
<p>Examples:</p>
<ul>
<li>
<a href="https://vincentarelbundock.github.io/WDI/"><code>WDI</code></a>: World Development Indicators (World Bank)</li>
<li>
<a href="https://walker-data.com/tidycensus/"><code>tidycensus</code></a>: Census and American Community Survey</li>
<li>
<a href="https://walker-data.com/tidycensus/"><code>quantmod</code></a>: financial data from Yahoo, FRED, Google</li>
<li>
<a href="https://kjhealy.github.io/gssr/"><code>gssr</code></a>: The General Social Survey Cumulative Data (1972-2021)</li>
<li>
<a href="https://github.com/floswald/psidR"><code>psidR</code></a>: Panel Study of Income Dynamics (basic &amp; public datasets)</li>
</ul>
</div>
<div class="fragment">
<p>If you have an actual data file, you’ll have to import it yourself…</p>
</div>
</section><section id="delimited-text-files" class="slide level2"><h2>Delimited Text Files</h2>
<p>Besides a package, it’s easiest when data is stored in a text file. The most commonly encountered delimited file is a <strong>.csv</strong>.</p>
<div class="fragment">
<p>A comma-separated values (.csv) file looks like the following:</p>
<pre><code>"Subject","Depression","Sex","Week","HamD","Imipramine"
101,"Non-endogenous","Second",0,26,NA
101,"Non-endogenous","Second",1,22,NA
101,"Non-endogenous","Second",2,18,4.04305
101,"Non-endogenous","Second",3,7,3.93183
101,"Non-endogenous","Second",4,4,4.33073
101,"Non-endogenous","Second",5,3,4.36945
103,"Non-endogenous","First",0,33,NA
103,"Non-endogenous","First",1,24,NA
103,"Non-endogenous","First",2,15,2.77259</code></pre>
</div>
</section></section><section><section id="section" class="title-slide slide level1 section-title center" data-menu-title="`readr``" data-background-image="images/readr.png" data-background-size="contain" data-background-position="center" data-background-color="#1e4655"><h1></h1>

</section><section id="readr" class="slide level2"><h2><code>readr</code></h2>
<p>R has some built-in functions for importing data, such as <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> and <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>.</p>
<div class="fragment">
<p>The <code>readr</code> package provides similar functions, like <code>read_csv()</code>, that have slightly better features:</p>
<ul>
<li class="fragment">Faster!</li>
<li class="fragment">Better defaults (e.g.&nbsp;doesn’t automatically convert characters to factors)</li>
<li class="fragment">A <em>bit</em> smarter about dates and times</li>
<li class="fragment">Loading progress bars for large files</li>
</ul>
</div>
<div class="fragment">
<p><code>readr</code> is one of the core <code>tidyverse</code> packages so loading <code>tidyverse</code> will load it too:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Alternatively, you can just load <code>readr</code> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="readr-importing-example" class="slide level2"><h2>
<code>readr</code> Importing Example</h2>
<p>Let’s import some data about song ranks on the Billboard Hot 100 in 2000:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>How do we know it loaded?</p>
</div>
<div class="fragment">
<p>Let’s look at it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">glimpse</span>(billboard_2000_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Rows: 317
&gt; Columns: 80
&gt; $ artist       &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 …
&gt; $ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Kr…
&gt; $ time         &lt;time&gt; 04:22:00, 03:15:00, 03:53:00, 04:24:00, 03:35:00, 03:24:…
&gt; $ date.entered &lt;date&gt; 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21, 2000-04-…
&gt; $ wk1          &lt;dbl&gt; 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, 50, 71, 7…
&gt; $ wk2          &lt;dbl&gt; 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, 39, 51, 6…
&gt; $ wk3          &lt;dbl&gt; 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, 30, 28, 5…
&gt; $ wk4          &lt;dbl&gt; 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, 28, 18, 4…
&gt; $ wk5          &lt;dbl&gt; 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23, 21, 13, …
&gt; $ wk6          &lt;dbl&gt; 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, 19, 13, 3…
&gt; $ wk7          &lt;dbl&gt; 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 20, 11, 34…
&gt; $ wk8          &lt;dbl&gt; NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17, 1, 29, …
&gt; $ wk9          &lt;dbl&gt; NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17, 1, 27, …
&gt; $ wk10         &lt;dbl&gt; NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 17, 2, 30,…
&gt; $ wk11         &lt;dbl&gt; NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17, 2, 36, N…
&gt; $ wk12         &lt;dbl&gt; NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3, 3, 37, N…
&gt; $ wk13         &lt;dbl&gt; NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3, 3, 39, N…
&gt; $ wk14         &lt;dbl&gt; NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7, 4, 49, N…
&gt; $ wk15         &lt;dbl&gt; NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10, 12, 57,…
&gt; $ wk16         &lt;dbl&gt; NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17, 11, 63,…
&gt; $ wk17         &lt;dbl&gt; NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 25, 13, 65…
&gt; $ wk18         &lt;dbl&gt; NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 29, 15, 68…
&gt; $ wk19         &lt;dbl&gt; NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 29, 18, 79…
&gt; $ wk20         &lt;dbl&gt; NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 40, 20, 86…
&gt; $ wk21         &lt;dbl&gt; NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 43, 30, NA…
&gt; $ wk22         &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50, 40, NA,…
&gt; $ wk23         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, 39, NA,…
&gt; $ wk24         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA, 44, NA,…
&gt; $ wk25         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, NA, NA, NA…
&gt; $ wk26         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, NA, NA, NA…
&gt; $ wk27         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, NA, NA, NA…
&gt; $ wk28         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, NA, NA, NA…
&gt; $ wk29         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, NA, NA, NA…
&gt; $ wk30         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, NA, NA, NA…
&gt; $ wk31         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, NA, NA, NA…
&gt; $ wk32         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, NA, NA, NA…
&gt; $ wk33         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk34         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk35         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk36         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk37         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk38         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk39         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk40         &lt;dbl&gt; NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk41         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk42         &lt;dbl&gt; NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk43         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk44         &lt;dbl&gt; NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk45         &lt;dbl&gt; NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk46         &lt;dbl&gt; NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk47         &lt;dbl&gt; NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk48         &lt;dbl&gt; NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk49         &lt;dbl&gt; NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk50         &lt;dbl&gt; NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk51         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk52         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk53         &lt;dbl&gt; NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk54         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk55         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk56         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk57         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk58         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk59         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk60         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk61         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk62         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk63         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk64         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk65         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk66         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk67         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk68         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk69         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk70         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk71         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk72         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk73         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk74         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk75         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk76         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
</div>
</section><section id="alternate-solution" class="slide level2"><h2>Alternate Solution</h2>
<p>When you import data from an external file you’ll also see it in the Global Environment tab in the upper-right pane of RStudio:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p>You can also import the data manually!</p>
<p>In the upper right-hand pane of RStudio (make sure you’re in the Environment tab), select:</p>
<p><code>Import Dataset &gt; From Text (readr)</code> and browse to the file on your computer<sup>1</sup>.</p>
</div>
<div class="fragment">
<p><strong>Once you’ve imported the data, you can <code>copy/paste</code> the import code from the console into your file!!</strong></p>
<p>This makes the process <em>reproducible!</em></p>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="images/data_global_env.png"></p>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Ideally you’ve saved it in your project folder! 😌</p></li></ol></aside></section><section id="manual-data-import" class="slide level2"><h2>Manual Data Import</h2>

<img data-src="images/data_import_manual.png" class="quarto-figure quarto-figure-center r-stretch"></section><section id="specifying-nas" class="slide level2"><h2>Specifying <code>NA</code>s</h2>
<p><code>NA</code>s are technically logical (boolean) variables that indicate a missing value.</p>
<div class="fragment">
<p>Sometimes a particular dataset or file read from a different software will code <code>NA</code>s differently than <code>R</code>. If that’s the case, you can add additional specifications to <code>read_csv</code> for what to read in as <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="cb7-2"><a></a>                               <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"999"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="skipping-lines" class="slide level2"><h2>Skipping lines</h2>
<p>Depending on how the data were input, there may be several lines that precede the beginning of the data table you’re interested in importing. You can skip these lines of metadata with the <code>skip</code> argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="cb8-2"><a></a>                               <span class="at">skip =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="variable-names" class="slide level2"><h2>Variable names</h2>
<p><code>read_csv</code> will automatically take the first row as column names. If you want to rename them you can save yourself some time recoding later on if you specify your preferred variable names upfront with the <code>col_names</code> argument.</p>
<div class="fragment">
<p>It takes a character vector to be used as column names (in their order of appearance).</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1"></a>billboard_renamed <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2"></a>                               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"time"</span>, <span class="st">"date_entered"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3"></a>                                             <span class="fu">paste</span>(<span class="st">"wk"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">76</span>, <span class="at">sep =</span> <span class="st">"_"</span>)))</span>
<span id="annotated-cell-8-4"><a href="#annotated-cell-8-4"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5"></a>billboard_renamed <span class="sc">|&gt;</span> <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="3" data-code-annotation="1"><code>paste</code> “pastes” together the first argument to the second argument (separated by whatever is specified in the <code>sep</code> argument) as character strings. Since the first argument here is a singular value, it is repeated for the entire length of the vector in the second argument. The first several values of <code>paste("wk", 1:76, sep = "_")</code> are: wk_1, wk_2, wk_3, wk_4, wk_5, wk_6</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="5" data-code-annotation="2"><code>names</code> here returns the column names of our data frame.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "year"         "artist"       "track"        "time"         "date_entered"
&gt;  [6] "wk_1"         "wk_2"         "wk_3"         "wk_4"         "wk_5"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>If you don’t have any variable names you can specify that instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="cb10-2"><a></a>                               <span class="at">col_names =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="snake-case" class="slide level2"><h2>Snake Case</h2>
<p>If you simply want to change your variables to snake case (all lower case; words separated by <code>_</code>), you can use the function <code>clean_names()</code> from the <code>janitor</code> package which replaces other punctuation separators with <code>_</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1"></a><span class="co"># Download pacakge first</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-2" class="code-annotation-target"><a href="#annotated-cell-10-2"></a><span class="co"># install.packages("janitor")</span></span>
<span id="annotated-cell-10-3"><a href="#annotated-cell-10-3"></a></span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4"></a><span class="co"># Create new object for renamed data</span></span>
<span id="annotated-cell-10-5"><a href="#annotated-cell-10-5"></a>billboard_renamed <span class="ot">&lt;-</span> billboard_2000_raw <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">numerals =</span> <span class="st">"right"</span>)</span>
<span id="annotated-cell-10-7"><a href="#annotated-cell-10-7"></a></span>
<span id="annotated-cell-10-8"><a href="#annotated-cell-10-8"></a>billboard_renamed <span class="sc">|&gt;</span>  <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="2" data-code-annotation="1">Run in the console first.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="2">You can call a function without loading its package by specifying its package name followed by <code>::</code> before it; <br> The <code>numerals</code> argument specifies if you additionally want to put a separator before a number.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "artist"       "track"        "time"         "date_entered" "wk_1"        
&gt;  [6] "wk_2"         "wk_3"         "wk_4"         "wk_5"         "wk_6"</code></pre>
</div>
</div>
</section><section id="other-data-file-types-with-readr" class="slide level2"><h2>Other Data File Types with <code>readr</code>
</h2>
<p>The other functions in <code>readr</code> employ a similar approach to <code>read_csv</code> so the trick is just knowing which to use for what data type.</p>
<div class="fragment">
<ul>
<li>
<code>read_csv2</code> is separated by semicolons (instead of commas)</li>
<li>
<code>read_tsv</code> is separated by tabs</li>
<li>
<code>read_delim</code> guesses the delimiter</li>
<li>
<code>read_fwf</code> reads in fixed-width-files</li>
<li>
<code>read_table</code> is a variation of <code>fwf</code> where columns are separated by white space</li>
<li>
<code>read_log</code> reads in Apache-style log files</li>
</ul>
</div>
</section><section id="other-packages-to-read-in-data" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
</section><section id="other-packages-to-read-in-data-1" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/readxl.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
</ul>
</div></div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn2"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li></ol></aside></section><section id="other-packages-to-read-in-data-2" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/googlesheets4.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
<li>For Google Docs Spreadsheets, use package <a href="https://googlesheets4.tidyverse.org/"><code>googlesheets4</code></a><sup>2</sup>
</li>
</ul>
</div></div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn3"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li><li id="fn4"><p>Very similar to <code>readxl</code> with some slight variations you can read about <a href="https://r4ds.hadley.nz/spreadsheets.html#google-sheets">here</a>.</p></li></ol></aside></section><section id="other-packages-to-read-in-data-3" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/haven.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
<li>For Google Docs Spreadsheets, use package <a href="https://googlesheets4.tidyverse.org/"><code>googlesheets4</code></a><sup>2</sup>
</li>
<li>For Stata, SPSS, and SAS files, use package <a href="https://haven.tidyverse.org/"><code>haven</code></a><sup>3</sup>
</li>
</ul>
</div></div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn5"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li><li id="fn6"><p>Very similar to <code>readxl</code> with some slight variations you can read about <a href="https://r4ds.hadley.nz/spreadsheets.html#google-sheets">here</a>.</p></li><li id="fn7"><p>SAS, SPSS, and Stata have so-called “labelled” vectors for which <code>haven</code> provides a <a href="https://haven.tidyverse.org/reference/index.html#labelled-vectors">class</a> to represent in <code>R</code>. Alternatively, you can get rid of them with <a href="https://haven.tidyverse.org/reference/index.html#remove-attributes">these functions</a>.</p></li></ol></aside></section><section id="how-does-readr-parse-different-data-types" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""></figure><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id2 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id3 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id4 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id5 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
<p></p>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-1" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""></figure><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id2 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id3 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id4 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id5 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style A fill:#ffa07a,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
<p></p>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-2" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""></figure><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id2 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id3 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id4 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id5 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#ffa07a,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
<p></p>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-3" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""></figure><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id2 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id3 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id4 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id5 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#ffa07a,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
<p></p>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-4" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""></figure><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style id2 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id3 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id4 fill:#c7cdac,color:#1e4655,stroke:#1e4655
    style id5 fill:#1e4655,color:#c7cdac,stroke:#c7cdac
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#ffa07a,color:#000000,stroke:#000000

</pre>
</div>
<p></p>
</div>
</div>
</div>
</section><section id="most-common-issue-with-reading-in-data" class="slide level2"><h2>Most Common Issue with Reading in Data</h2>
<p>The most common problem that occurs when reading in data is having mixed data. Most often, given the heuristic provided in the last slide, <code>readr</code> will parse a variable as a character string to preserve whatever it contains.</p>
<div class="fragment">
<p>Let’s actually look at how the billboard data was read in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">glimpse</span>(billboard_2000_raw) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Rows: 317
&gt; Columns: 80
&gt; $ artist       &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 …
&gt; $ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Kr…
&gt; $ time         &lt;time&gt; 04:22:00, 03:15:00, 03:53:00, 04:24:00, 03:35:00, 03:24:…
&gt; $ date.entered &lt;date&gt; 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21, 2000-04-…
&gt; $ wk1          &lt;dbl&gt; 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, 50, 71, 7…
&gt; $ wk2          &lt;dbl&gt; 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, 39, 51, 6…
&gt; $ wk3          &lt;dbl&gt; 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, 30, 28, 5…
&gt; $ wk4          &lt;dbl&gt; 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, 28, 18, 4…
&gt; $ wk5          &lt;dbl&gt; 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23, 21, 13, …
&gt; $ wk6          &lt;dbl&gt; 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, 19, 13, 3…
&gt; $ wk7          &lt;dbl&gt; 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 20, 11, 34…
&gt; $ wk8          &lt;dbl&gt; NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17, 1, 29, …
&gt; $ wk9          &lt;dbl&gt; NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17, 1, 27, …
&gt; $ wk10         &lt;dbl&gt; NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 17, 2, 30,…
&gt; $ wk11         &lt;dbl&gt; NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17, 2, 36, N…
&gt; $ wk12         &lt;dbl&gt; NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3, 3, 37, N…
&gt; $ wk13         &lt;dbl&gt; NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3, 3, 39, N…
&gt; $ wk14         &lt;dbl&gt; NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7, 4, 49, N…
&gt; $ wk15         &lt;dbl&gt; NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10, 12, 57,…
&gt; $ wk16         &lt;dbl&gt; NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17, 11, 63,…
&gt; $ wk17         &lt;dbl&gt; NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 25, 13, 65…
&gt; $ wk18         &lt;dbl&gt; NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 29, 15, 68…
&gt; $ wk19         &lt;dbl&gt; NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 29, 18, 79…
&gt; $ wk20         &lt;dbl&gt; NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 40, 20, 86…
&gt; $ wk21         &lt;dbl&gt; NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 43, 30, NA…
&gt; $ wk22         &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50, 40, NA,…
&gt; $ wk23         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, 39, NA,…
&gt; $ wk24         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA, 44, NA,…
&gt; $ wk25         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, NA, NA, NA…
&gt; $ wk26         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, NA, NA, NA…
&gt; $ wk27         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, NA, NA, NA…
&gt; $ wk28         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, NA, NA, NA…
&gt; $ wk29         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, NA, NA, NA…
&gt; $ wk30         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, NA, NA, NA…
&gt; $ wk31         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, NA, NA, NA…
&gt; $ wk32         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, NA, NA, NA…
&gt; $ wk33         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk34         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk35         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk36         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk37         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk38         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk39         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
&gt; $ wk40         &lt;dbl&gt; NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk41         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk42         &lt;dbl&gt; NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk43         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk44         &lt;dbl&gt; NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk45         &lt;dbl&gt; NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk46         &lt;dbl&gt; NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk47         &lt;dbl&gt; NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk48         &lt;dbl&gt; NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk49         &lt;dbl&gt; NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk50         &lt;dbl&gt; NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk51         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk52         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk53         &lt;dbl&gt; NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk54         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk55         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk56         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk57         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk58         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk59         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk60         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk61         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk62         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk63         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk64         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk65         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk66         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk67         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk68         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk69         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk70         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk71         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk72         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk73         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk74         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk75         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
&gt; $ wk76         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
</div>
</section><section id="what-went-wrong" class="slide level2"><h2>What Went Wrong?</h2>
<p>Since <code>readr</code> uses the values in the first 1000 rows to guess the type of the column (logical, numeric, date/date-time, character), if the first 1000 rows don’t have any data, they will be coded as logical variables.</p>
<div class="fragment">
<p>There are not many songs in the data that charted for 60+ weeks—and none in the first 1000 that charted for 66+ weeks!</p>
</div>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:blue"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> &nbsp;<code>NA</code> is logical?</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-84"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-84-1"><a href="#annotated-cell-84-1"></a><span class="fu">class</span>(<span class="fu">c</span>(T, F, <span class="cn">NA</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-84" data-target-annotation="1">1</button><span id="annotated-cell-84-2" class="code-annotation-target"><a href="#annotated-cell-84-2"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="fl">17.5</span>, <span class="fl">5.3</span>, <span class="cn">NA</span>))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-84" data-target-annotation="2">2</button><span id="annotated-cell-84-3" class="code-annotation-target"><a href="#annotated-cell-84-3"></a><span class="fu">class</span>(<span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"2023-10-31"</span>, <span class="st">"1986-06-21"</span>, <span class="st">"1997-01-15"</span>), <span class="at">tz =</span> <span class="st">"America/Los_Angeles"</span>))</span>
<span id="annotated-cell-84-4"><a href="#annotated-cell-84-4"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="st">"apple"</span>, <span class="cn">NA</span>, <span class="st">"mango"</span>, <span class="st">"blackberry"</span>, <span class="st">"plum"</span>)) </span>
<span id="annotated-cell-84-5"><a href="#annotated-cell-84-5"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-84" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-84" data-code-lines="2" data-code-annotation="1"><code>class</code> returns the data type of its first argument.</span>
</dd>
<dt data-target-cell="annotated-cell-84" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-84" data-code-lines="3" data-code-annotation="2"><code>as.Date</code> turns a character string of dates into an official date class in Base <code>R</code>. If we had an accompanying time stamp we would need to use <code>as.POSIXct</code> which turns a character string of dates and times into an official date-time class in Base <code>R</code>.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "logical"
&gt; [1] "numeric"
&gt; [1] "Date"
&gt; [1] "character"
&gt; [1] "logical"</code></pre>
</div>
</div>
</div>
</div>
</div>

</div>
<aside><div>
<p>Technically, <code>NA</code>s can be any data type depending upon what they are grouped with. However, by themselves they are a logical indicator of missing data, so their class is logical.</p>
</div></aside></section><section id="column-types" class="slide level2"><h2>Column types</h2>
<p>Since the <code>wk*</code> variables should all be read in as integers, we can specify this explicitly with the <code>col_types</code> argument.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1"></a><span class="co"># Create character string of shortcode column types</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-2" class="code-annotation-target"><a href="#annotated-cell-12-2"></a>bb_types <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"cctD"</span>, <span class="fu">rep</span>(<span class="st">"i"</span>, <span class="dv">76</span>)), <span class="at">collapse=</span><span class="st">""</span>)</span>
<span id="annotated-cell-12-3"><a href="#annotated-cell-12-3"></a>bb_types </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="2" data-code-annotation="1">You can short-code column types with <code>c</code> = character, <code>t</code> = time, <code>D</code> = date, <code>i</code> = integer. <br> The <code>collapse</code> argument collapses the first two arguments into one complete character string.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "cctDiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-13-1"><a href="#annotated-cell-13-1"></a><span class="co"># re-read in data with column types specified</span></span>
<span id="annotated-cell-13-2"><a href="#annotated-cell-13-2"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="2">2</button><span id="annotated-cell-13-3" class="code-annotation-target"><a href="#annotated-cell-13-3"></a>                               <span class="at">col_types =</span> bb_types)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="3">3</button><span id="annotated-cell-13-4" class="code-annotation-target"><a href="#annotated-cell-13-4"></a>billboard_2000_raw <span class="sc">|&gt;</span> <span class="fu">select</span>(wk66<span class="sc">:</span>wk76)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="3" data-code-annotation="2">This string now specifies the data type for each column of our data frame. Visit <a href="https://readr.tidyverse.org/reference/cols.html">this reference page</a> to see all available column types and their short codes.</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="4" data-code-annotation="3">Checking the previously incorrectly parsed variables</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 317 × 11
&gt;     wk66  wk67  wk68  wk69  wk70  wk71  wk72  wk73  wk74  wk75  wk76
&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt;  1    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  2    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  3    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  4    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  6    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  7    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  8    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt;  9    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt; 10    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
&gt; # ℹ 307 more rows</code></pre>
</div>
</div>
</div>
</section><section id="column-types-1" class="slide level2"><h2>Column types</h2>
<p>To specify a default column type you can use <code>.default</code> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="cb17-2"><a></a>                               <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="fu">col_character</span>())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><br></p>
<p>Another useful helper is <code>cols_only()</code> for when you only want to read in a subset of all available variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard_top100.csv"</span>, </span>
<span id="cb18-2"><a></a>                               <span class="at">col_types =</span> <span class="fu">cols_only</span>(<span class="at">x =</span> col_character)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>In summary, the <code>col_types</code> argument gives you greater control over how your data are read in and can save you recoding time down the road and/or point out where your data are behaving differently than you expect.</p>
</div>
</section><section id="reading-in-multiple-files" class="slide level2"><h2>Reading in Multiple Files</h2>
<p>If your data are split across multiple files you can read them in all at once by specifying the <code>id</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="co"># Create list of files manually</span></span>
<span id="cb19-2"><a></a>sales_files <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data/01_sales.csv"</span>, <span class="st">"data/02_sales.csv"</span>, <span class="st">"data/03_sales.csv"</span>)</span>
<span id="cb19-3"><a></a><span class="fu">read_csv</span>(sales_files, <span class="at">id =</span> <span class="st">"file"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 19 × 6
&gt;    file              month     year brand  item     n
&gt;    &lt;chr&gt;             &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
&gt;  1 data/01_sales.csv January   2019     1  1234     3
&gt;  2 data/01_sales.csv January   2019     1  8721     9
&gt;  3 data/01_sales.csv January   2019     1  1822     2
&gt;  4 data/01_sales.csv January   2019     2  3333     1
&gt;  5 data/01_sales.csv January   2019     2  2156     9
&gt;  6 data/01_sales.csv January   2019     2  3987     6
&gt;  7 data/01_sales.csv January   2019     2  3827     6
&gt;  8 data/02_sales.csv February  2019     1  1234     8
&gt;  9 data/02_sales.csv February  2019     1  8721     2
&gt; 10 data/02_sales.csv February  2019     1  1822     3
&gt; 11 data/02_sales.csv February  2019     2  3333     1
&gt; 12 data/02_sales.csv February  2019     2  2156     3
&gt; 13 data/02_sales.csv February  2019     2  3987     6
&gt; 14 data/03_sales.csv March     2019     1  1234     3
&gt; 15 data/03_sales.csv March     2019     1  3627     1
&gt; 16 data/03_sales.csv March     2019     1  8820     3
&gt; 17 data/03_sales.csv March     2019     2  7253     1
&gt; 18 data/03_sales.csv March     2019     2  8766     3
&gt; 19 data/03_sales.csv March     2019     2  8288     6</code></pre>
</div>
</div>
</section><section id="reading-in-multiple-files-1" class="slide level2"><h2>Reading in Multiple Files</h2>
<p>If you have too many files to reasonably type out all their names you can also use the base <code>r</code> function <code>list.files</code> to list the files for you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-17-1"><a href="#annotated-cell-17-1"></a><span class="co"># Create list of files with pattern-matching</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1">1</button><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2"></a>sales_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"data"</span>, <span class="at">pattern =</span> <span class="st">"sales</span><span class="sc">\\</span><span class="st">.csv$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-17-3"><a href="#annotated-cell-17-3"></a>sales_files</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="2" data-code-annotation="1">We will discuss pattern-matching more in a couple of weeks; if all your data was in one folder without anything else in it, you wouldn’t need to specify this argument. Sometimes, however, you may be searching through larger directories that you did not organize and that’s when pattern-matching is really powerful.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "data/01_sales.csv" "data/02_sales.csv" "data/03_sales.csv"</code></pre>
</div>
</div>
</section><section id="data-entry" class="slide level2"><h2>Data Entry</h2>
<p>Sometimes you’ll need to create a data set in your code. You can do this two ways:</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1"><code>tibble()</code></a></li>
<li><a href="#tabset-1-2"><code>tribble()</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>Tibbles lay out the data by columns (i.e.&nbsp;a dataframe transposed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="co"># Creating data with tibble</span></span>
<span id="cb22-2"><a></a><span class="fu">tibble</span>( </span>
<span id="cb22-3"><a></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>), </span>
<span id="cb22-4"><a></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"h"</span>, <span class="st">"m"</span>, <span class="st">"g"</span>),</span>
<span id="cb22-5"><a></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="fl">0.08</span>, <span class="fl">0.83</span>, <span class="fl">0.60</span>)</span>
<span id="cb22-6"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 3 × 3
&gt;       x y         z
&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
&gt; 1     1 h      0.08
&gt; 2     2 m      0.83
&gt; 3     5 g      0.6</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<p>Tibbles (<code>tr</code>ansposed ti<code>bble</code>) lay out the data by rows (i.e.&nbsp;the way a dataframe looks) which is much more intuitive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="co"># Creating data with tribble</span></span>
<span id="cb24-2"><a></a><span class="fu">tribble</span>( </span>
<span id="cb24-3"><a></a>  <span class="sc">~</span>x, <span class="sc">~</span>y, <span class="sc">~</span>z,</span>
<span id="cb24-4"><a></a>  <span class="dv">1</span>, <span class="st">"h"</span>, <span class="fl">0.08</span>,</span>
<span id="cb24-5"><a></a>  <span class="dv">2</span>, <span class="st">"m"</span>, <span class="fl">0.83</span>,</span>
<span id="cb24-6"><a></a>  <span class="dv">5</span>, <span class="st">"g"</span>, <span class="fl">0.60</span></span>
<span id="cb24-7"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 3 × 3
&gt;       x y         z
&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
&gt; 1     1 h      0.08
&gt; 2     2 m      0.83
&gt; 3     5 g      0.6</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="writing-delimited-files" class="slide level2"><h2>Writing Delimited Files</h2>
<p>Getting data out of R into a delimited file is very similar to getting it into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">write_csv</span>(billboard_2000_raw, <span class="at">path =</span> <span class="st">"data/billboard_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This saved the data we pulled off the web in a file called <code>billboard_data.csv</code> in the <code>data</code> folder of my working directory.</p>
<div class="fragment">
<p>However, saving data in this way will not preserve <code>R</code> data types since delimited files code everything as a character string.</p>
</div>
<div class="fragment">
<p>To save <code>R</code> objects and all associated metadata you have two options:</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1"><code>.Rds</code> format:</a></li>
<li><a href="#tabset-2-2"><code>.Rdata</code> or <code>.Rda</code> format:</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<ul>
<li>Used for single objects, doesn’t save original the object name</li>
<li>Save: <code>write_rds(old_object_name, "path.Rds")</code>
</li>
<li>Load: <code>new_object_name &lt;- read_rds("path.Rds")</code>
</li>
</ul>
</div>
<div id="tabset-2-2">
<ul>
<li>Used for saving multiple files where the original object names are preserved</li>
<li>Save: <code>save(object1, object2, ... , file = "path.Rdata")</code>
</li>
<li>Load: <code>load("path.Rdata")</code> without assignment operator</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="writing-other-file-types" class="slide level2"><h2>Writing Other File-Types</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-3-1"><code>writexl</code></a></li>
<li><a href="#tabset-3-2"><code>googlesheets4</code></a></li>
<li><a href="#tabset-3-3"><code>haven</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>write_xlsx()</code> writes to an xlsx file</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/writexl.png" style="width:50.0%"></p>
</div></div>
</div>
<div id="tabset-3-2">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>sheet_write()</code> or <code>write_sheet()</code> (over)writes new data into a Sheet</li>
<li>
<code>gs4_create()</code> creates a new Sheet</li>
<li>
<code>sheet_append()</code> appends rows to a sheet</li>
<li>
<code>range_write()</code> (over)writes new data into a range</li>
<li>
<code>range_flood()</code> floods a range of cells</li>
<li>`<code>range_clear()</code> clears a range of cells</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/googlesheets4.png" style="width:50.0%"></p>
</div></div>
</div>
<div id="tabset-3-3">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>write_dta()</code> writes Stata DTA files</li>
<li>
<code>write_sav()</code> writes SPSS files</li>
<li>
<code>write_xpt()</code> writes SAS transport files</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/haven.png" style="width:50.0%"></p>
</div></div>
</div>
</div>
</div>
</section></section><section><section id="lab" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Lab</h1>

</section><section id="importing-tidying-data" class="slide level2"><h2>Importing &amp; Tidying Data</h2>
<ul>
<li class="fragment">Go to the <a href="https://vsass.github.io/CSSS508/Lectures/Lecture5/CSSS508_Lecture5_index.html">Lecture 5 Homepage</a> and click on the link <code>Religion &amp; Income</code> under the Data section.</li>
<li class="fragment">Click <em>File</em> &gt; <em>Save</em> to download this data to the same folder where your source document<sup>1</sup> will be saved for this lab.</li>
<li class="fragment">Read in your data using the appropriate function from <code>readr</code>.</li>
</ul><aside><ol class="aside-footnotes"><li id="fn8"><p><code>R</code> Script or <code>.qmd</code></p></li></ol></aside></section></section><section id="tidying-and-reshaping-data" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Tidying and Reshaping Data</h1>

</section><section><section id="section-1" class="title-slide slide level1 section-title center" data-menu-title="`tidyr`" data-background-image="images/tidyr.png" data-background-size="contain" data-background-position="center" data-background-color="#1e4655"><h1></h1>

</section><section id="initial-spot-checks" class="slide level2"><h2>Initial Spot Checks</h2>
<p>First things to check after loading new data:</p>
<ul>
<li class="fragment">Did all the rows/columns from the original file make it in?
<ul>
<li class="fragment">Check using <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> or <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>
</li>
</ul>
</li>
<li class="fragment">Are the column names in good shape?
<ul>
<li class="fragment">Use <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> to check; re-read in using <code>col_names()</code> or fix with <code>rename()</code>
</li>
</ul>
</li>
<li class="fragment">Are there “decorative” blank rows or columns to remove?
<ul>
<li class="fragment">
<code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> or <code>select()</code> out those rows/columns</li>
</ul>
</li>
<li class="fragment">How are missing values represented: <code>NA</code>, <code>" "</code> (blank), <code>.</code> (period), <code>999</code>?
<ul>
<li class="fragment">Read in the data again specifying <code>NA</code>s with the <code>na</code> argument</li>
</ul>
</li>
<li class="fragment">Are there character data (e.g.&nbsp;ZIP codes with leading zeroes) being incorrectly represented as numeric or vice versa?
<ul>
<li class="fragment">Read in the data again specifying desired <code>col_types</code>
</li>
</ul>
</li>
</ul></section><section id="what-is-tidy-data" class="slide level2"><h2>What is Tidy Data?</h2>
<div class="fragment">
<p><img data-src="images/tidy_data1.jpeg" class="absolute" style="top: 50px; left: 0px; right: 0px; "><sup>1</sup></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn9"><p>Illustrations from the <a href="https://openscapes.org/">Openscapes</a> blog <a href="https://www.openscapes.org/blog/2020/10/12/tidy-data/">Tidy Data for reproducibility, efficiency, and collaboration</a> by Julia Lowndes and Allison Horst</p></li></ol></aside></section><section id="why-do-we-want-tidy-data" class="slide level2"><h2>Why do we Want Tidy Data?</h2>
<ul>
<li class="fragment">
<strong>Easier to understand</strong> many rows than many columns<sup>1</sup>
</li>
<li class="fragment">Required for <strong>plotting</strong> in <code>ggplot2</code><sup>2</sup>
</li>
<li class="fragment">Required for many types of <strong>statistical procedures</strong> (e.g.&nbsp;hierarchical or mixed effects models)</li>
<li class="fragment">Fewer issues with <strong>missing values and “imbalanced”</strong> repeated measures data</li>
<li class="fragment">Having a consistent method for storing data means it’s easier to learn the tools to work with it since there’s an underlying uniformity.</li>
</ul>
<div class="fragment">
<p>Most real-world data is not tidy because data are often organized for goals other than analysis (i.e.&nbsp;data entry) and most people aren’t familiar with the principles of tidy data.</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn10"><p>Placing variables in columns also leverages <code>R</code>’s vectorized nature, i.e.&nbsp;most built-in <code>R</code> functions work with values of vectors.</p></li><li id="fn11"><p>In fact, all tidyverse functions are designed to work with tidy data.</p></li></ol></aside></section><section id="why-do-we-want-tidy-data-1" class="slide level2"><h2>Why do we Want Tidy Data?</h2>
<div class="fragment">
<p><img data-src="images/tidy_data3.jpeg" class="absolute" style="top: 50px; left: 0px; right: 0px; "><sup>1</sup></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn12"><p>Illustrations from the <a href="https://openscapes.org/">Openscapes</a> blog <a href="https://www.openscapes.org/blog/2020/10/12/tidy-data/">Tidy Data for reproducibility, efficiency, and collaboration</a> by Julia Lowndes and Allison Horst</p></li></ol></aside></section><section id="slightly-messy-data" class="slide level2"><h2>Slightly “Messy” Data</h2>
<div class="columns">
<div class="column" style="width:60%;">
<table class="caption-top">
<thead><tr class="header">
<th><strong>Program</strong></th>
<th style="text-align: right;"><strong>First Year</strong></th>
<th style="text-align: right;"><strong>Second Year</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Evans School</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Public Health</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>Other</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:40%;">
<ul>
<li>What is an <strong>observation</strong>?
<ul>
<li>A group of students from a program of a given year</li>
</ul>
</li>
<li>What are the <strong>variables</strong>?
<ul>
<li>Program, Year</li>
</ul>
</li>
<li>What are the <strong>values</strong>?
<ul>
<li>Program: Evans School, Arts &amp; Sciences, Public Health, Other</li>
<li>Year: First, Second – <strong>in column headings. Bad!</strong>
</li>
<li>Count: <strong>spread over two columns!</strong>
</li>
</ul>
</li>
</ul>
</div></div>
</section><section id="tidy-version" class="slide level2"><h2>Tidy Version</h2>
<div class="columns">
<div class="column" style="width:50%;">
<table class="caption-top">
<thead><tr class="header">
<th><strong>Program</strong></th>
<th style="text-align: right;"><strong>Year</strong></th>
<th style="text-align: right;"><strong>Count</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Evans School</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td>Evans School</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Public Health</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>Public Health</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>Other</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Other</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Each variable is a column.</p></li>
<li><p>Each observation is a row.</p></li>
<li><p>Each cell has a single value.</p></li>
</ul>
</div></div>
</section><section id="billboard-is-just-ugly-messy" class="slide level2"><h2>Billboard is Just Ugly-Messy</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 10 × 80
&gt;    artist     track time  date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7
&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;tim&gt; &lt;date&gt;       &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt;  1 2 Pac      Baby… 04:22 2000-02-26      87    82    72    77    87    94    99
&gt;  2 2Ge+her    The … 03:15 2000-09-02      91    87    92    NA    NA    NA    NA
&gt;  3 3 Doors D… Kryp… 03:53 2000-04-08      81    70    68    67    66    57    54
&gt;  4 3 Doors D… Loser 04:24 2000-10-21      76    76    72    69    67    65    55
&gt;  5 504 Boyz   Wobb… 03:35 2000-04-15      57    34    25    17    17    31    36
&gt;  6 98^0       Give… 03:24 2000-08-19      51    39    34    26    26    19     2
&gt;  7 A*Teens    Danc… 03:44 2000-07-08      97    97    96    95   100    NA    NA
&gt;  8 Aaliyah    I Do… 04:15 2000-01-29      84    62    51    41    38    35    35
&gt;  9 Aaliyah    Try … 04:03 2000-03-18      59    53    38    28    21    18    16
&gt; 10 Adams, Yo… Open… 05:30 2000-08-26      76    76    74    69    68    67    61
&gt; # ℹ 69 more variables: wk8 &lt;int&gt;, wk9 &lt;int&gt;, wk10 &lt;int&gt;, wk11 &lt;int&gt;,
&gt; #   wk12 &lt;int&gt;, wk13 &lt;int&gt;, wk14 &lt;int&gt;, wk15 &lt;int&gt;, wk16 &lt;int&gt;, wk17 &lt;int&gt;,
&gt; #   wk18 &lt;int&gt;, wk19 &lt;int&gt;, wk20 &lt;int&gt;, wk21 &lt;int&gt;, wk22 &lt;int&gt;, wk23 &lt;int&gt;,
&gt; #   wk24 &lt;int&gt;, wk25 &lt;int&gt;, wk26 &lt;int&gt;, wk27 &lt;int&gt;, wk28 &lt;int&gt;, wk29 &lt;int&gt;,
&gt; #   wk30 &lt;int&gt;, wk31 &lt;int&gt;, wk32 &lt;int&gt;, wk33 &lt;int&gt;, wk34 &lt;int&gt;, wk35 &lt;int&gt;,
&gt; #   wk36 &lt;int&gt;, wk37 &lt;int&gt;, wk38 &lt;int&gt;, wk39 &lt;int&gt;, wk40 &lt;int&gt;, wk41 &lt;int&gt;,
&gt; #   wk42 &lt;int&gt;, wk43 &lt;int&gt;, wk44 &lt;int&gt;, wk45 &lt;int&gt;, wk46 &lt;int&gt;, wk47 &lt;int&gt;, …</code></pre>
</div>
</div>

<aside><div>
<p>Week columns continue up to <code>wk76</code>!</p>
</div></aside></section><section id="billboard" class="slide level2"><h2>Billboard</h2>
<ul>
<li class="fragment">What are the <strong>observations</strong> in the data?
<ul>
<li class="fragment">Song on the Billboard chart each week</li>
</ul>
</li>
<li class="fragment">What are the <strong>variables</strong> in the data?
<ul>
<li class="fragment">Year, artist, track, song length, date entered Hot 100, week since first entered Hot 100 (<strong>spread over many columns</strong>), rank during week (<strong>spread over many columns</strong>)</li>
</ul>
</li>
<li class="fragment">What are the <strong>values</strong> in the data?
<ul>
<li class="fragment">e.g.&nbsp;2000; 3 Doors Down; Kryptonite; 3 minutes 53 seconds; April 8, 2000; Week 3 (<strong>stuck in column headings</strong>); rank 68 (<strong>spread over many columns</strong>)</li>
</ul>
</li>
</ul></section><section id="reminder-why-do-we-want-tidy-data" class="slide level2"><h2>Reminder: Why do we Want Tidy Data?</h2>
<div class="fragment">
<p><img data-src="images/tidy_data2.jpeg" class="absolute" style="top: 50px; left: 0px; right: 0px; "><sup>1</sup></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn13"><p>Illustrations from the <a href="https://openscapes.org/">Openscapes</a> blog <a href="https://www.openscapes.org/blog/2020/10/12/tidy-data/">Tidy Data for reproducibility, efficiency, and collaboration</a> by Julia Lowndes and Allison Horst</p></li></ol></aside></section><section id="tidyr" class="slide level2"><h2><code>tidyr</code></h2>
<p>The <code>tidyr</code> package provides functions to tidy up data.</p>
<div class="fragment">
<p><strong>Key functions:</strong></p>
<ul>
<li>
<strong><code>pivot_longer()</code></strong>: takes a set of columns and pivots them down (“longer”) to make two new columns (which you can name yourself):
<ul>
<li>A <code>name</code> column that stores the original column names</li>
<li>A <code>value</code> with the values in those original columns</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>
<strong><code>pivot_wider()</code></strong>: inverts <code>pivot_longer()</code> by taking two columns and pivoting them up and across (“wider”) into multiple columns</li>
</ul>
</div>
</section><section id="pivot_longer" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li class="fragment">
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li class="fragment">
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li class="fragment">
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol></section><section id="pivot_longer-1" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li><strong><code>names_to</code>: Names the new variable that is stored in multiple columns</strong></li>
<li>
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol>

<img data-src="images/pivot_longer2_column_names.png" class="quarto-figure quarto-figure-center r-stretch"></section><section id="pivot_longer-2" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li>
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li><strong><code>values_to</code>: Names the variable stored in the cell values</strong></li>
</ol>

<img data-src="images/pivot_longer3_cell_values.png" class="quarto-figure quarto-figure-center r-stretch"></section><section id="pivot_longer-3" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li>
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li>
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol>

<img data-src="images/pivot_longer1_variables.png" class="quarto-figure quarto-figure-center r-stretch"></section><section id="pivot_longer-example" class="slide level2"><h2>
<code>pivot_longer()</code> Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-19"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="1">1</button><span id="annotated-cell-19-1" class="code-annotation-target"><a href="#annotated-cell-19-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_renamed <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="2">2</button><span id="annotated-cell-19-2" class="code-annotation-target"><a href="#annotated-cell-19-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"wk_"</span>),</span>
<span id="annotated-cell-19-3"><a href="#annotated-cell-19-3"></a>               <span class="at">names_to =</span><span class="st">"week"</span>,</span>
<span id="annotated-cell-19-4"><a href="#annotated-cell-19-4"></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>)</span>
<span id="annotated-cell-19-5"><a href="#annotated-cell-19-5"></a></span>
<span id="annotated-cell-19-6"><a href="#annotated-cell-19-6"></a>billboard_2000 <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-19" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-19" data-code-lines="1" data-code-annotation="1"><code>billboard_renamed</code> here has snake_case variable names and correctly specified column types</span>
</dd>
<dt data-target-cell="annotated-cell-19" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-19" data-code-lines="2" data-code-annotation="2"><code>starts_with()</code> is one of the helper functions from <a href="https://tidyselect.r-lib.org/index.html"><code>tidyselect</code></a> that helps select certain common patterns. We could have also used <code>cols = wk1:wk76</code>.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 10 × 6
&gt;    artist track                   time   date_entered week   rank
&gt;    &lt;chr&gt;  &lt;chr&gt;                   &lt;time&gt; &lt;date&gt;       &lt;chr&gt; &lt;int&gt;
&gt;  1 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_1     87
&gt;  2 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_2     82
&gt;  3 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_3     72
&gt;  4 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_4     77
&gt;  5 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_5     87
&gt;  6 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_6     94
&gt;  7 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_7     99
&gt;  8 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_8     NA
&gt;  9 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_9     NA
&gt; 10 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk_10    NA</code></pre>
</div>
</div>
<div class="fragment">
<p>Now we have a single week column!</p>
</div>
</section><section id="lots-of-missing-values" class="slide level2"><h2>Lots of Missing Values?!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a><span class="fu">glimpse</span>(billboard_2000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Rows: 24,092
&gt; Columns: 6
&gt; $ artist       &lt;chr&gt; "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 …
&gt; $ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "Baby Don't Cry (Keep...", "Ba…
&gt; $ time         &lt;time&gt; 04:22:00, 04:22:00, 04:22:00, 04:22:00, 04:22:00, 04:22:…
&gt; $ date_entered &lt;date&gt; 2000-02-26, 2000-02-26, 2000-02-26, 2000-02-26, 2000-02-…
&gt; $ week         &lt;chr&gt; "wk_1", "wk_2", "wk_3", "wk_4", "wk_5", "wk_6", "wk_7", "…
&gt; $ rank         &lt;int&gt; 87, 82, 72, 77, 87, 94, 99, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<div class="fragment">
<p>It looks like 2 Pac’s song “Baby Don’t Cry” was only on the Billboard Hot 100 for 7 weeks and then dropped off the charts.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
&gt;    1.00   26.00   51.00   51.05   76.00  100.00   18785</code></pre>
</div>
</div>
<div class="fragment">
<p>We don’t want to keep the 18785 rows with missing ranks.</p>
</div>
</div>
</section><section id="pivoting-better-values_drop_na" class="slide level2"><h2>Pivoting Better: <code>values_drop_na</code>
</h2>
<p>Adding the argument <code>values_drop_na = TRUE</code> to <code>pivot_longer()</code> will remove rows with missing ranks. Since these <code>NA</code>s don’t really represent unknown observations (i.e.&nbsp;they were forced to exist by the structure of the dataset) this is an appropriate approach here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" data-code-line-numbers="|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>billboard_2000 <span class="ot">&lt;-</span> billboard_renamed <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> wk_1<span class="sc">:</span>wk_76, </span>
<span id="cb33-3"><a></a>               <span class="at">names_to =</span> <span class="st">"week"</span>, </span>
<span id="cb33-4"><a></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>, </span>
<span id="cb33-5"><a></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-6"><a></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;    1.00   26.00   51.00   51.05   76.00  100.00</code></pre>
</div>
</div>
<div class="fragment">
<p>No more <code>NA</code> values!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">dim</span>(billboard_2000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 5307    6</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>And way fewer rows!</p>
</div>
</section><section id="parse_number" class="slide level2"><h2><code>parse_number()</code></h2>
<p>The week column is of the type <code>character</code>, but it should be <code>numeric.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a><span class="fu">head</span>(billboard_2000<span class="sc">$</span>week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "wk_1" "wk_2" "wk_3" "wk_4" "wk_5" "wk_6"</code></pre>
</div>
</div>
<div class="fragment">
<p><code>parse_number()</code> grabs just the numeric information from a character string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_2000 <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="3">3</button><span id="annotated-cell-25-2" class="code-annotation-target"><a href="#annotated-cell-25-2"></a>    <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3"></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>week)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="2" data-code-annotation="3">You can use <code>mutate()</code> to overwrite existing columns.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;    1.00    5.00   10.00   11.47   16.00   65.00</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>More sophisticated tools for character strings will be covered later in this course!</p>
</div>
</section><section id="use-pivot_longer-arguments" class="slide level2"><h2>Use <code>pivot_longer</code> arguments</h2>
<p>Alternatively (and more efficiently), there are a number of optional arguments for <code>pivot_longer</code> that are meant to help deal with naming issues.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-26"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-26-1"><a href="#annotated-cell-26-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_renamed <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-26-2"><a href="#annotated-cell-26-2"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"wk_"</span>), </span>
<span id="annotated-cell-26-3"><a href="#annotated-cell-26-3"></a>               <span class="at">names_to        =</span> <span class="st">"week"</span>, </span>
<span id="annotated-cell-26-4"><a href="#annotated-cell-26-4"></a>               <span class="at">values_to       =</span> <span class="st">"rank"</span>,</span>
<span id="annotated-cell-26-5"><a href="#annotated-cell-26-5"></a>               <span class="at">values_drop_na  =</span> <span class="cn">TRUE</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="4">4</button><span id="annotated-cell-26-6" class="code-annotation-target"><a href="#annotated-cell-26-6"></a>               <span class="at">names_prefix    =</span> <span class="st">"wk_"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="5">5</button><span id="annotated-cell-26-7" class="code-annotation-target"><a href="#annotated-cell-26-7"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">week =</span> as.integer))</span>
<span id="annotated-cell-26-8"><a href="#annotated-cell-26-8"></a></span>
<span id="annotated-cell-26-9"><a href="#annotated-cell-26-9"></a><span class="fu">head</span>(billboard_2000, <span class="dv">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-26" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-26" data-code-lines="6" data-code-annotation="4"><code>names_prefix</code> is used to remove “wk_” from the values of <code>week</code></span>
</dd>
<dt data-target-cell="annotated-cell-26" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-26" data-code-lines="7" data-code-annotation="5"><code>names_transform</code> converts <code>week</code> into an integer number.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 6
&gt;   artist track                   time   date_entered  week  rank
&gt;   &lt;chr&gt;  &lt;chr&gt;                   &lt;time&gt; &lt;date&gt;       &lt;int&gt; &lt;int&gt;
&gt; 1 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       1    87
&gt; 2 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       2    82
&gt; 3 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       3    72
&gt; 4 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       4    77
&gt; 5 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       5    87</code></pre>
</div>
</div>
</div>
</section><section id="multiple-variables-in-column-names" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<p>A more challenging situation occurs when you have multiple pieces of information crammed into the column names, and you would like to store these in separate new variables.</p>
<div class="fragment">
<p>This dataset contains tuberculosis diagnoses collected by the World Health Organization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 7,240 × 58
&gt;    country      year sp_m_014 sp_m_1524 sp_m_2534 sp_m_3544 sp_m_4554 sp_m_5564
&gt;    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan  1980       NA        NA        NA        NA        NA        NA
&gt;  2 Afghanistan  1981       NA        NA        NA        NA        NA        NA
&gt;  3 Afghanistan  1982       NA        NA        NA        NA        NA        NA
&gt;  4 Afghanistan  1983       NA        NA        NA        NA        NA        NA
&gt;  5 Afghanistan  1984       NA        NA        NA        NA        NA        NA
&gt;  6 Afghanistan  1985       NA        NA        NA        NA        NA        NA
&gt;  7 Afghanistan  1986       NA        NA        NA        NA        NA        NA
&gt;  8 Afghanistan  1987       NA        NA        NA        NA        NA        NA
&gt;  9 Afghanistan  1988       NA        NA        NA        NA        NA        NA
&gt; 10 Afghanistan  1989       NA        NA        NA        NA        NA        NA
&gt; # ℹ 7,230 more rows
&gt; # ℹ 50 more variables: sp_m_65 &lt;dbl&gt;, sp_f_014 &lt;dbl&gt;, sp_f_1524 &lt;dbl&gt;,
&gt; #   sp_f_2534 &lt;dbl&gt;, sp_f_3544 &lt;dbl&gt;, sp_f_4554 &lt;dbl&gt;, sp_f_5564 &lt;dbl&gt;,
&gt; #   sp_f_65 &lt;dbl&gt;, sn_m_014 &lt;dbl&gt;, sn_m_1524 &lt;dbl&gt;, sn_m_2534 &lt;dbl&gt;,
&gt; #   sn_m_3544 &lt;dbl&gt;, sn_m_4554 &lt;dbl&gt;, sn_m_5564 &lt;dbl&gt;, sn_m_65 &lt;dbl&gt;,
&gt; #   sn_f_014 &lt;dbl&gt;, sn_f_1524 &lt;dbl&gt;, sn_f_2534 &lt;dbl&gt;, sn_f_3544 &lt;dbl&gt;,
&gt; #   sn_f_4554 &lt;dbl&gt;, sn_f_5564 &lt;dbl&gt;, sn_f_65 &lt;dbl&gt;, ep_m_014 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>The first two columns are self explanatory but what’s going on with the rest?</p>
</div>
</section><section id="multiple-variables-in-column-names-1" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<p>Data documentation and some minor investigation would lead you to figure out that the three elements in each of these column names are actually data!</p>
<ul>
<li>The first piece, <code>sp</code>/<code>sn</code>/<code>rel</code>/<code>ep</code>, describes the method used for the diagnosis</li>
<li>The second piece, <code>m</code>/<code>f</code> is the gender (coded as a binary variable in this dataset)</li>
<li>The third piece, <code>014</code>/<code>1524</code>/<code>2534</code>/<code>3544</code>/<code>4554</code>/<code>5564</code>/<code>65</code> is the age range (014 represents 0-14, for example)</li>
</ul>
<div class="fragment">
<p>To organize the six pieces of information in this dataset into six separate columns, we use <code>pivot_longer()</code> with a vector of column names for <code>names_to</code> and instructions for splitting the original variable names into pieces for <code>names_sep</code> as well as a column name for <code>values_to</code>!</p>
</div>
</section><section id="multiple-variables-in-column-names-2" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-28"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-28-1"><a href="#annotated-cell-28-1"></a>who2 <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-28-2"><a href="#annotated-cell-28-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="annotated-cell-28-3"><a href="#annotated-cell-28-3"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year),</span>
<span id="annotated-cell-28-4"><a href="#annotated-cell-28-4"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>), </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="6">6</button><span id="annotated-cell-28-5" class="code-annotation-target"><a href="#annotated-cell-28-5"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="annotated-cell-28-6"><a href="#annotated-cell-28-6"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="annotated-cell-28-7"><a href="#annotated-cell-28-7"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-28" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="5" data-code-annotation="6">You can use <code>names_pattern</code> instead of <code>names_sep</code> to extract variables from more complicated naming scenarios once you’ve learned regular expressions in a few weeks.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 405,440 × 6
&gt;    country      year diagnosis gender age   count
&gt;    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;
&gt;  1 Afghanistan  1980 sp        m      014      NA
&gt;  2 Afghanistan  1980 sp        m      1524     NA
&gt;  3 Afghanistan  1980 sp        m      2534     NA
&gt;  4 Afghanistan  1980 sp        m      3544     NA
&gt;  5 Afghanistan  1980 sp        m      4554     NA
&gt;  6 Afghanistan  1980 sp        m      5564     NA
&gt;  7 Afghanistan  1980 sp        m      65       NA
&gt;  8 Afghanistan  1980 sp        f      014      NA
&gt;  9 Afghanistan  1980 sp        f      1524     NA
&gt; 10 Afghanistan  1980 sp        f      2534     NA
&gt; # ℹ 405,430 more rows</code></pre>
</div>
</div>
</section><section id="variable-values-in-column-names" class="slide level2"><h2>Variable &amp; Values in Column Names</h2>
<p>This dataset contains data about five families, with the names and dates of birth of up to two children.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a>household</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 5
&gt;   family dob_child1 dob_child2 name_child1 name_child2
&gt;    &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      
&gt; 1      1 1998-11-26 2000-01-29 Susan       Jose       
&gt; 2      2 1996-06-22 NA         Mark        &lt;NA&gt;       
&gt; 3      3 2002-07-11 2004-04-05 Sam         Seth       
&gt; 4      4 2004-10-10 2009-08-27 Craig       Khai       
&gt; 5      5 2000-12-05 2005-02-28 Parker      Gracie</code></pre>
</div>
</div>
<div class="fragment">
<p>The new challenge in this dataset is that the column names contain the names of two variables (<code>dob</code>, <code>name</code>) and the values of another (<code>child</code>, with values <code>1</code> or <code>2</code>).</p>
</div>
</section><section id="variable-values-in-column-names-1" class="slide level2"><h2>Variable &amp; Values in Column Names</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="annotated-cell-30"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-30-1"><a href="#annotated-cell-30-1"></a>household <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-30-2"><a href="#annotated-cell-30-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="annotated-cell-30-3"><a href="#annotated-cell-30-3"></a>    <span class="at">cols =</span> <span class="sc">!</span>family, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="7">7</button><span id="annotated-cell-30-4" class="code-annotation-target"><a href="#annotated-cell-30-4"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"child"</span>),</span>
<span id="annotated-cell-30-5"><a href="#annotated-cell-30-5"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="8">8</button><span id="annotated-cell-30-6" class="code-annotation-target"><a href="#annotated-cell-30-6"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span></span>
<span id="annotated-cell-30-7"><a href="#annotated-cell-30-7"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="4" data-code-annotation="7"><code>.value</code> isn’t the name of a variable but a unique value that tells <code>pivot_longer</code> to use the first component of the pivoted column name as a variable name in the output.</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="6" data-code-annotation="8">Using <code>values_drop_na = TRUE</code> again since not every family has 2 children.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 9 × 4
&gt;   family child  dob        name  
&gt;    &lt;int&gt; &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt; 
&gt; 1      1 child1 1998-11-26 Susan 
&gt; 2      1 child2 2000-01-29 Jose  
&gt; 3      2 child1 1996-06-22 Mark  
&gt; 4      3 child1 2002-07-11 Sam   
&gt; 5      3 child2 2004-04-05 Seth  
&gt; 6      4 child1 2004-10-10 Craig 
&gt; 7      4 child2 2009-08-27 Khai  
&gt; 8      5 child1 2000-12-05 Parker
&gt; 9      5 child2 2005-02-28 Gracie</code></pre>
</div>
</div></div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/pivot_longer5_names-and-values.png" class="quarto-figure quarto-figure-center" style="width:75.0%"></p>
</figure>
</div>
</div>
</section><section id="pivot_wider" class="slide level2"><h2><code>pivot_wider</code></h2>
<p><code>pivot_wider()</code> is the opposite of <code>pivot_longer()</code>, which you use if you have data for the same observation taking up multiple rows.</p>
<div class="fragment">
<p>Here’s an example of data that we probably want to pivot wider (unless we want to plot each statistic in its own facet):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 6 × 3
&gt;   Group Statistic Value
&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
&gt; 1 A     Mean       1.28
&gt; 2 A     Median     1   
&gt; 3 A     SD         0.72
&gt; 4 B     Mean       2.81
&gt; 5 B     Median     2   
&gt; 6 B     SD         1.33</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>A common cue to use <code>pivot_wider()</code> is having measurements of different quantities in the same column.</p>
</div>
</section><section id="pivot_wider-example" class="slide level2"><h2>
<code>pivot_wider</code> Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-31"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-31-1"><a href="#annotated-cell-31-1"></a>wide_stats <span class="ot">&lt;-</span> long_stats <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="9">9</button><span id="annotated-cell-31-2" class="code-annotation-target"><a href="#annotated-cell-31-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> Group,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="10">10</button><span id="annotated-cell-31-3" class="code-annotation-target"><a href="#annotated-cell-31-3"></a>              <span class="at">names_from =</span> Statistic,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="11">11</button><span id="annotated-cell-31-4" class="code-annotation-target"><a href="#annotated-cell-31-4"></a>              <span class="at">values_from =</span> Value)</span>
<span id="annotated-cell-31-5"><a href="#annotated-cell-31-5"></a>wide_stats</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="2" data-code-annotation="9"><code>id_cols</code> is the column that uniquely identifies each row in the new dataset. Default is everything not in <code>names_from</code> and <code>values_from</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="3" data-code-annotation="10"><code>names_from</code> provides the names that will be used for the new columns</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="4" data-code-annotation="11"><code>values_from</code> provides the values that will be used to populate the cells of the new columns.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 2 × 4
&gt;   Group  Mean Median    SD
&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
&gt; 1 A      1.28      1  0.72
&gt; 2 B      2.81      2  1.33</code></pre>
</div>
</div>
<div class="fragment">
<p><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html"><code>pivot_wider()</code></a> also has a number of optional <code>names_*</code> and <code>values_*</code> arguments for more complicated transformations.</p>
</div>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:orange"><i class="fa-solid fa-triangle-exclamation" aria-label="triangle-exclamation"></i></span> Nested Data</strong></p>
</div>
<div class="callout-content">
<p>If there are multiple rows in the input that correspond to one cell in the output you’ll get a list-column. This means that you 1) need to fix something in your code/data because it shouldn’t be nested in this way or 2) need to use <code>unnest_wider()</code> or <code>unnest_longer()</code> in order to access this column of data. More on this <a href="https://r4ds.hadley.nz/rectangling.html#unnesting">here</a>.</p>
</div>
</div>
</div>
</div>
</section></section><section><section id="lab-1" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Lab</h1>

</section><section id="importing-tidying-data-1" class="slide level2"><h2>Importing &amp; Tidying Data</h2>
<ul>
<li><span class="semi-transparent">Go to the <a href="https://vsass.github.io/CSSS508/Lectures/Lecture5/CSSS508_Lecture5_index.html">Lecture 5 Homepage</a> and click on the link <code>Religion &amp; Income</code> under the Data section.</span></li>
<li><span class="semi-transparent">Click <em>File</em> &gt; <em>Save</em> to download this data to the same folder where your source document<sup>1</sup> will be saved for this lab.</span></li>
<li><span class="semi-transparent">Read in your data using the appropriate function from <code>readr</code>.</span></li>
<li>Pivot your data to make it tidy<sup>2</sup>.</li>
</ul><aside><ol class="aside-footnotes"><li id="fn14"><p><code>R</code> Script or <code>.qmd</code></p></li><li id="fn15"><p>There should be 3 columns in your final dataset</p></li></ol></aside></section></section><section><section id="break" class="title-slide slide level1 section-title center" data-background-color="#1e4655"><h1>Break!</h1>

</section><section id="data-types-in-r" class="slide level2"><h2>Data types in <code>R</code>
</h2>
<p>Going back to our list of data types in <code>R</code>:</p>
<div class="fragment">
<ul>
<li>Logicals</li>
<li>Factors</li>
<li>Date/Date-time</li>
<li>Numbers</li>
<li>Missing Values</li>
<li>Strings</li>
</ul>
</div>
</section><section id="data-types-in-r-1" class="slide level2"><h2>Data types in <code>R</code>
</h2>
<p>Going back to our list of data types in <code>R</code>:</p>
<ul>
<li><del>Logicals</del></li>
<li>Factors</li>
<li>Date/Date-time</li>
<li>Numbers</li>
<li>Missing Values</li>
<li>Strings</li>
</ul></section><section id="data-types-in-r-2" class="slide level2"><h2>Data types in <code>R</code>
</h2>
<p>Going back to our list of data types in <code>R</code>:</p>
<ul>
<li><del>Logicals</del></li>
<li><span style="color:#e15759">Factors</span></li>
<li><span style="color:#e15759">Date/Date-time</span></li>
<li>Numbers</li>
<li>Missing Values</li>
<li>Strings</li>
</ul></section></section><section><section id="working-with-factors" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Working with Factors</h1>

</section><section id="section-2" class="slide level2 section-title" data-menu-title="Forcats" data-background-image="images/forcats.png" data-background-size="contain" data-background-position="center" data-background-color="#1e4655"><h2></h2>
</section><section id="why-use-factors" class="slide level2"><h2>Why Use Factors?</h2>
<p>Factors are a special class of data specifically for categorical variables<sup>1</sup> which have a fixed, known, and mutually exclusive set of possible values<sup>2</sup>.</p>
<div class="fragment">
<p>Imagine we have a variable that records the month that an event occurred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a>month <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dec"</span>, <span class="st">"Apr"</span>, <span class="st">"Jan"</span>, <span class="st">"Mar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>The two main issues with coding this simply as a character string are that</p>
<ol type="1">
<li>It doesn’t help catch <em>spelling errors</em> and that</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a>month <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dec"</span>, <span class="st">"Apr"</span>, <span class="st">"Jam"</span>, <span class="st">"Mar"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Characters are <em>sorted alphabetically</em>, which is not necessarily intuitive or useful for your variable.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">sort</span>(month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "Apr" "Dec" "Jan" "Mar"</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn16"><p><span style="color:#e15759">For</span> <span style="color:#e15759">cat</span>egorical<span style="color:#e15759">s</span>; forcats is also an anagram of factors.</p></li><li id="fn17"><p>Factors can also be created from character strings that you want to display in non-alphabetical order</p></li></ol></aside></section><section id="factors" class="slide level2"><h2>Factors</h2>
<p>Factors have an additional specification called levels. These are the categories of the categorical variable. We can create a vector of the levels first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a></a>month_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb53-2"><a></a>  <span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, </span>
<span id="cb53-3"><a></a>  <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span></span>
<span id="cb53-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>And then we can create a factor like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a>month_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(month, <span class="at">levels =</span> month_levels)</span>
<span id="cb54-2"><a></a>month_factor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] Dec Apr Jan Mar
&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>We can see that the levels specify in which order the categories should be displayed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a><span class="fu">sort</span>(month_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] Jan Mar Apr Dec
&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
</div>
</div>
</section><section id="creating-factors" class="slide level2"><h2>Creating Factors</h2>
<p><code>factor</code> is Base <code>R</code>’s function for creating factors while <code>fct</code> is <code>forcats</code> function for making factors. A couple of things to note about their differences:</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="factor"><u><code>factor</code></u></h4>
<ul>
<li>Any values not specified as a level will be <strong>silently</strong> converted to <code>NA</code>
</li>
<li>Without specified levels, they’ll be created from the data in <strong>alphabetical</strong> order<sup>1</sup>
</li>
</ul>
</div><div class="column" style="width:50%;">
<h4 id="fct"><u><code>fct</code></u></h4>
<ul>
<li>Will send a <strong>error message</strong> if a value exists outside the specified levels</li>
<li>Without specified levels, they’ll be created from the data in <strong>order of first appearance</strong>
</li>
</ul>
</div></div>
</div>
<div class="fragment">
<p>You can create a factor by specifying <code>col_factor()</code> when reading in data with <code>readr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(csv, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">month =</span> <span class="fu">col_factor</span>(month_levels)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>If you need to access the levels directly you can use the Base <code>R</code> function <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a></a><span class="fu">levels</span>(month_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep" "Oct" "Nov" "Dec"</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn18"><p>This is risky to rely on since not every computer will sort strings the same way.</p></li></ol></aside></section><section id="changing-the-order-of-levels" class="slide level2"><h2>Changing the Order of Levels</h2>
<p>One of the more common data manipulations you’ll want to do with factors is to change the ordering of the levels. This could be to put them in a more intuitive order but also to make a visualization clearer and more impactful.</p>
<div class="fragment">
<p>Let’s use a subset of the General Social Survey<sup>1</sup> data to see what this might look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a></a>gss_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 21,483 × 9
&gt;     year marital         age race  rincome        partyid    relig denom tvhours
&gt;    &lt;int&gt; &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;      &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
&gt;  1  2000 Never married    26 White $8000 to 9999  Ind,near … Prot… Sout…      12
&gt;  2  2000 Divorced         48 White $8000 to 9999  Not str r… Prot… Bapt…      NA
&gt;  3  2000 Widowed          67 White Not applicable Independe… Prot… No d…       2
&gt;  4  2000 Never married    39 White Not applicable Ind,near … Orth… Not …       4
&gt;  5  2000 Divorced         25 White Not applicable Not str d… None  Not …       1
&gt;  6  2000 Married          25 White $20000 - 24999 Strong de… Prot… Sout…      NA
&gt;  7  2000 Never married    36 White $25000 or more Not str r… Chri… Not …       3
&gt;  8  2000 Divorced         44 White $7000 to 7999  Ind,near … Prot… Luth…      NA
&gt;  9  2000 Married          44 White $25000 or more Not str d… Prot… Other       0
&gt; 10  2000 Married          47 White $25000 or more Strong re… Prot… Sout…       3
&gt; # ℹ 21,473 more rows</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn19"><p>Once you’ve loaded <code>forcats</code> you can run <code>?gss_cat</code> to learn more.</p></li></ol></aside></section><section id="changing-the-order-of-levels-1" class="slide level2"><h2>Changing the Order of Levels</h2>
<p>There are four related functions to change the level ordering in <code>forcats</code>.</p>
<div class="fragment">
<p><strong><code>fct_reorder()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-41"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-41" data-target-annotation="1">1</button><span id="annotated-cell-41-1" class="code-annotation-target"><a href="#annotated-cell-41-1"></a><span class="fu">fct_reorder</span>(<span class="at">.f =</span> factor,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-41" data-target-annotation="2">2</button><span id="annotated-cell-41-2" class="code-annotation-target"><a href="#annotated-cell-41-2"></a>            <span class="at">.x =</span> ordering_vector,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-41" data-target-annotation="3">3</button><span id="annotated-cell-41-3" class="code-annotation-target"><a href="#annotated-cell-41-3"></a>            <span class="at">.fun =</span> optional_function)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-41" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-41" data-code-lines="1" data-code-annotation="1"><code>factor</code> is the factor to reorder (or a character string to be turned into a factor)</span>
</dd>
<dt data-target-cell="annotated-cell-41" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-41" data-code-lines="2" data-code-annotation="2"><code>ordering_vector</code> specifies how to reorder <code>factor</code></span>
</dd>
<dt data-target-cell="annotated-cell-41" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-41" data-code-lines="3" data-code-annotation="3"><code>optional_function</code> is applied if there are multiple values of <code>ordering_vector</code> for each value of <code>factor</code> (the default is to take the median)</span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p><strong><code>fct_relevel()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-42"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-42-1"><a href="#annotated-cell-42-1"></a><span class="fu">fct_relevel</span>(<span class="at">.f =</span> factor, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="4">4</button><span id="annotated-cell-42-2" class="code-annotation-target"><a href="#annotated-cell-42-2"></a>            <span class="at">... =</span> value,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="5">5</button><span id="annotated-cell-42-3" class="code-annotation-target"><a href="#annotated-cell-42-3"></a>            <span class="at">after =</span> placement)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-42" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="2" data-code-annotation="4"><code>value</code> is either a function (i.e.&nbsp;<code>sort</code>) or a character level (default is to move it to the front of the vector)</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="3" data-code-annotation="5"><code>placement</code> is an optional vector index where the level should be placed</span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p><strong><code>fct_reorder2()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-43"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-43-1"><a href="#annotated-cell-43-1"></a><span class="fu">fct_reorder2</span>(<span class="at">.f =</span> factor, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="6">6</button><span id="annotated-cell-43-2" class="code-annotation-target"><a href="#annotated-cell-43-2"></a>            <span class="at">.x =</span> vector1,</span>
<span id="annotated-cell-43-3"><a href="#annotated-cell-43-3"></a>            <span class="at">.y =</span> vector2)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-43" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="2,3" data-code-annotation="6"><code>fct_reorder2</code> reorders <code>factor</code> by the values of <code>vector2</code> associated with the largest values of <code>vector1.</code></span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p><strong><code>fct_infreq()</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-44"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="7">7</button><span id="annotated-cell-44-1" class="code-annotation-target"><a href="#annotated-cell-44-1"></a><span class="fu">fct_infreq</span>(<span class="at">.f =</span> factor)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-44" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="1" data-code-annotation="7"><code>fct_infreq</code> reorders <code>factor</code> in decreasing frequency. See other variations <a href="https://forcats.tidyverse.org/reference/fct_inorder.html">here</a>. Use with <code>fct_rev()</code> for increasing frequency.</span>
</dd>
</dl>
</div>
</div>
<p><br></p>
</div>
</section><section id="changing-the-order-of-levels-2" class="slide level2 scrollable"><h2>Changing the Order of Levels <span style="color:#99a486"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span>
</h2>
<p>There are four related functions to change the level ordering in <code>forcats</code>.</p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-4-1"><span style="color:#e15759; font-family:Roboto Mono">fct_reorder</span></a><sup>1</sup></li>
<li><a href="#tabset-4-2"><span style="color:#4e79a7; font-family:Roboto Mono">fct_relevel</span></a><sup>2</sup></li>
<li><a href="#tabset-4-3"><span style="color:#f28e2c; font-family:Roboto Mono">fct_reorder2</span></a></li>
<li><a href="#tabset-4-4"><span style="color:#76b7b2; font-family:Roboto Mono">fct_infreq</span></a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1">
<p><strong>Without <code>fct_reorder()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a></a>relig_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a></a>  <span class="fu">summarize</span>(</span>
<span id="cb63-3"><a></a>    <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-4"><a></a>    <span class="at">.by =</span> relig</span>
<span id="cb63-5"><a></a>  )</span>
<span id="cb63-6"><a></a></span>
<span id="cb63-7"><a></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> relig)) <span class="sc">+</span> </span>
<span id="cb63-8"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-56-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<p><strong>With <code>fct_reorder()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a></a>relig_summary <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-3"><a></a>    <span class="at">relig =</span> <span class="fu">fct_reorder</span>(relig, tvhours)</span>
<span id="cb64-4"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> relig)) <span class="sc">+</span></span>
<span id="cb64-6"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-57-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2">
<p><strong>Without <code>fct_relevel()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a></a>rincome_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-3"><a></a>    <span class="at">age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-4"><a></a>    <span class="at">.by =</span> rincome</span>
<span id="cb65-5"><a></a>  )</span>
<span id="cb65-6"><a></a></span>
<span id="cb65-7"><a></a><span class="fu">ggplot</span>(rincome_summary, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> rincome)) <span class="sc">+</span> </span>
<span id="cb65-8"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-58-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<p><strong>With <code>fct_relevel()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a></a><span class="fu">ggplot</span>(rincome_summary, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> <span class="fu">fct_relevel</span>(rincome, <span class="st">"Not applicable"</span>))) <span class="sc">+</span></span>
<span id="cb66-2"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-59-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3">
<p><strong>Without <code>fct_reorder2()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a></a>by_age <span class="ot">&lt;-</span> gss_cat <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a></a>  <span class="fu">count</span>(age, marital) <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-5"><a></a>    <span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), </span>
<span id="cb67-6"><a></a>    <span class="at">.by =</span> age</span>
<span id="cb67-7"><a></a>  )</span>
<span id="cb67-8"><a></a></span>
<span id="cb67-9"><a></a><span class="fu">ggplot</span>(by_age, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">color =</span> marital)) <span class="sc">+</span></span>
<span id="cb67-10"><a></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb67-11"><a></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-60-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<p><strong>With <code>fct_reorder()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a></a><span class="fu">ggplot</span>(by_age, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop, <span class="at">color =</span> <span class="fu">fct_reorder2</span>(marital, age, prop))) <span class="sc">+</span></span>
<span id="cb68-2"><a></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span> </span>
<span id="cb68-4"><a></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"marital"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-61-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4">
<p><strong>Without <code>fct_infreq()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span> </span>
<span id="cb69-3"><a></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-62-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<p><strong>With <code>fct_infreq()</code></strong></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> marital <span class="sc">|&gt;</span> <span class="fu">fct_infreq</span>() <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>()) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span></span>
<span id="cb70-4"><a></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-63-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn20"><p>Use <code>fct_reorder</code> and <code>fct_reorder2</code> for categorical variables where ordering is arbitary.</p></li><li id="fn21"><p>Use <code>fct_relevel</code> for categorical variables that already have an inherent ordering.</p></li></ol></aside></section><section id="changing-the-value-of-levels" class="slide level2"><h2>Changing the Value of Levels</h2>
<p>You may also want to change the actual values of your factor levels. The main way to do this is <code>fct_recode()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-45"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="8">8</button><span id="annotated-cell-45-1" class="code-annotation-target"><a href="#annotated-cell-45-1"></a>gss_cat <span class="sc">|&gt;</span> <span class="fu">count</span>(partyid)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-45" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="1" data-code-annotation="8">You can use <code>count()</code> to get the full list of levels for a variable and their respective counts.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 10 × 2
&gt;    partyid                n
&gt;    &lt;fct&gt;              &lt;int&gt;
&gt;  1 No answer            154
&gt;  2 Don't know             1
&gt;  3 Other party          393
&gt;  4 Strong republican   2314
&gt;  5 Not str republican  3032
&gt;  6 Ind,near rep        1791
&gt;  7 Independent         4119
&gt;  8 Ind,near dem        2499
&gt;  9 Not str democrat    3690
&gt; 10 Strong democrat     3490</code></pre>
</div>
</div>
</div>
</section><section id="fct_recode" class="slide level2"><h2><code>fct_recode()</code></h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-3"><a></a>    <span class="at">partyid =</span> <span class="fu">fct_recode</span>(partyid,</span>
<span id="cb72-4"><a></a>      <span class="st">"Republican, strong"</span> <span class="ot">=</span> <span class="st">"Strong republican"</span>,</span>
<span id="cb72-5"><a></a>      <span class="st">"Republican, weak"</span> <span class="ot">=</span> <span class="st">"Not str republican"</span>,</span>
<span id="cb72-6"><a></a>      <span class="st">"Independent, near rep"</span> <span class="ot">=</span> <span class="st">"Ind,near rep"</span>,</span>
<span id="cb72-7"><a></a>      <span class="st">"Independent, near dem"</span> <span class="ot">=</span> <span class="st">"Ind,near dem"</span>,</span>
<span id="cb72-8"><a></a>      <span class="st">"Democrat, weak"</span> <span class="ot">=</span> <span class="st">"Not str democrat"</span>,</span>
<span id="cb72-9"><a></a>      <span class="st">"Democrat, strong"</span> <span class="ot">=</span> <span class="st">"Strong democrat"</span></span>
<span id="cb72-10"><a></a>    )</span>
<span id="cb72-11"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb72-12"><a></a>  <span class="fu">count</span>(partyid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 10 × 2
&gt;    partyid                   n
&gt;    &lt;fct&gt;                 &lt;int&gt;
&gt;  1 No answer               154
&gt;  2 Don't know                1
&gt;  3 Other party             393
&gt;  4 Republican, strong     2314
&gt;  5 Republican, weak       3032
&gt;  6 Independent, near rep  1791
&gt;  7 Independent            4119
&gt;  8 Independent, near dem  2499
&gt;  9 Democrat, weak         3690
&gt; 10 Democrat, strong       3490</code></pre>
</div>
</div>
</div></div>
<div class="fragment">
<p>Some features of <code>fct_recode()</code>:</p>
<ul>
<li class="fragment">Will leave the levels that aren’t explicitly mentioned, as is.</li>
<li class="fragment">Will warn you if you accidentally refer to a level that doesn’t exist.</li>
<li class="fragment">You can combine groups by assigning multiple old levels to the same new level.</li>
</ul>
</div>
</section><section id="fct_collapse" class="slide level2"><h2><code>fct_collapse()</code></h2>
<p>A useful variant of <code>fct_recode()</code> is <code>fct_collapse()</code> which will allow you to collapse a lot of levels at once.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-3"><a></a>    <span class="at">partyid =</span> <span class="fu">fct_collapse</span>(partyid,</span>
<span id="cb74-4"><a></a>      <span class="st">"other"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"No answer"</span>, <span class="st">"Don't know"</span>, <span class="st">"Other party"</span>),</span>
<span id="cb74-5"><a></a>      <span class="st">"rep"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Strong republican"</span>, <span class="st">"Not str republican"</span>),</span>
<span id="cb74-6"><a></a>      <span class="st">"ind"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Ind,near rep"</span>, <span class="st">"Independent"</span>, <span class="st">"Ind,near dem"</span>),</span>
<span id="cb74-7"><a></a>      <span class="st">"dem"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Not str democrat"</span>, <span class="st">"Strong democrat"</span>)</span>
<span id="cb74-8"><a></a>    )</span>
<span id="cb74-9"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb74-10"><a></a>  <span class="fu">count</span>(partyid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 4 × 2
&gt;   partyid     n
&gt;   &lt;fct&gt;   &lt;int&gt;
&gt; 1 other     548
&gt; 2 rep      5346
&gt; 3 ind      8409
&gt; 4 dem      7180</code></pre>
</div>
</div>
</div>
</section><section id="fct_lump_" class="slide level2"><h2><code>fct_lump_*</code></h2>
<p>Sometimes you’ll have several levels of a variable that have a small enough <code>N</code> to warrant grouping them together into an <code>other</code> category. The family of <code>fct_lump_*</code> functions are designed to help with this.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-47"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-47-1"><a href="#annotated-cell-47-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-47" data-target-annotation="9">9</button><span id="annotated-cell-47-2" class="code-annotation-target"><a href="#annotated-cell-47-2"></a>  <span class="fu">mutate</span>(<span class="at">relig =</span> <span class="fu">fct_lump_n</span>(relig, <span class="at">n =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-47-3"><a href="#annotated-cell-47-3"></a>  <span class="fu">count</span>(relig, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-47" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-47" data-code-lines="2" data-code-annotation="9">Other functions include: <code>fct_lump_min()</code>, <code>fct_lump_prop()</code>, <code>fct_lump_lowfreq()</code>. Read more about them <a href="https://forcats.tidyverse.org/reference/fct_lump.html">here</a>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 10 × 2
&gt;    relig                       n
&gt;    &lt;fct&gt;                   &lt;int&gt;
&gt;  1 Protestant              10846
&gt;  2 Catholic                 5124
&gt;  3 None                     3523
&gt;  4 Christian                 689
&gt;  5 Other                     458
&gt;  6 Jewish                    388
&gt;  7 Buddhism                  147
&gt;  8 Inter-nondenominational   109
&gt;  9 Moslem/islam              104
&gt; 10 Orthodox-christian         95</code></pre>
</div>
</div>
</div>
</section><section id="ordered-factors" class="slide level2"><h2>Ordered Factors</h2>
<p>So far we’ve mostly been discussing how to code nominal variables, or categorical variables that have no inherent ordering.</p>
<div class="fragment">
<p>If you want to specify that your factor has a strict order you can classify it as a ordered factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-48"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-48" data-target-annotation="10">10</button><span id="annotated-cell-48-1" class="code-annotation-target"><a href="#annotated-cell-48-1"></a><span class="fu">ordered</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-48" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-48" data-code-lines="1" data-code-annotation="10">Ordered factors imply a strict ordering and equal distance between levels: the first level is “less than” the second level by the same amount that the second level is “less than” the third level, and so on.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] a b c
&gt; Levels: a &lt; b &lt; c</code></pre>
</div>
</div>
<p><br></p>
</div>
<div class="fragment">
<p>In practice there are only two ways in which ordered factors are different than factors:</p>
<ol type="1">
<li class="fragment">
<code>scale_color_viridis()</code>/<code>scale_fill_viridis()</code> will be used automatically when mapping an ordered factored in <code>ggplot2</code> because it implies an ordered ranking</li>
<li class="fragment">If you use an ordered function in a linear model, it will use “polygonal contrasts”. You can learn more about what this means <a href="https://debruine.github.io/faux/articles/contrasts.html">here</a>.</li>
</ol>
</div>
</section></section><section><section id="lab-2" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Lab</h1>

</section><section id="importing-tidying-data-2" class="slide level2"><h2>Importing &amp; Tidying Data</h2>
<ul>
<li><span class="semi-transparent">Go to the <a href="https://vsass.github.io/CSSS508/Lectures/Lecture5/CSSS508_Lecture5_index.html">Lecture 5 Homepage</a> and click on the link <code>Religion &amp; Income</code> under the Data section.</span></li>
<li><span class="semi-transparent">Click <em>File</em> &gt; <em>Save</em> to download this data to the same folder where your source document<sup>1</sup> will be saved for this lab.</span></li>
<li><span class="semi-transparent">Read in your data using the appropriate function from <code>readr</code>.</span></li>
<li><span class="semi-transparent">Pivot your data to make it tidy<sup>2</sup>.</span></li>
<li>Turn two of the variables into factors<sup>3</sup>.</li>
</ul><aside><ol class="aside-footnotes"><li id="fn22"><p><code>R</code> Script or <code>.qmd</code></p></li><li id="fn23"><p>There should be 3 columns in your final dataset</p></li><li id="fn24"><p>Hint: Which two variables are categorical?</p></li></ol></aside></section></section><section id="wrangling-date-date-time-data" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Wrangling Date/<br>Date-Time Data</h1>

</section><section><section id="section-3" class="title-slide slide level1 section-title center" data-menu-title="`lubridate`" data-background-image="images/lubridate.png" data-background-size="contain" data-background-position="center" data-background-color="#1e4655"><h1></h1>

</section><section id="date-and-date-time" class="slide level2"><h2>Date and Date-Time</h2>
<p>While they may look like character strings, Dates, Date-Times and Times<sup>1</sup> are each separate classes of data.</p>
<div class="columns">
<div class="column" style="width:33%;">
<div class="fragment">
<p><strong>Data Type</strong></p>
<ul>
<li>Date</li>
<li>Date</li>
<li>Date-Time</li>
<li>Date-Time</li>
<li>Time</li>
</ul>
</div>
</div><div class="column" style="width:34%;">
<div class="fragment">
<p><strong>Package</strong></p>
<ul>
<li><code>base</code></li>
<li><code>lubridate</code></li>
<li><code>base</code></li>
<li><code>lubridate</code></li>
<li><code>hms</code></li>
</ul>
</div>
</div><div class="column" style="width:33%;">
<div class="fragment">
<p><strong>Reference in <code>R</code></strong></p>
<ul>
<li><code>POSIXct</code></li>
<li><code>date</code></li>
<li><code>POSIXlt</code></li>
<li><code>dttm</code></li>
<li><code>time</code></li>
</ul>
</div>
</div></div>
<div class="fragment">
<p>Dates and times are challenging data types because there are physical properties but also additional geopolitical definitions that don’t always neatly align with physical reality.</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn25"><p>The <code>hms</code> package can be used to deal with times but they’re not very common.</p></li></ol></aside></section><section id="creating-datesdate-times" class="slide level2 scrollable"><h2>Creating Dates/Date-Times <span style="color:#99a486"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span>
</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-5-1">On Import</a></li>
<li><a href="#tabset-5-2">String</a></li>
<li><a href="#tabset-5-3">Individual Components</a></li>
<li><a href="#tabset-5-4">Existing Object</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>If your data is in <code>ISO8601</code> date or date-time format<sup>1</sup> <code>readr</code> will automatically recognize it and read it in as a date/date-time.</p>
<div class="fragment">
<p>If you’re reading in a different date/date-time format you can use <code>col_types</code> plus <code>col_date()</code> or <code>col_datetime()</code> along with a date-time format.</p>
</div>
<div class="fragment">
<p><br></p>
<div class="custom-small">
<table class="caption-top">
<caption>All date formats understood by readr<sup>2</sup>
</caption>
<thead><tr class="header">
<th>Type</th>
<th>Code</th>
<th>Meaning</th>
<th>Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Year</td>
<td><code>%Y</code></td>
<td>4 digit year</td>
<td>2021</td>
</tr>
<tr class="even">
<td></td>
<td><code>%y</code></td>
<td>2 digit year</td>
<td>21</td>
</tr>
<tr class="odd">
<td>Month</td>
<td><code>%m</code></td>
<td>Number</td>
<td>2</td>
</tr>
<tr class="even">
<td></td>
<td><code>%b</code></td>
<td>Abbreviated name</td>
<td>Feb</td>
</tr>
<tr class="odd">
<td></td>
<td>
<code>%B</code><sup>3</sup>
</td>
<td>Full name</td>
<td>February</td>
</tr>
<tr class="even">
<td>Day</td>
<td><code>%d</code></td>
<td>Two digits</td>
<td>02</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%e</code></td>
<td>One or two digits</td>
<td>2</td>
</tr>
<tr class="even">
<td>Time</td>
<td><code>%H</code></td>
<td>24-hour hour</td>
<td>13</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%I</code></td>
<td>12-hour hour</td>
<td>1</td>
</tr>
<tr class="even">
<td></td>
<td><code>%p</code></td>
<td>AM/PM</td>
<td>pm</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%M</code></td>
<td>Minutes</td>
<td>35</td>
</tr>
<tr class="even">
<td></td>
<td><code>%S</code></td>
<td>Seconds</td>
<td>45</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%OS</code></td>
<td>Seconds with decimal component</td>
<td>45.35</td>
</tr>
<tr class="even">
<td></td>
<td><code>%Z</code></td>
<td>Time zone name</td>
<td>America/Chicago</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%z</code></td>
<td>Offset from UTC</td>
<td>+0800</td>
</tr>
<tr class="even">
<td>Other</td>
<td><code>%.</code></td>
<td>Skip one non-digit</td>
<td>:</td>
</tr>
<tr class="odd">
<td></td>
<td><code>%*</code></td>
<td>Skip any number of non-digits</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a></a>csv <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb78-2"><a></a><span class="st">  date</span></span>
<span id="cb78-3"><a></a><span class="st">  05/22/23</span></span>
<span id="cb78-4"><a></a><span class="st">"</span></span>
<span id="cb78-5"><a></a></span>
<span id="cb78-6"><a></a><span class="fu">read_csv</span>(csv, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">date =</span> <span class="fu">col_date</span>(<span class="st">"%m/%d/%y"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 1 × 1
&gt;   date      
&gt;   &lt;date&gt;    
&gt; 1 2023-05-22</code></pre>
</div>
</div>
<p><br></p>
</div>
</div>
<div id="tabset-5-2">
<p>You can also use lubridate’s helper functions to specify a date format automatically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a></a><span class="fu">ymd</span>(<span class="st">"2017-01-31"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a></a><span class="fu">mdy</span>(<span class="st">"January 31st, 2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a></a><span class="fu">dmy</span>(<span class="st">"31-Jan-2017"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31"</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>If you need to specify a date-time you can use these helper functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a></a><span class="fu">ymd_hms</span>(<span class="st">"2017-01-31 20:11:59"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31 20:11:59 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a></a><span class="fu">mdy_hm</span>(<span class="st">"01/31/2017 08:01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31 08:01:00 UTC"</code></pre>
</div>
</div>
<p><br></p>
</div>
<div class="fragment">
<p>If you provide a date object with a timezone it’ll automatically be converted to a date-time object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a></a><span class="fu">ymd</span>(<span class="st">"2017-01-31"</span>, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2017-01-31 UTC"</code></pre>
</div>
</div>
<p><br></p>
</div>
</div>
<div id="tabset-5-3">
<p>If you have time elements in separate variables, like in the <code>flights</code> dataset…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb92-2"><a></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb92-3"><a></a>  <span class="fu">select</span>(year, month, day, hour, minute)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 336,776 × 5
&gt;     year month   day  hour minute
&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1  2013     1     1     5     15
&gt;  2  2013     1     1     5     29
&gt;  3  2013     1     1     5     40
&gt;  4  2013     1     1     5     45
&gt;  5  2013     1     1     6      0
&gt;  6  2013     1     1     5     58
&gt;  7  2013     1     1     6      0
&gt;  8  2013     1     1     6      0
&gt;  9  2013     1     1     6      0
&gt; 10  2013     1     1     6      0
&gt; # ℹ 336,766 more rows</code></pre>
</div>
</div>
<div class="fragment">
<p>…you can use <code>make_date</code> or <code>make_datetime</code> to create your date/time object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a></a>  <span class="fu">select</span>(year, month, day, hour, minute) <span class="sc">|&gt;</span> </span>
<span id="cb94-3"><a></a>  <span class="fu">mutate</span>(<span class="at">departure =</span> <span class="fu">make_datetime</span>(year, month, day, hour, minute))</span>
<span id="cb94-4"><a></a>flights2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 336,776 × 6
&gt;     year month   day  hour minute departure          
&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
&gt;  1  2013     1     1     5     15 2013-01-01 05:15:00
&gt;  2  2013     1     1     5     29 2013-01-01 05:29:00
&gt;  3  2013     1     1     5     40 2013-01-01 05:40:00
&gt;  4  2013     1     1     5     45 2013-01-01 05:45:00
&gt;  5  2013     1     1     6      0 2013-01-01 06:00:00
&gt;  6  2013     1     1     5     58 2013-01-01 05:58:00
&gt;  7  2013     1     1     6      0 2013-01-01 06:00:00
&gt;  8  2013     1     1     6      0 2013-01-01 06:00:00
&gt;  9  2013     1     1     6      0 2013-01-01 06:00:00
&gt; 10  2013     1     1     6      0 2013-01-01 06:00:00
&gt; # ℹ 336,766 more rows</code></pre>
</div>
</div>
<p><br></p>
</div>
<div class="fragment">
<p>Note that when you use date-times in a numeric context (like in a histogram), 1 means 1 second, so a <code>binwidth</code> of 86400 means one day. For dates, 1 means 1 day.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a></a><span class="fu">ggplot</span>(flights2, <span class="fu">aes</span>(<span class="at">x =</span> departure)) <span class="sc">+</span> </span>
<span id="cb96-2"><a></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">86400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="CSSS508_Lecture5_files/figure-revealjs/unnamed-chunk-76-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</div>
</div>
<div id="tabset-5-4">
<p><code>as_datetime()</code> and <code>as_date()</code> are used to coerce existing date/time objects into their counterpart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a></a><span class="fu">as_datetime</span>(<span class="fu">today</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2025-09-19 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a></a><span class="fu">as_date</span>(<span class="fu">now</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2025-09-19"</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>While <code>ISO8601</code> format is read in as a string of human-readable date/times, another common date/time format, <code>Unix</code> time, is represented by the number of seconds that have elapsed since 1 January 1970 at 0:00:00 UTC.</p>
</div>
<div class="fragment">
<p>If the offset is in seconds you’ll want to use <code>as_datetime()</code> and if it’s in days use <code>as_date()</code> for the conversion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a></a><span class="fu">as_datetime</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "1970-01-01 00:00:01 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a></a><span class="fu">as_datetime</span>(<span class="dv">5057</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "1970-01-01 01:24:17 UTC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a></a><span class="fu">as_date</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "1970-01-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a></a><span class="fu">as_date</span>(<span class="dv">5057</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "1983-11-06"</code></pre>
</div>
</div>
<p><br></p>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn26"><p>The international standard for writing dates.</p></li><li id="fn27"><p>Note that no matter how you specify the date format, it’s always displayed the same way once you get it into R: <code>%Y-%m-%d</code></p></li><li id="fn28"><p>If you’re using either <code>%b</code> or <code>%B</code> and working with non-English dates, you’ll also need to provide a locale(). See <a href="https://readr.tidyverse.org/reference/date_names.html">these functions</a> for more information.</p></li></ol></aside></section><section id="extracting-time-components" class="slide level2"><h2>Extracting Time Components</h2>
<p>We’ve discussed how to make a date/time object from individual components using <code>make_date()</code> and <code>make_datetime()</code> but what if you need to extract an element from a date/time?</p>
<div class="fragment">
<p>There are a number of accessor functions that allow you to do just that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-49"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-49-1"><a href="#annotated-cell-49-1"></a>datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2020-01-30 12:30:45"</span>)</span>
<span id="annotated-cell-49-2"><a href="#annotated-cell-49-2"></a></span>
<span id="annotated-cell-49-3"><a href="#annotated-cell-49-3"></a><span class="fu">year</span>(datetime)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-49" data-target-annotation="1">1</button><span id="annotated-cell-49-4" class="code-annotation-target"><a href="#annotated-cell-49-4"></a><span class="fu">month</span>(datetime)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-49" data-target-annotation="2">2</button><span id="annotated-cell-49-5" class="code-annotation-target"><a href="#annotated-cell-49-5"></a><span class="fu">mday</span>(datetime)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-49" data-target-annotation="3">3</button><span id="annotated-cell-49-6" class="code-annotation-target"><a href="#annotated-cell-49-6"></a><span class="fu">yday</span>(datetime)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-49" data-target-annotation="4">4</button><span id="annotated-cell-49-7" class="code-annotation-target"><a href="#annotated-cell-49-7"></a><span class="fu">wday</span>(datetime)</span>
<span id="annotated-cell-49-8"><a href="#annotated-cell-49-8"></a><span class="fu">hour</span>(datetime)</span>
<span id="annotated-cell-49-9"><a href="#annotated-cell-49-9"></a><span class="fu">minute</span>(datetime)</span>
<span id="annotated-cell-49-10"><a href="#annotated-cell-49-10"></a><span class="fu">second</span>(datetime)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-49" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-49" data-code-lines="4" data-code-annotation="1">You can set <code>label = TRUE</code> to return the abbreviated name and <code>abbr = FALSE</code> to return the full name (i.e.&nbsp;<code>month(datetime, label = TRUE)</code> returns <strong><span style="color:#76b7b2">Jan</span></strong> and <code>month(datetime, label = TRUE, abbr = FALSE)</code> returns <strong><span style="color:#76b7b2">January</span></strong>)</span>
</dd>
<dt data-target-cell="annotated-cell-49" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-49" data-code-lines="5" data-code-annotation="2">Day of the month.</span>
</dd>
<dt data-target-cell="annotated-cell-49" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-49" data-code-lines="6" data-code-annotation="3">Day of the year.</span>
</dd>
<dt data-target-cell="annotated-cell-49" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-49" data-code-lines="7" data-code-annotation="4">Day of the week. You can set <code>label = TRUE</code> to return the abbreviated name and <code>abbr = FALSE</code> to return the full name (i.e.&nbsp;<code>wday(datetime, label = TRUE)</code> returns <strong><span style="color:#76b7b2">Thu</span></strong> and <code>wday(datetime, label = TRUE, abbr = FALSE)</code> returns <strong><span style="color:#76b7b2">Thursday</span></strong>)</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 2020
&gt; [1] 1
&gt; [1] 30
&gt; [1] 30
&gt; [1] 5
&gt; [1] 12
&gt; [1] 30
&gt; [1] 45</code></pre>
</div>
</div>
</div>
</section><section id="changing-datetimes" class="slide level2"><h2>Changing Date/Times</h2>
<p>While less common, you may need to recode a date/time variable which you can also do with these accessor functions.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a></a>datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2020-01-30 08:05:35"</span>)</span>
<span id="cb110-2"><a></a></span>
<span id="cb110-3"><a></a><span class="fu">year</span>(datetime) <span class="ot">&lt;-</span> <span class="dv">2030</span></span>
<span id="cb110-4"><a></a><span class="fu">hour</span>(datetime) <span class="ot">&lt;-</span> <span class="fu">hour</span>(datetime) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb110-5"><a></a></span>
<span id="cb110-6"><a></a>datetime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2030-01-30 09:05:35 UTC"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>An alternative<sup>1</sup> way to do this is by using <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code>:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a></a><span class="fu">update</span>(datetime, <span class="at">year =</span> <span class="dv">2030</span>, <span class="at">month =</span> <span class="dv">2</span>, <span class="at">mday =</span> <span class="dv">2</span>, <span class="at">hour =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2030-02-02 02:05:35 UTC"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>A nice feature of this function is that if values are too big for the unit in question, they will automatically roll over:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a></a><span class="fu">update</span>(<span class="fu">ymd</span>(<span class="st">"2023-02-01"</span>), <span class="at">mday =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2023-03-02"</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn29"><p>And more efficient when needing to specify multiple aspects of a date/time variable.</p></li></ol></aside></section><section id="rounding-dates" class="slide level2"><h2>Rounding Dates</h2>
<p>Alternatively, you can round your date/time objects to a nearby unit with these three functions: <code>floor_date()</code>, <code>round_date()</code>, and <code>ceiling_date()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-53"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-53-1"><a href="#annotated-cell-53-1"></a>datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2020-01-30 08:05:35"</span>)</span>
<span id="annotated-cell-53-2"><a href="#annotated-cell-53-2"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-53" data-target-annotation="5">5</button><span id="annotated-cell-53-3" class="code-annotation-target"><a href="#annotated-cell-53-3"></a><span class="fu">floor_date</span>(datetime, <span class="at">unit =</span> <span class="st">"week"</span>)</span>
<span id="annotated-cell-53-4"><a href="#annotated-cell-53-4"></a><span class="fu">round_date</span>(datetime, <span class="at">unit =</span> <span class="st">"week"</span>, <span class="at">week_start =</span> <span class="dv">1</span>)</span>
<span id="annotated-cell-53-5"><a href="#annotated-cell-53-5"></a><span class="fu">ceiling_date</span>(datetime, <span class="at">unit =</span> <span class="st">"hour"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-53" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-53" data-code-lines="3,4,5" data-code-annotation="5">These functions take 3 arguments: a date/time vector, a unit of time to round by (valid base units include <code>second</code>, <code>minute</code>, <code>hour</code>, <code>day</code>, <code>week</code>, <code>month</code>, <code>bimonth</code>, <code>quarter</code>, <code>season</code>, <code>halfyear</code> and <code>year</code>), and the day of the week that the week starts (default is 7, or Sunday).</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2020-01-26 UTC"
&gt; [1] "2020-01-27 UTC"
&gt; [1] "2020-01-30 09:00:00 UTC"</code></pre>
</div>
</div>
</div>
</section><section id="spans-of-time" class="slide level2"><h2>Spans of time</h2>
<p>There are three different timespan classes in <code>lubridate</code>, which reflect the complexity of date/time data.</p>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/timespans.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section><section id="durations" class="slide level2"><h2>Durations</h2>
<p>Durations represent precise physical time. When you subtract two dates, you’ll get a <code>difftime</code> object.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-54"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-54-1"><a href="#annotated-cell-54-1"></a>s_age <span class="ot">&lt;-</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">ymd</span>(<span class="st">"2023-05-28"</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="6">6</button><span id="annotated-cell-54-2" class="code-annotation-target"><a href="#annotated-cell-54-2"></a>s_age</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="7">7</button><span id="annotated-cell-54-3" class="code-annotation-target"><a href="#annotated-cell-54-3"></a><span class="fu">as.duration</span>(s_age)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-54" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="2" data-code-annotation="6"><code>difftime</code> objects record time spans in seconds, minutes, hours, days, or weeks. This is fairly ambiguous so <code>lubridate</code> provides a more consistent alternative: the <code>duration</code>, which always uses seconds.</span>
</dd>
<dt data-target-cell="annotated-cell-54" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="3" data-code-annotation="7">Larger units are created by converting minutes, hours, days, weeks, and years to seconds.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Time difference of 845 days
&gt; [1] "73008000s (~2.31 years)"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>There are a variety of constructors to create durations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-55"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-55-1"><a href="#annotated-cell-55-1"></a><span class="fu">dseconds</span>(<span class="dv">15</span>)</span>
<span id="annotated-cell-55-2"><a href="#annotated-cell-55-2"></a><span class="fu">dminutes</span>(<span class="dv">10</span>)</span>
<span id="annotated-cell-55-3"><a href="#annotated-cell-55-3"></a><span class="fu">dhours</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>))</span>
<span id="annotated-cell-55-4"><a href="#annotated-cell-55-4"></a><span class="fu">ddays</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="annotated-cell-55-5"><a href="#annotated-cell-55-5"></a><span class="fu">dweeks</span>(<span class="dv">3</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-55" data-target-annotation="8">8</button><span id="annotated-cell-55-6" class="code-annotation-target"><a href="#annotated-cell-55-6"></a><span class="fu">dyears</span>(<span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-55" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-55" data-code-lines="6" data-code-annotation="8">Aggregating to larger time units is more problematic. A year uses the “average” number of days in a year, i.e.&nbsp;365.25. There’s no way to convert a month to a duration, because there’s just too much variation.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "15s"
&gt; [1] "600s (~10 minutes)"
&gt; [1] "43200s (~12 hours)" "86400s (~1 days)"  
&gt; [1] "0s"                "86400s (~1 days)"  "172800s (~2 days)"
&gt; [4] "259200s (~3 days)" "345600s (~4 days)" "432000s (~5 days)"
&gt; [1] "1814400s (~3 weeks)"
&gt; [1] "31557600s (~1 years)"</code></pre>
</div>
</div>
</div>
</section><section id="math-with-durations" class="slide level2"><h2>Math with Durations</h2>
<p>You can add and multiply durations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dyears</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "63115200s (~2 years)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a></a><span class="fu">dyears</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">dweeks</span>(<span class="dv">12</span>) <span class="sc">+</span> <span class="fu">dhours</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "38869200s (~1.23 years)"</code></pre>
</div>
</div>
<div class="fragment">
<p>Sometimes you’ll get an unexpected results though:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-58"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-58-1"><a href="#annotated-cell-58-1"></a>one_am <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2026-03-08 01:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>)</span>
<span id="annotated-cell-58-2"><a href="#annotated-cell-58-2"></a>one_am</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="9">9</button><span id="annotated-cell-58-3" class="code-annotation-target"><a href="#annotated-cell-58-3"></a>one_am <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-58" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-58" data-code-lines="3" data-code-annotation="9">Daylight Savings Time is a human construction so March 8th only has 23 hours because it’s when DST starts. If we add a full days worth of seconds we end up with a different time and a different time zone.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2026-03-08 01:00:00 EST"
&gt; [1] "2026-03-09 02:00:00 EDT"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>For this reason, <code>lubridate</code> also has <code>periods</code>.</p>
</div>
</section><section id="periods" class="slide level2"><h2>Periods</h2>
<p>Periods represent “human” times like days and months and therefore do not have a fixed length in seconds.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a></a>one_am</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2026-03-08 01:00:00 EST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a></a>one_am <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2026-03-09 01:00:00 EDT"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>Periods also have their own constructor functions:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a></a><span class="fu">hours</span>(<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "12H 0M 0S" "24H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a></a><span class="fu">days</span>(<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "7d 0H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a></a><span class="fu">months</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "1m 0d 0H 0M 0S" "2m 0d 0H 0M 0S" "3m 0d 0H 0M 0S" "4m 0d 0H 0M 0S"
&gt; [5] "5m 0d 0H 0M 0S" "6m 0d 0H 0M 0S"</code></pre>
</div>
</div>
</div>
</section><section id="math-with-periods" class="slide level2"><h2>Math with Periods</h2>
<p>We can add and multiply periods:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a></a><span class="dv">10</span> <span class="sc">*</span> (<span class="fu">months</span>(<span class="dv">6</span>) <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "60m 10d 0H 0M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a></a><span class="fu">days</span>(<span class="dv">50</span>) <span class="sc">+</span> <span class="fu">hours</span>(<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">minutes</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "50d 25H 2M 0S"</code></pre>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>And also add them to dates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-66"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-66-1"><a href="#annotated-cell-66-1"></a><span class="co"># A leap year</span></span>
<span id="annotated-cell-66-2"><a href="#annotated-cell-66-2"></a><span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">+</span> <span class="fu">dyears</span>(<span class="dv">1</span>)</span>
<span id="annotated-cell-66-3"><a href="#annotated-cell-66-3"></a><span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span>
<span id="annotated-cell-66-4"><a href="#annotated-cell-66-4"></a></span>
<span id="annotated-cell-66-5"><a href="#annotated-cell-66-5"></a><span class="co"># Daylight saving time</span></span>
<span id="annotated-cell-66-6"><a href="#annotated-cell-66-6"></a>one_am <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-66" data-target-annotation="10">10</button><span id="annotated-cell-66-7" class="code-annotation-target"><a href="#annotated-cell-66-7"></a>one_am <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-66" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-66" data-code-lines="7" data-code-annotation="10">Periods are more likely than durations to do what you expect.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2024-12-31 06:00:00 UTC"
&gt; [1] "2025-01-01"
&gt; [1] "2026-03-09 02:00:00 EDT"
&gt; [1] "2026-03-09 01:00:00 EDT"</code></pre>
</div>
</div>
</div>
</section><section id="intervals" class="slide level2"><h2>Intervals</h2>
<p>Intervals represent the length of a time span in human units. You can think of it as a duration with a starting point.</p>
<div class="fragment">
<p>Imagine we wanted to know how many days are in a year?</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-67"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-67" data-target-annotation="11">11</button><span id="annotated-cell-67-1" class="code-annotation-target"><a href="#annotated-cell-67-1"></a><span class="fu">years</span>(<span class="dv">1</span>) <span class="sc">/</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-67" data-target-annotation="12">12</button><span id="annotated-cell-67-2" class="code-annotation-target"><a href="#annotated-cell-67-2"></a><span class="fu">dyears</span>(<span class="dv">1</span>) <span class="sc">/</span> <span class="fu">ddays</span>(<span class="dv">365</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-67" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-67" data-code-lines="1" data-code-annotation="11">Since this value changed depending on the year in question, lubridate gives an estimate (or the average) for the number of days in <em>any</em> given year.</span>
</dd>
<dt data-target-cell="annotated-cell-67" data-target-annotation="12">12</dt>
<dd>
<span data-code-cell="annotated-cell-67" data-code-lines="2" data-code-annotation="12">A similar thing happens for durations.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 365.25
&gt; [1] 1.000685</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>To be more accurate we need to give the specific range of time in questions.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-68"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-68" data-target-annotation="13">13</button><span id="annotated-cell-68-1" class="code-annotation-target"><a href="#annotated-cell-68-1"></a>y2023 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2023-01-01"</span>) <span class="sc">%--%</span> <span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>)</span>
<span id="annotated-cell-68-2"><a href="#annotated-cell-68-2"></a>y2024 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2024-01-01"</span>) <span class="sc">%--%</span> <span class="fu">ymd</span>(<span class="st">"2025-01-01"</span>)</span>
<span id="annotated-cell-68-3"><a href="#annotated-cell-68-3"></a>y2023</span>
<span id="annotated-cell-68-4"><a href="#annotated-cell-68-4"></a>y2024</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-68" data-target-annotation="14">14</button><span id="annotated-cell-68-5" class="code-annotation-target"><a href="#annotated-cell-68-5"></a>y2023 <span class="sc">/</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="annotated-cell-68-6"><a href="#annotated-cell-68-6"></a>y2024 <span class="sc">/</span> <span class="fu">days</span>(<span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-68" data-target-annotation="13">13</dt>
<dd>
<span data-code-cell="annotated-cell-68" data-code-lines="1" data-code-annotation="13">You can create an interval by writing <code>start %--% end</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-68" data-target-annotation="14">14</dt>
<dd>
<span data-code-cell="annotated-cell-68" data-code-lines="5" data-code-annotation="14">Now when we do this math we get the exact number of “human” days within the span of dates we specified.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 2023-01-01 UTC--2024-01-01 UTC
&gt; [1] 2024-01-01 UTC--2025-01-01 UTC
&gt; [1] 365
&gt; [1] 366</code></pre>
</div>
</div>
</div>
</section><section id="time-zones" class="slide level2"><h2>Time zones</h2>
<p>Time zones are a very complicated topic because different places have different rules which can, or already have, change(d) over time! To really clarify things <code>R</code> uses the international standard IANA time zones which use a consistent naming scheme: <code>{area}/{location}</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-69"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-69" data-target-annotation="15">15</button><span id="annotated-cell-69-1" class="code-annotation-target"><a href="#annotated-cell-69-1"></a><span class="fu">Sys.timezone</span>()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-69" data-target-annotation="16">16</button><span id="annotated-cell-69-2" class="code-annotation-target"><a href="#annotated-cell-69-2"></a><span class="fu">OlsonNames</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-69" data-target-annotation="15">15</dt>
<dd>
<span data-code-cell="annotated-cell-69" data-code-lines="1" data-code-annotation="15">Use <code><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone()</a></code> to find out which timezone <code>R</code> thinks you’re in.</span>
</dd>
<dt data-target-cell="annotated-cell-69" data-target-annotation="16">16</dt>
<dd>
<span data-code-cell="annotated-cell-69" data-code-lines="2" data-code-annotation="16">See the complete list of all time zone names with <code><a href="https://rdrr.io/r/base/timezones.html">OlsonNames()</a></code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "America/Los_Angeles"
&gt;   [1] "Africa/Abidjan"                   "Africa/Accra"                    
&gt;   [3] "Africa/Addis_Ababa"               "Africa/Algiers"                  
&gt;   [5] "Africa/Asmara"                    "Africa/Asmera"                   
&gt;   [7] "Africa/Bamako"                    "Africa/Bangui"                   
&gt;   [9] "Africa/Banjul"                    "Africa/Bissau"                   
&gt;  [11] "Africa/Blantyre"                  "Africa/Brazzaville"              
&gt;  [13] "Africa/Bujumbura"                 "Africa/Cairo"                    
&gt;  [15] "Africa/Casablanca"                "Africa/Ceuta"                    
&gt;  [17] "Africa/Conakry"                   "Africa/Dakar"                    
&gt;  [19] "Africa/Dar_es_Salaam"             "Africa/Djibouti"                 
&gt;  [21] "Africa/Douala"                    "Africa/El_Aaiun"                 
&gt;  [23] "Africa/Freetown"                  "Africa/Gaborone"                 
&gt;  [25] "Africa/Harare"                    "Africa/Johannesburg"             
&gt;  [27] "Africa/Juba"                      "Africa/Kampala"                  
&gt;  [29] "Africa/Khartoum"                  "Africa/Kigali"                   
&gt;  [31] "Africa/Kinshasa"                  "Africa/Lagos"                    
&gt;  [33] "Africa/Libreville"                "Africa/Lome"                     
&gt;  [35] "Africa/Luanda"                    "Africa/Lubumbashi"               
&gt;  [37] "Africa/Lusaka"                    "Africa/Malabo"                   
&gt;  [39] "Africa/Maputo"                    "Africa/Maseru"                   
&gt;  [41] "Africa/Mbabane"                   "Africa/Mogadishu"                
&gt;  [43] "Africa/Monrovia"                  "Africa/Nairobi"                  
&gt;  [45] "Africa/Ndjamena"                  "Africa/Niamey"                   
&gt;  [47] "Africa/Nouakchott"                "Africa/Ouagadougou"              
&gt;  [49] "Africa/Porto-Novo"                "Africa/Sao_Tome"                 
&gt;  [51] "Africa/Timbuktu"                  "Africa/Tripoli"                  
&gt;  [53] "Africa/Tunis"                     "Africa/Windhoek"                 
&gt;  [55] "America/Adak"                     "America/Anchorage"               
&gt;  [57] "America/Anguilla"                 "America/Antigua"                 
&gt;  [59] "America/Araguaina"                "America/Argentina/Buenos_Aires"  
&gt;  [61] "America/Argentina/Catamarca"      "America/Argentina/ComodRivadavia"
&gt;  [63] "America/Argentina/Cordoba"        "America/Argentina/Jujuy"         
&gt;  [65] "America/Argentina/La_Rioja"       "America/Argentina/Mendoza"       
&gt;  [67] "America/Argentina/Rio_Gallegos"   "America/Argentina/Salta"         
&gt;  [69] "America/Argentina/San_Juan"       "America/Argentina/San_Luis"      
&gt;  [71] "America/Argentina/Tucuman"        "America/Argentina/Ushuaia"       
&gt;  [73] "America/Aruba"                    "America/Asuncion"                
&gt;  [75] "America/Atikokan"                 "America/Atka"                    
&gt;  [77] "America/Bahia"                    "America/Bahia_Banderas"          
&gt;  [79] "America/Barbados"                 "America/Belem"                   
&gt;  [81] "America/Belize"                   "America/Blanc-Sablon"            
&gt;  [83] "America/Boa_Vista"                "America/Bogota"                  
&gt;  [85] "America/Boise"                    "America/Buenos_Aires"            
&gt;  [87] "America/Cambridge_Bay"            "America/Campo_Grande"            
&gt;  [89] "America/Cancun"                   "America/Caracas"                 
&gt;  [91] "America/Catamarca"                "America/Cayenne"                 
&gt;  [93] "America/Cayman"                   "America/Chicago"                 
&gt;  [95] "America/Chihuahua"                "America/Ciudad_Juarez"           
&gt;  [97] "America/Coral_Harbour"            "America/Cordoba"                 
&gt;  [99] "America/Costa_Rica"               "America/Coyhaique"               
&gt; [101] "America/Creston"                  "America/Cuiaba"                  
&gt; [103] "America/Curacao"                  "America/Danmarkshavn"            
&gt; [105] "America/Dawson"                   "America/Dawson_Creek"            
&gt; [107] "America/Denver"                   "America/Detroit"                 
&gt; [109] "America/Dominica"                 "America/Edmonton"                
&gt; [111] "America/Eirunepe"                 "America/El_Salvador"             
&gt; [113] "America/Ensenada"                 "America/Fort_Nelson"             
&gt; [115] "America/Fort_Wayne"               "America/Fortaleza"               
&gt; [117] "America/Glace_Bay"                "America/Godthab"                 
&gt; [119] "America/Goose_Bay"                "America/Grand_Turk"              
&gt; [121] "America/Grenada"                  "America/Guadeloupe"              
&gt; [123] "America/Guatemala"                "America/Guayaquil"               
&gt; [125] "America/Guyana"                   "America/Halifax"                 
&gt; [127] "America/Havana"                   "America/Hermosillo"              
&gt; [129] "America/Indiana/Indianapolis"     "America/Indiana/Knox"            
&gt; [131] "America/Indiana/Marengo"          "America/Indiana/Petersburg"      
&gt; [133] "America/Indiana/Tell_City"        "America/Indiana/Vevay"           
&gt; [135] "America/Indiana/Vincennes"        "America/Indiana/Winamac"         
&gt; [137] "America/Indianapolis"             "America/Inuvik"                  
&gt; [139] "America/Iqaluit"                  "America/Jamaica"                 
&gt; [141] "America/Jujuy"                    "America/Juneau"                  
&gt; [143] "America/Kentucky/Louisville"      "America/Kentucky/Monticello"     
&gt; [145] "America/Knox_IN"                  "America/Kralendijk"              
&gt; [147] "America/La_Paz"                   "America/Lima"                    
&gt; [149] "America/Los_Angeles"              "America/Louisville"              
&gt; [151] "America/Lower_Princes"            "America/Maceio"                  
&gt; [153] "America/Managua"                  "America/Manaus"                  
&gt; [155] "America/Marigot"                  "America/Martinique"              
&gt; [157] "America/Matamoros"                "America/Mazatlan"                
&gt; [159] "America/Mendoza"                  "America/Menominee"               
&gt; [161] "America/Merida"                   "America/Metlakatla"              
&gt; [163] "America/Mexico_City"              "America/Miquelon"                
&gt; [165] "America/Moncton"                  "America/Monterrey"               
&gt; [167] "America/Montevideo"               "America/Montreal"                
&gt; [169] "America/Montserrat"               "America/Nassau"                  
&gt; [171] "America/New_York"                 "America/Nipigon"                 
&gt; [173] "America/Nome"                     "America/Noronha"                 
&gt; [175] "America/North_Dakota/Beulah"      "America/North_Dakota/Center"     
&gt; [177] "America/North_Dakota/New_Salem"   "America/Nuuk"                    
&gt; [179] "America/Ojinaga"                  "America/Panama"                  
&gt; [181] "America/Pangnirtung"              "America/Paramaribo"              
&gt; [183] "America/Phoenix"                  "America/Port_of_Spain"           
&gt; [185] "America/Port-au-Prince"           "America/Porto_Acre"              
&gt; [187] "America/Porto_Velho"              "America/Puerto_Rico"             
&gt; [189] "America/Punta_Arenas"             "America/Rainy_River"             
&gt; [191] "America/Rankin_Inlet"             "America/Recife"                  
&gt; [193] "America/Regina"                   "America/Resolute"                
&gt; [195] "America/Rio_Branco"               "America/Rosario"                 
&gt; [197] "America/Santa_Isabel"             "America/Santarem"                
&gt; [199] "America/Santiago"                 "America/Santo_Domingo"           
&gt; [201] "America/Sao_Paulo"                "America/Scoresbysund"            
&gt; [203] "America/Shiprock"                 "America/Sitka"                   
&gt; [205] "America/St_Barthelemy"            "America/St_Johns"                
&gt; [207] "America/St_Kitts"                 "America/St_Lucia"                
&gt; [209] "America/St_Thomas"                "America/St_Vincent"              
&gt; [211] "America/Swift_Current"            "America/Tegucigalpa"             
&gt; [213] "America/Thule"                    "America/Thunder_Bay"             
&gt; [215] "America/Tijuana"                  "America/Toronto"                 
&gt; [217] "America/Tortola"                  "America/Vancouver"               
&gt; [219] "America/Virgin"                   "America/Whitehorse"              
&gt; [221] "America/Winnipeg"                 "America/Yakutat"                 
&gt; [223] "America/Yellowknife"              "Antarctica/Casey"                
&gt; [225] "Antarctica/Davis"                 "Antarctica/DumontDUrville"       
&gt; [227] "Antarctica/Macquarie"             "Antarctica/Mawson"               
&gt; [229] "Antarctica/McMurdo"               "Antarctica/Palmer"               
&gt; [231] "Antarctica/Rothera"               "Antarctica/South_Pole"           
&gt; [233] "Antarctica/Syowa"                 "Antarctica/Troll"                
&gt; [235] "Antarctica/Vostok"                "Arctic/Longyearbyen"             
&gt; [237] "Asia/Aden"                        "Asia/Almaty"                     
&gt; [239] "Asia/Amman"                       "Asia/Anadyr"                     
&gt; [241] "Asia/Aqtau"                       "Asia/Aqtobe"                     
&gt; [243] "Asia/Ashgabat"                    "Asia/Ashkhabad"                  
&gt; [245] "Asia/Atyrau"                      "Asia/Baghdad"                    
&gt; [247] "Asia/Bahrain"                     "Asia/Baku"                       
&gt; [249] "Asia/Bangkok"                     "Asia/Barnaul"                    
&gt; [251] "Asia/Beirut"                      "Asia/Bishkek"                    
&gt; [253] "Asia/Brunei"                      "Asia/Calcutta"                   
&gt; [255] "Asia/Chita"                       "Asia/Choibalsan"                 
&gt; [257] "Asia/Chongqing"                   "Asia/Chungking"                  
&gt; [259] "Asia/Colombo"                     "Asia/Dacca"                      
&gt; [261] "Asia/Damascus"                    "Asia/Dhaka"                      
&gt; [263] "Asia/Dili"                        "Asia/Dubai"                      
&gt; [265] "Asia/Dushanbe"                    "Asia/Famagusta"                  
&gt; [267] "Asia/Gaza"                        "Asia/Harbin"                     
&gt; [269] "Asia/Hebron"                      "Asia/Ho_Chi_Minh"                
&gt; [271] "Asia/Hong_Kong"                   "Asia/Hovd"                       
&gt; [273] "Asia/Irkutsk"                     "Asia/Istanbul"                   
&gt; [275] "Asia/Jakarta"                     "Asia/Jayapura"                   
&gt; [277] "Asia/Jerusalem"                   "Asia/Kabul"                      
&gt; [279] "Asia/Kamchatka"                   "Asia/Karachi"                    
&gt; [281] "Asia/Kashgar"                     "Asia/Kathmandu"                  
&gt; [283] "Asia/Katmandu"                    "Asia/Khandyga"                   
&gt; [285] "Asia/Kolkata"                     "Asia/Krasnoyarsk"                
&gt; [287] "Asia/Kuala_Lumpur"                "Asia/Kuching"                    
&gt; [289] "Asia/Kuwait"                      "Asia/Macao"                      
&gt; [291] "Asia/Macau"                       "Asia/Magadan"                    
&gt; [293] "Asia/Makassar"                    "Asia/Manila"                     
&gt; [295] "Asia/Muscat"                      "Asia/Nicosia"                    
&gt; [297] "Asia/Novokuznetsk"                "Asia/Novosibirsk"                
&gt; [299] "Asia/Omsk"                        "Asia/Oral"                       
&gt; [301] "Asia/Phnom_Penh"                  "Asia/Pontianak"                  
&gt; [303] "Asia/Pyongyang"                   "Asia/Qatar"                      
&gt; [305] "Asia/Qostanay"                    "Asia/Qyzylorda"                  
&gt; [307] "Asia/Rangoon"                     "Asia/Riyadh"                     
&gt; [309] "Asia/Saigon"                      "Asia/Sakhalin"                   
&gt; [311] "Asia/Samarkand"                   "Asia/Seoul"                      
&gt; [313] "Asia/Shanghai"                    "Asia/Singapore"                  
&gt; [315] "Asia/Srednekolymsk"               "Asia/Taipei"                     
&gt; [317] "Asia/Tashkent"                    "Asia/Tbilisi"                    
&gt; [319] "Asia/Tehran"                      "Asia/Tel_Aviv"                   
&gt; [321] "Asia/Thimbu"                      "Asia/Thimphu"                    
&gt; [323] "Asia/Tokyo"                       "Asia/Tomsk"                      
&gt; [325] "Asia/Ujung_Pandang"               "Asia/Ulaanbaatar"                
&gt; [327] "Asia/Ulan_Bator"                  "Asia/Urumqi"                     
&gt; [329] "Asia/Ust-Nera"                    "Asia/Vientiane"                  
&gt; [331] "Asia/Vladivostok"                 "Asia/Yakutsk"                    
&gt; [333] "Asia/Yangon"                      "Asia/Yekaterinburg"              
&gt; [335] "Asia/Yerevan"                     "Atlantic/Azores"                 
&gt; [337] "Atlantic/Bermuda"                 "Atlantic/Canary"                 
&gt; [339] "Atlantic/Cape_Verde"              "Atlantic/Faeroe"                 
&gt; [341] "Atlantic/Faroe"                   "Atlantic/Jan_Mayen"              
&gt; [343] "Atlantic/Madeira"                 "Atlantic/Reykjavik"              
&gt; [345] "Atlantic/South_Georgia"           "Atlantic/St_Helena"              
&gt; [347] "Atlantic/Stanley"                 "Australia/ACT"                   
&gt; [349] "Australia/Adelaide"               "Australia/Brisbane"              
&gt; [351] "Australia/Broken_Hill"            "Australia/Canberra"              
&gt; [353] "Australia/Currie"                 "Australia/Darwin"                
&gt; [355] "Australia/Eucla"                  "Australia/Hobart"                
&gt; [357] "Australia/LHI"                    "Australia/Lindeman"              
&gt; [359] "Australia/Lord_Howe"              "Australia/Melbourne"             
&gt; [361] "Australia/North"                  "Australia/NSW"                   
&gt; [363] "Australia/Perth"                  "Australia/Queensland"            
&gt; [365] "Australia/South"                  "Australia/Sydney"                
&gt; [367] "Australia/Tasmania"               "Australia/Victoria"              
&gt; [369] "Australia/West"                   "Australia/Yancowinna"            
&gt; [371] "Brazil/Acre"                      "Brazil/DeNoronha"                
&gt; [373] "Brazil/East"                      "Brazil/West"                     
&gt; [375] "Canada/Atlantic"                  "Canada/Central"                  
&gt; [377] "Canada/Eastern"                   "Canada/Mountain"                 
&gt; [379] "Canada/Newfoundland"              "Canada/Pacific"                  
&gt; [381] "Canada/Saskatchewan"              "Canada/Yukon"                    
&gt; [383] "CET"                              "Chile/Continental"               
&gt; [385] "Chile/EasterIsland"               "CST6CDT"                         
&gt; [387] "Cuba"                             "EET"                             
&gt; [389] "Egypt"                            "Eire"                            
&gt; [391] "EST"                              "EST5EDT"                         
&gt; [393] "Etc/GMT"                          "Etc/GMT-0"                       
&gt; [395] "Etc/GMT-1"                        "Etc/GMT-10"                      
&gt; [397] "Etc/GMT-11"                       "Etc/GMT-12"                      
&gt; [399] "Etc/GMT-13"                       "Etc/GMT-14"                      
&gt; [401] "Etc/GMT-2"                        "Etc/GMT-3"                       
&gt; [403] "Etc/GMT-4"                        "Etc/GMT-5"                       
&gt; [405] "Etc/GMT-6"                        "Etc/GMT-7"                       
&gt; [407] "Etc/GMT-8"                        "Etc/GMT-9"                       
&gt; [409] "Etc/GMT+0"                        "Etc/GMT+1"                       
&gt; [411] "Etc/GMT+10"                       "Etc/GMT+11"                      
&gt; [413] "Etc/GMT+12"                       "Etc/GMT+2"                       
&gt; [415] "Etc/GMT+3"                        "Etc/GMT+4"                       
&gt; [417] "Etc/GMT+5"                        "Etc/GMT+6"                       
&gt; [419] "Etc/GMT+7"                        "Etc/GMT+8"                       
&gt; [421] "Etc/GMT+9"                        "Etc/GMT0"                        
&gt; [423] "Etc/Greenwich"                    "Etc/UCT"                         
&gt; [425] "Etc/Universal"                    "Etc/UTC"                         
&gt; [427] "Etc/Zulu"                         "Europe/Amsterdam"                
&gt; [429] "Europe/Andorra"                   "Europe/Astrakhan"                
&gt; [431] "Europe/Athens"                    "Europe/Belfast"                  
&gt; [433] "Europe/Belgrade"                  "Europe/Berlin"                   
&gt; [435] "Europe/Bratislava"                "Europe/Brussels"                 
&gt; [437] "Europe/Bucharest"                 "Europe/Budapest"                 
&gt; [439] "Europe/Busingen"                  "Europe/Chisinau"                 
&gt; [441] "Europe/Copenhagen"                "Europe/Dublin"                   
&gt; [443] "Europe/Gibraltar"                 "Europe/Guernsey"                 
&gt; [445] "Europe/Helsinki"                  "Europe/Isle_of_Man"              
&gt; [447] "Europe/Istanbul"                  "Europe/Jersey"                   
&gt; [449] "Europe/Kaliningrad"               "Europe/Kiev"                     
&gt; [451] "Europe/Kirov"                     "Europe/Kyiv"                     
&gt; [453] "Europe/Lisbon"                    "Europe/Ljubljana"                
&gt; [455] "Europe/London"                    "Europe/Luxembourg"               
&gt; [457] "Europe/Madrid"                    "Europe/Malta"                    
&gt; [459] "Europe/Mariehamn"                 "Europe/Minsk"                    
&gt; [461] "Europe/Monaco"                    "Europe/Moscow"                   
&gt; [463] "Europe/Nicosia"                   "Europe/Oslo"                     
&gt; [465] "Europe/Paris"                     "Europe/Podgorica"                
&gt; [467] "Europe/Prague"                    "Europe/Riga"                     
&gt; [469] "Europe/Rome"                      "Europe/Samara"                   
&gt; [471] "Europe/San_Marino"                "Europe/Sarajevo"                 
&gt; [473] "Europe/Saratov"                   "Europe/Simferopol"               
&gt; [475] "Europe/Skopje"                    "Europe/Sofia"                    
&gt; [477] "Europe/Stockholm"                 "Europe/Tallinn"                  
&gt; [479] "Europe/Tirane"                    "Europe/Tiraspol"                 
&gt; [481] "Europe/Ulyanovsk"                 "Europe/Uzhgorod"                 
&gt; [483] "Europe/Vaduz"                     "Europe/Vatican"                  
&gt; [485] "Europe/Vienna"                    "Europe/Vilnius"                  
&gt; [487] "Europe/Volgograd"                 "Europe/Warsaw"                   
&gt; [489] "Europe/Zagreb"                    "Europe/Zaporozhye"               
&gt; [491] "Europe/Zurich"                    "Factory"                         
&gt; [493] "GB"                               "GB-Eire"                         
&gt; [495] "GMT"                              "GMT-0"                           
&gt; [497] "GMT+0"                            "GMT0"                            
&gt; [499] "Greenwich"                        "Hongkong"                        
&gt; [501] "HST"                              "Iceland"                         
&gt; [503] "Indian/Antananarivo"              "Indian/Chagos"                   
&gt; [505] "Indian/Christmas"                 "Indian/Cocos"                    
&gt; [507] "Indian/Comoro"                    "Indian/Kerguelen"                
&gt; [509] "Indian/Mahe"                      "Indian/Maldives"                 
&gt; [511] "Indian/Mauritius"                 "Indian/Mayotte"                  
&gt; [513] "Indian/Reunion"                   "Iran"                            
&gt; [515] "Israel"                           "Jamaica"                         
&gt; [517] "Japan"                            "Kwajalein"                       
&gt; [519] "Libya"                            "MET"                             
&gt; [521] "Mexico/BajaNorte"                 "Mexico/BajaSur"                  
&gt; [523] "Mexico/General"                   "MST"                             
&gt; [525] "MST7MDT"                          "Navajo"                          
&gt; [527] "NZ"                               "NZ-CHAT"                         
&gt; [529] "Pacific/Apia"                     "Pacific/Auckland"                
&gt; [531] "Pacific/Bougainville"             "Pacific/Chatham"                 
&gt; [533] "Pacific/Chuuk"                    "Pacific/Easter"                  
&gt; [535] "Pacific/Efate"                    "Pacific/Enderbury"               
&gt; [537] "Pacific/Fakaofo"                  "Pacific/Fiji"                    
&gt; [539] "Pacific/Funafuti"                 "Pacific/Galapagos"               
&gt; [541] "Pacific/Gambier"                  "Pacific/Guadalcanal"             
&gt; [543] "Pacific/Guam"                     "Pacific/Honolulu"                
&gt; [545] "Pacific/Johnston"                 "Pacific/Kanton"                  
&gt; [547] "Pacific/Kiritimati"               "Pacific/Kosrae"                  
&gt; [549] "Pacific/Kwajalein"                "Pacific/Majuro"                  
&gt; [551] "Pacific/Marquesas"                "Pacific/Midway"                  
&gt; [553] "Pacific/Nauru"                    "Pacific/Niue"                    
&gt; [555] "Pacific/Norfolk"                  "Pacific/Noumea"                  
&gt; [557] "Pacific/Pago_Pago"                "Pacific/Palau"                   
&gt; [559] "Pacific/Pitcairn"                 "Pacific/Pohnpei"                 
&gt; [561] "Pacific/Ponape"                   "Pacific/Port_Moresby"            
&gt; [563] "Pacific/Rarotonga"                "Pacific/Saipan"                  
&gt; [565] "Pacific/Samoa"                    "Pacific/Tahiti"                  
&gt; [567] "Pacific/Tarawa"                   "Pacific/Tongatapu"               
&gt; [569] "Pacific/Truk"                     "Pacific/Wake"                    
&gt; [571] "Pacific/Wallis"                   "Pacific/Yap"                     
&gt; [573] "Poland"                           "Portugal"                        
&gt; [575] "PRC"                              "PST8PDT"                         
&gt; [577] "ROC"                              "ROK"                             
&gt; [579] "Singapore"                        "Turkey"                          
&gt; [581] "UCT"                              "Universal"                       
&gt; [583] "US/Alaska"                        "US/Aleutian"                     
&gt; [585] "US/Arizona"                       "US/Central"                      
&gt; [587] "US/East-Indiana"                  "US/Eastern"                      
&gt; [589] "US/Hawaii"                        "US/Indiana-Starke"               
&gt; [591] "US/Michigan"                      "US/Mountain"                     
&gt; [593] "US/Pacific"                       "US/Samoa"                        
&gt; [595] "UTC"                              "W-SU"                            
&gt; [597] "WET"                              "Zulu"                            
&gt; attr(,"Version")
&gt; [1] "2025b"</code></pre>
</div>
</div>
</div>
</section><section id="changing-time-zones" class="slide level2"><h2>Changing Time Zones</h2>
<p>There are two ways you may want to change the time zone:</p>
<div class="fragment">
<h4 id="keep-instant-in-time-change-display"><strong>Keep instant in time, change display</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-70"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-70-1"><a href="#annotated-cell-70-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-06-01 12:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/New_York"</span>)</span>
<span id="annotated-cell-70-2"><a href="#annotated-cell-70-2"></a>x</span>
<span id="annotated-cell-70-3"><a href="#annotated-cell-70-3"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-70" data-target-annotation="17">17</button><span id="annotated-cell-70-4" class="code-annotation-target"><a href="#annotated-cell-70-4"></a><span class="fu">with_tz</span>(x, <span class="at">tzone =</span> <span class="st">"Australia/Lord_Howe"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-70" data-target-annotation="17">17</dt>
<dd>
<span data-code-cell="annotated-cell-70" data-code-lines="4" data-code-annotation="17">The <code>+1030</code> offset is the difference relative to <code>UTC</code> (functionally similar to Greenwich Mean Time) which is <code>2024-06-01 16:00:00 UTC</code> in this example.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2024-06-01 12:00:00 EDT"
&gt; [1] "2024-06-02 02:30:00 +1030"</code></pre>
</div>
</div>
<p><br></p>
<h4 id="change-underlying-instant-in-time"><strong>Change underlying instant in time</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-71"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-71-1"><a href="#annotated-cell-71-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-06-01 9:00:00"</span>, <span class="at">tz =</span> <span class="st">"America/Los_Angeles"</span>)</span>
<span id="annotated-cell-71-2"><a href="#annotated-cell-71-2"></a>y</span>
<span id="annotated-cell-71-3"><a href="#annotated-cell-71-3"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-71" data-target-annotation="18">18</button><span id="annotated-cell-71-4" class="code-annotation-target"><a href="#annotated-cell-71-4"></a><span class="fu">force_tz</span>(y, <span class="at">tzone =</span> <span class="st">"Australia/Lord_Howe"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-71" data-target-annotation="18">18</dt>
<dd>
<span data-code-cell="annotated-cell-71" data-code-lines="4" data-code-annotation="18">In this case the time zone was labelled incorrectly so by forcing the correct time zone we changed the underlying instant in time.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2024-06-01 09:00:00 PDT"
&gt; [1] "2024-06-01 09:00:00 +1030"</code></pre>
</div>
</div>
</div>
</section><section id="default-time-zones" class="slide level2"><h2>Default Time Zones</h2>
<p>Time zones in <code>R</code> only control printing of date/time objects. Unless otherwise specified, lubridate always uses UTC<sup>1</sup>.</p>
<div class="fragment">
<p>Operations that combine date-times, like <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, will often drop the time zone. In that case, the date-times will display in the time zone of the first element:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-72"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-72-1"><a href="#annotated-cell-72-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-06-01 14:00:00"</span>, <span class="at">tz =</span> <span class="st">"Asia/Gaza"</span>) </span>
<span id="annotated-cell-72-2"><a href="#annotated-cell-72-2"></a>b <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-06-01 14:00:00"</span>, <span class="at">tz =</span> <span class="st">"Cuba"</span>) </span>
<span id="annotated-cell-72-3"><a href="#annotated-cell-72-3"></a>c <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-06-01 14:00:00"</span>, <span class="at">tz =</span> <span class="st">"Africa/Kinshasa"</span>) </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-72" data-target-annotation="19">19</button><span id="annotated-cell-72-4" class="code-annotation-target"><a href="#annotated-cell-72-4"></a>a</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-72" data-target-annotation="20">20</button><span id="annotated-cell-72-5" class="code-annotation-target"><a href="#annotated-cell-72-5"></a>b</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-72" data-target-annotation="21">21</button><span id="annotated-cell-72-6" class="code-annotation-target"><a href="#annotated-cell-72-6"></a>c</span>
<span id="annotated-cell-72-7"><a href="#annotated-cell-72-7"></a><span class="fu">c</span>(a, b, c)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-72" data-target-annotation="19">19</dt>
<dd>
<span data-code-cell="annotated-cell-72" data-code-lines="4" data-code-annotation="19">EEST = Eastern European Summer Time</span>
</dd>
<dt data-target-cell="annotated-cell-72" data-target-annotation="20">20</dt>
<dd>
<span data-code-cell="annotated-cell-72" data-code-lines="5" data-code-annotation="20">CDT = Central Daylight Time</span>
</dd>
<dt data-target-cell="annotated-cell-72" data-target-annotation="21">21</dt>
<dd>
<span data-code-cell="annotated-cell-72" data-code-lines="6" data-code-annotation="21">WAT = West Africa Time</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "2024-06-01 14:00:00 EEST"
&gt; [1] "2024-06-01 14:00:00 CDT"
&gt; [1] "2024-06-01 14:00:00 WAT"
&gt; [1] "2024-06-01 14:00:00 EEST" "2024-06-01 21:00:00 EEST"
&gt; [3] "2024-06-01 16:00:00 EEST"</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn30"><p>UTC (Coordinated Universal Time) is the standard time zone used by the scientific community and is roughly equivalent to GMT (Greenwich Mean Time). It does not have DST, which makes a convenient representation for computation.</p></li></ol></aside></section></section><section><section id="lab-3" class="title-slide slide level1 section-title center" data-background-color="#99a486"><h1>Lab</h1>

</section><section id="answers-1" class="slide level2" data-auto-animate="true"><h2 data-id="quarto-animate-title">Answers</h2>
<p>Pivot your data to make it tidy<sup>1</sup>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb145-1" class="hljs-ln-code"><a></a>religion_income_tidy <span class="ot">&lt;-</span> religion_income <span class="sc">|&gt;</span> </span>
<span id="cb145-2" class="hljs-ln-code"><a></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>religion, </span>
<span id="cb145-3" class="hljs-ln-code"><a></a>              <span class="at">names_to =</span> <span class="st">"income"</span>, </span>
<span id="cb145-4" class="hljs-ln-code"><a></a>              <span class="at">values_to =</span> <span class="st">"frequency"</span>)</span>
<span id="cb145-5" class="hljs-ln-code"><a></a>religion_income_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 180 × 3
&gt;    religion income             frequency
&gt;    &lt;fct&gt;    &lt;chr&gt;                  &lt;dbl&gt;
&gt;  1 Agnostic &lt;$10k                     27
&gt;  2 Agnostic $10-20k                   34
&gt;  3 Agnostic $20-30k                   60
&gt;  4 Agnostic $30-40k                   81
&gt;  5 Agnostic $40-50k                   76
&gt;  6 Agnostic $50-75k                  137
&gt;  7 Agnostic $75-100k                 122
&gt;  8 Agnostic $100-150k                109
&gt;  9 Agnostic &gt;150k                     84
&gt; 10 Agnostic Don't know/refused        96
&gt; # ℹ 170 more rows</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn32"><p>There should be 3 columns in your final dataset</p></li></ol></aside></section><section id="answers-2" class="slide level2" data-auto-animate="true"><h2 data-id="quarto-animate-title">Answers</h2>
<p>Turn two of the variables into factors<sup>1</sup>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb147-1" class="hljs-ln-code"><a></a>religion_income_tidy <span class="ot">&lt;-</span> religion_income <span class="sc">|&gt;</span> </span>
<span id="cb147-2" class="hljs-ln-code"><a></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>religion, </span>
<span id="cb147-3" class="hljs-ln-code"><a></a>              <span class="at">names_to =</span> <span class="st">"income"</span>, </span>
<span id="cb147-4" class="hljs-ln-code"><a></a>              <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb147-5" class="hljs-ln-code"><a></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">fct</span>(income, </span>
<span id="cb147-6" class="hljs-ln-code"><a></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Don't know/refused"</span>, <span class="st">"&lt;$10k"</span>, <span class="st">"$10-20k"</span>, </span>
<span id="cb147-7" class="hljs-ln-code"><a></a>                                         <span class="st">"$20-30k"</span>, <span class="st">"$30-40k"</span>, <span class="st">"$40-50k"</span>, <span class="st">"$50-75k"</span>, </span>
<span id="cb147-8" class="hljs-ln-code"><a></a>                                         <span class="st">"$75-100k"</span>, <span class="st">"$100-150k"</span>, <span class="st">"&gt;150k"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<aside><ol class="aside-footnotes"><li id="fn33"><p>Hint: Which two variables are categorical?</p></li></ol></aside></section><section id="answers-3" class="slide level2" data-auto-animate="true"><h2 data-id="quarto-animate-title">Answers</h2>
<p>Turn two of the variables into factors<sup>1</sup>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-76" data-code-line-numbers="|9"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="annotated-cell-76-1" class="hljs-ln-code"><a href="#annotated-cell-76-1"></a>religion_income_tidy <span class="ot">&lt;-</span> religion_income <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-76-2" class="hljs-ln-code"><a href="#annotated-cell-76-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>religion, </span>
<span id="annotated-cell-76-3" class="hljs-ln-code"><a href="#annotated-cell-76-3"></a>              <span class="at">names_to =</span> <span class="st">"income"</span>, </span>
<span id="annotated-cell-76-4" class="hljs-ln-code"><a href="#annotated-cell-76-4"></a>              <span class="at">values_to =</span> <span class="st">"frequency"</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-76-5" class="hljs-ln-code"><a href="#annotated-cell-76-5"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">fct</span>(income, </span>
<span id="annotated-cell-76-6" class="hljs-ln-code"><a href="#annotated-cell-76-6"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Don't know/refused"</span>, <span class="st">"&lt;$10k"</span>, <span class="st">"$10-20k"</span>, </span>
<span id="annotated-cell-76-7" class="hljs-ln-code"><a href="#annotated-cell-76-7"></a>                                         <span class="st">"$20-30k"</span>, <span class="st">"$30-40k"</span>, <span class="st">"$40-50k"</span>, <span class="st">"$50-75k"</span>, </span>
<span id="annotated-cell-76-8" class="hljs-ln-code"><a href="#annotated-cell-76-8"></a>                                         <span class="st">"$75-100k"</span>, <span class="st">"$100-150k"</span>, <span class="st">"&gt;150k"</span>)), </span>
<button class="code-annotation-anchor hljs-ln-code" data-target-cell="annotated-cell-76" data-target-annotation="2">2</button><span id="annotated-cell-76-9" class="code-annotation-target hljs-ln-code"><a href="#annotated-cell-76-9"></a>         <span class="at">religion =</span> <span class="fu">fct</span>(religion))</span><div class="code-annotation-gutter-bg hljs-ln-code"></div><div class="code-annotation-gutter hljs-ln-code"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-76" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-76" data-code-lines="9" data-code-annotation="2">If we hadn’t initially read in religion as a factor, we’d need to recode it as one during this step.</span>
</dd>
</dl>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn34"><p>Hint: Which two variables are categorical?</p></li></ol></aside></section><section id="answers-4" class="slide level2"><h2>Answers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a></a>religion_income_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 180 × 3
&gt;    religion income             frequency
&gt;    &lt;fct&gt;    &lt;fct&gt;                  &lt;dbl&gt;
&gt;  1 Agnostic &lt;$10k                     27
&gt;  2 Agnostic $10-20k                   34
&gt;  3 Agnostic $20-30k                   60
&gt;  4 Agnostic $30-40k                   81
&gt;  5 Agnostic $40-50k                   76
&gt;  6 Agnostic $50-75k                  137
&gt;  7 Agnostic $75-100k                 122
&gt;  8 Agnostic $100-150k                109
&gt;  9 Agnostic &gt;150k                     84
&gt; 10 Agnostic Don't know/refused        96
&gt; # ℹ 170 more rows</code></pre>
</div>
</div>
</section></section><section><section id="homework" class="title-slide slide level1 section-title center" data-background-color="#1e4655"><h1>Homework</h1>

</section><section id="section-4" class="slide level2" data-menu-title="Homework 5" data-background-iframe="https://vsass.github.io/CSSS508/Homework/HW5/homework5.html" data-background-interactive="TRUE"><h2></h2>


</section></section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="../../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'pointer': {"key":"q","color":"#b18eb1","pointerSize":16,"alwaysVisible":false},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // default icon
                link.classList.add("external");
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>


</body></html>