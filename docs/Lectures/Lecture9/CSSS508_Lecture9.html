<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>csss508_lecture9</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #97947a;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #97947a;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2b2b2b; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #dcc6e0; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #ffd700; } /* Attribute */
    code span.bn { color: #dcc6e0; } /* BaseN */
    code span.bu { color: #f5ab35; } /* BuiltIn */
    code span.cf { color: #ffa07a; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffa07a; } /* Constant */
    code span.co { color: #d4d0ab; } /* Comment */
    code span.cv { color: #d4d0ab; font-style: italic; } /* CommentVar */
    code span.do { color: #d4d0ab; font-style: italic; } /* Documentation */
    code span.dt { color: #dcc6e0; } /* DataType */
    code span.dv { color: #dcc6e0; } /* DecVal */
    code span.er { color: #dcc6e0; } /* Error */
    code span.ex { color: #ffd700; } /* Extension */
    code span.fl { color: #f5ab35; } /* Float */
    code span.fu { color: #ffd700; } /* Function */
    code span.im { color: #f8f8f2; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; } /* Keyword */
    code span.op { color: #00e0e0; } /* Operator */
    code span.ot { color: #ffa07a; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.sc { color: #00e0e0; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #f5ab35; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #d4d0ab; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="title-slide" class="slide level2 center" data-menu-title="Iteration" data-background="#1e4655" data-background-image="../../images/csss-logo.png" data-background-position="center top 5%" data-background-size="50%">
<h2></h2>
<p><span class="custom-title">Iteration</span></p>
<p><span class="custom-subtitle">CS&amp;SS 508 • Lecture 9</span></p>
<p><span class="custom-subtitle2">28 November 2023</span></p>
<p><span class="custom-subtitle3">Victoria Sass</span></p>
</section>
<section>
<section id="roadmap" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Roadmap</h1>

</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<h3 id="last-time-we-learned">Last time, we learned:</h3>
<ul>
<li>Function Basics</li>
<li>Types of Functions
<ul>
<li>Vector Functions</li>
<li>Dataframe Functions</li>
<li>Plot Functions</li>
</ul></li>
<li>Function Style Guide</li>
</ul>
</div><div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<!-- -->
<h3 id="today-we-will-cover">Today, we will cover:</h3>
<ul>
<li>Introduction to Iteration</li>
<li>Common Iteration Tasks
<ul>
<li>Modifying Multiple Columns</li>
<li>Reading in Multiple Files</li>
<li>Saving Multiple Outputs</li>
</ul></li>
<li>Base <code>R</code> Equivalents
<ul>
<li>Apply Family</li>
<li><code>for</code> loops</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="introduction-to-iteration" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Introduction to Iteration</h1>

</section>
<section id="bad-repetition" class="slide level2">
<h2>Bad Repetition</h2>
<p>If someone doesn’t know better, they might find the means of variables in the <code>swiss</code> data by typing a line of code for each column:</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mean1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swiss<span class="sc">$</span>Fertility)</span>
<span id="cb1-2"><a href="#cb1-2"></a>mean2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swiss<span class="sc">$</span>Agriculture)</span>
<span id="cb1-3"><a href="#cb1-3"></a>mean3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swissExamination)</span>
<span id="cb1-4"><a href="#cb1-4"></a>mean4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swiss<span class="sc">$</span>Fertility)</span>
<span id="cb1-5"><a href="#cb1-5"></a>mean5 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swiss<span class="sc">$</span>Catholic)</span>
<span id="cb1-6"><a href="#cb1-6"></a>mean5 <span class="ot">&lt;-</span> <span class="fu">mean</span>(swiss<span class="sc">$</span>Infant.Mortality)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">c</span>(mean1, mean2 mean3, mean4, mean5, man6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-error">
<pre><code>&gt; Error: &lt;text&gt;:7:16: unexpected symbol
&gt; 6: mean5 &lt;- mean(swiss$Infant.Mortality)
&gt; 7: c(mean1, mean2 mean3
&gt;                   ^</code></pre>
</div>
</div>
<p><br></p>
<p>Can you spot the problems?</p>
<div class="fragment">
<p><br></p>
<p>How upset would they be if the <code>swiss</code> data had 200 columns instead of 6?</p>
</div>
</section>
<section id="good-repetition" class="slide level2">
<h2>Good Repetition</h2>
<p>Today you’ll learn a better way to repeat tasks, <em>without repeating code</em>, using functions from the <code>dplyr</code> and <code>purrr</code> packages in the <code>tidyverse</code>.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>swiss <span class="sc">|&gt;</span> <span class="fu">summarize</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">across</span>(Fertility<span class="sc">:</span>Infant.Mortality, mean)</span>
<span id="cb3-3"><a href="#cb3-3"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Fertility Agriculture Examination Education Catholic Infant.Mortality
&gt; 1     70.14       50.66       16.49     10.98    41.14            19.94</code></pre>
</div>
</div>

<aside><div>
<p>Don’t worry about the details yet!</p>
</div></aside></section>
<section id="goal-dont-repeat-yourself-dry" class="slide level2">
<h2>Goal: Don’t Repeat Yourself (DRY)!</h2>
<p>The <strong>DRY</strong> idea: Computers are much better at doing the same thing over and over again than we are.</p>
<div>
<ul>
<li class="fragment">Writing code to repeat tasks for us reduces the most common human coding mistakes.</li>
<li class="fragment">It also <em>substantially</em> reduces the time and effort involved in processing large volumes of data.</li>
<li class="fragment">Lastly, compact code is more readable and easier to troubleshoot.</li>
</ul>
</div>
</section>
<section id="method-iteration" class="slide level2">
<h2>Method: Iteration!</h2>
<p>Iteration involves repeatedly performing the same action on different objects.</p>
<div class="fragment">
<p><br></p>
<p>We’ve already done some iteration, both because it’s built into <code>R</code> in certain ways, and because many of the tidyverse packages we’ve used have functions that are iterative.</p>
</div>
<div class="fragment">
<p><br></p>
<h4 id="some-examples-weve-seen">Some examples we’ve seen:</h4>
<div>
<ul>
<li class="fragment">Multiplying a vector x by any integer
<ul>
<li class="fragment"><em>Other languages require explicit looping but <code>R</code> iterates automatically with its recycling rules</em></li>
</ul></li>
<li class="fragment">Facetting ggplots</li>
<li class="fragment">Summarizing a grouped dataset</li>
</ul>
</div>
<p><br></p>
<div class="fragment">
<p>We’re now going to learn what makes <code>R</code> a functional programming language. That is, we’ll learn some functions that themselves take functions as arguments.</p>
</div>
</div>
</section></section>
<section>
<section id="modifying-multiple-columns" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Modifying Multiple Columns</h1>

</section>
<section id="simple-motivating-examplecontinued" class="slide level2">
<h2>Simple, Motivating Example…Continued</h2>
<p>Let’s return to our first example from last week:</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Without our function</a></li><li><a href="#tabset-1-2">With our function</a></li><li><a href="#tabset-1-3">With <code>across()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="fragment" data-fragment-index="1">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="at">a =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="at">b =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>),</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>),</span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>  )</span>
<span id="cb5-7"><a href="#cb5-7"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 4
&gt;        a       b      c      d
&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 -0.130 -0.398   0.347  0.368
&gt; 2 -1.14   1.04   -0.433 -1.07 
&gt; 3 -2.18  -1.06   -0.278 -1.10 
&gt; 4  0.765 -0.0376  0.674 -0.185
&gt; 5 -0.474  1.27    1.25   1.36</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="fragment" data-fragment-index="2">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="at">a =</span> (a <span class="sc">-</span> <span class="fu">min</span>(a, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(a, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(a, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="at">b =</span> (b <span class="sc">-</span> <span class="fu">min</span>(b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(a, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="at">c =</span> (c <span class="sc">-</span> <span class="fu">min</span>(c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="at">d =</span> (d <span class="sc">-</span> <span class="fu">min</span>(d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(d, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-6"><a href="#cb7-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="fragment" data-fragment-index="3">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>rescale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { </span>
<span id="cb8-2"><a href="#cb8-2"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-3"><a href="#cb8-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><br></p>
<div class="fragment" data-fragment-index="4">
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">a =</span> <span class="fu">rescale01</span>(a),</span>
<span id="cb9-2"><a href="#cb9-2"></a>             <span class="at">b =</span> <span class="fu">rescale01</span>(b),</span>
<span id="cb9-3"><a href="#cb9-3"></a>             <span class="at">c =</span> <span class="fu">rescale01</span>(c),</span>
<span id="cb9-4"><a href="#cb9-4"></a>             <span class="at">d =</span> <span class="fu">rescale01</span>(d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 4
&gt;       a     b      c      d
&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 0.696 0.284 0.462  0.597 
&gt; 2 0.354 0.902 0      0.0147
&gt; 3 0     0     0.0918 0     
&gt; 4 1     0.439 0.656  0.372 
&gt; 5 0.580 1     1      1</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="fragment" data-fragment-index="5">
<p>Can we make this mutate call <em>even</em> more efficient?</p>
</div>
</div>
<div id="tabset-1-3">
<div class="fragment" data-fragment-index="6">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(a<span class="sc">:</span>d, rescale01))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 4
&gt;       a     b      c      d
&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 0.696 0.284 0.462  0.597 
&gt; 2 0.354 0.902 0      0.0147
&gt; 3 0     0     0.0918 0     
&gt; 4 1     0.439 0.656  0.372 
&gt; 5 0.580 1     1      1</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="basics-of-across" class="slide level2">
<h2>Basics of <code>across()</code></h2>
<p><code>across()</code> makes it easy to apply the same transformation to multiple columns.</p>
<div class="fragment">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">across</span>(.cols, .fns, <span class="at">.names =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>There are three particularly important arguments, the first two of which you’ll use in every call to <code>across()</code>.</p>
<div>
<ul>
<li class="fragment"><code>.cols</code> specifies which columns to iterate over.</li>
<li class="fragment"><code>.fns</code> specifies what to do with each column.</li>
<li class="fragment"><code>.names</code> specifies the names of the output columns.</li>
</ul>
</div>
</div>
</section>
<section id="reading-in-columns-with-.cols" class="slide level2">
<h2>Reading in columns with <code>.cols</code></h2>
<p><code>.cols</code> uses the same specifications as <code>select()</code> so you can use <code>tidyselect</code> functions like <code>starts_with()</code> to select columns based on their name.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>), median))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Sepal.Length Sepal.Width
&gt; 1          5.8           3</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>You can also use <code>everything()</code> which selects every (non-grouping) column.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), median), </span>
<span id="cb16-3"><a href="#cb16-3"></a>            <span class="at">.by =</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     setosa          5.0         3.4         1.50         0.2
&gt; 2 versicolor          5.9         2.8         4.35         1.3
&gt; 3  virginica          6.5         3.0         5.55         2.0</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Lastly, <code>where()</code> allows you to select columns based on their type.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1"></a>iris <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), median))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-cell="annotated-cell-6" data-code-lines="2">Just like other selectors, you can combine these with Boolean algebra. For example, <code>!where(is.numeric)</code> selects all non-numeric columns.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1          5.8           3         4.35         1.3</code></pre>
</div>
</div>
</div>
</section>
<section id="calling-a-single-function" class="slide level2">
<h2>Calling a single function</h2>
<p>The second argument to <code>across()</code> is what makes <code>R</code> a functional programming language. Here we’re passing a function to another function.</p>
<div class="fragment">
<p><br></p>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:red"><i class="fa-solid fa-circle-exclamation" aria-label="circle-exclamation"></i></span> Important Distinction</strong></p>
</div>
<div class="callout-content">
<p>We’re passing this function to <code>across()</code>, so <code>across()</code> can call it; we’re not calling it ourselves. That means the function name should never be followed by <code>()</code>. If you forget, you’ll get an error:</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1"></a>airquality <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Ozone<span class="sc">:</span>Temp, <span class="fu">median</span>()))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-cell="annotated-cell-7" data-code-lines="2">This error arises because you’re calling the function with no input, <code>i.e. median()</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-error">
<pre><code>&gt; Error in `summarise()`:
&gt; ℹ In argument: `across(Ozone:Temp, median())`.
&gt; Caused by error in `median.default()`:
&gt; ! argument "x" is missing, with no default</code></pre>
</div>
</div>
</div>
</section>
<section id="anonymous-functions" class="slide level2">
<h2>Anonymous Functions</h2>
<p>If the function you pass to <code>across()</code> has its own arguments that you want to specify, you’ll need to use an anonymous function:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1"></a>airquality <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3">3</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Ozone<span class="sc">:</span>Temp, \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-cell="annotated-cell-8" data-code-lines="2">So-called anonymous, because we never explicitly gave it a name with <code>&lt;-</code>. Another term programmers use for this is “lambda function”.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Ozone Solar.R Wind Temp
&gt; 1  31.5     205  9.7   79</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>You might also see older code that looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1"></a>airquality <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="4">4</button><span id="annotated-cell-9-2" class="code-annotation-target"><a href="#annotated-cell-9-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Ozone<span class="sc">:</span>Temp, <span class="sc">~</span> <span class="fu">median</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-cell="annotated-cell-9" data-code-lines="2">This is another way to write anonymous functions but it only works inside tidyverse functions and always uses the variable name <code>.x</code>. Base syntax is now recommended (i.e.&nbsp;<code>\(x) x + 1</code>).</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Ozone Solar.R Wind Temp
&gt; 1  31.5     205  9.7   79</code></pre>
</div>
</div>
</div>
</section>
<section id="calling-multiple-functions" class="slide level2">
<h2>Calling multiple functions</h2>
<p>What if we want to know how many missing values we removed, in addition to calculating the median without those values?</p>
<div class="fragment">
<p>If you need to call multiple functions within <code>across()</code>, you’ll need to turn them into a named list.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1"></a>airquality <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Ozone<span class="sc">:</span>Temp, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="5">5</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3"></a>                   <span class="fu">list</span>(<span class="at">median =</span> \(x) <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4"></a>                        <span class="at">n_miss =</span> \(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-cell="annotated-cell-10" data-code-lines="3,4">The names of the list are used to name the new variables. In fact, the columns are named using a glue specification <code>{.col}_{.fn}</code> where <code>.col</code> is the name of the original column and <code>.fn</code> is the name of the function.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   Ozone_median Ozone_n_miss Solar.R_median Solar.R_n_miss Wind_median
&gt; 1         31.5           37            205              7         9.7
&gt;   Wind_n_miss Temp_median Temp_n_miss
&gt; 1           0          79           0</code></pre>
</div>
</div>
</div>
</section>
<section id="column-names" class="slide level2">
<h2>Column Names</h2>
<p>By default, the output of <code>across()</code> is given the same names as the inputs. This means that <code>across()</code> inside of mutate() will replace existing columns.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(a<span class="sc">:</span>d, rescale01))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 4
&gt;       a     b      c      d
&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 0.696 0.284 0.462  0.597 
&gt; 2 0.354 0.902 0      0.0147
&gt; 3 0     0     0.0918 0     
&gt; 4 1     0.439 0.656  0.372 
&gt; 5 0.580 1     1      1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>If you’d like to instead create new columns, you can use the <code>.names</code> argument to give the output new names.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="6">6</button><span id="annotated-cell-12-1" class="code-annotation-target"><a href="#annotated-cell-12-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(a<span class="sc">:</span>d, rescale01, <span class="at">.names =</span> <span class="st">"{.col}_rescaled"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="6">6</dt>
<dd>
<span data-code-annotation="6" data-code-cell="annotated-cell-12" data-code-lines="1"><code>.col</code> simply represents the original variable name.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 8
&gt;        a       b      c      d a_rescaled b_rescaled c_rescaled d_rescaled
&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
&gt; 1 -0.130 -0.398   0.347  0.368      0.696      0.284     0.462      0.597 
&gt; 2 -1.14   1.04   -0.433 -1.07       0.354      0.902     0          0.0147
&gt; 3 -2.18  -1.06   -0.278 -1.10       0          0         0.0918     0     
&gt; 4  0.765 -0.0376  0.674 -0.185      1          0.439     0.656      0.372 
&gt; 5 -0.474  1.27    1.25   1.36       0.580      1         1          1</code></pre>
</div>
</div>
</div>
</section>
<section id="if_any-and-if_all" class="slide level2">
<h2><code>if_any()</code> and <code>if_all()</code></h2>
<p><code>across()</code> works well with <code>mutate()</code> and <code>summarize()</code> but it has two variants that work with <code>filter()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="7">7</button><span id="annotated-cell-13-1" class="code-annotation-target"><a href="#annotated-cell-13-1"></a>airquality <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">if_any</span>(Ozone<span class="sc">:</span>Temp, is.na))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="7">7</dt>
<dd>
<span data-code-annotation="7" data-code-cell="annotated-cell-13" data-code-lines="1">This is the same as <code>airquality |&gt; filter(is.na(Ozone) | is.na(Solar.R) | is.na(Wind) | is.na(Temp))</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;    Ozone Solar.R Wind Temp Month Day
&gt; 1     NA      NA 14.3   56     5   5
&gt; 2     28      NA 14.9   66     5   6
&gt; 3     NA     194  8.6   69     5  10
&gt; 4      7      NA  6.9   74     5  11
&gt; 5     NA      66 16.6   57     5  25
&gt; 6     NA     266 14.9   58     5  26
&gt; 7     NA      NA  8.0   57     5  27
&gt; 8     NA     286  8.6   78     6   1
&gt; 9     NA     287  9.7   74     6   2
&gt; 10    NA     242 16.1   67     6   3
&gt; 11    NA     186  9.2   84     6   4
&gt; 12    NA     220  8.6   85     6   5
&gt; 13    NA     264 14.3   79     6   6
&gt; 14    NA     273  6.9   87     6   8
&gt; 15    NA     259 10.9   93     6  11
&gt; 16    NA     250  9.2   92     6  12
&gt; 17    NA     332 13.8   80     6  14
&gt; 18    NA     322 11.5   79     6  15
&gt; 19    NA     150  6.3   77     6  21
&gt; 20    NA      59  1.7   76     6  22
&gt; 21    NA      91  4.6   76     6  23
&gt; 22    NA     250  6.3   76     6  24
&gt; 23    NA     135  8.0   75     6  25
&gt; 24    NA     127  8.0   78     6  26
&gt; 25    NA      47 10.3   73     6  27
&gt; 26    NA      98 11.5   80     6  28
&gt; 27    NA      31 14.9   77     6  29
&gt; 28    NA     138  8.0   83     6  30
&gt; 29    NA     101 10.9   84     7   4
&gt; 30    NA     139  8.6   82     7  11
&gt; 31    NA     291 14.9   91     7  14
&gt; 32    NA     258  9.7   81     7  22
&gt; 33    NA     295 11.5   82     7  23
&gt; 34    78      NA  6.9   86     8   4
&gt; 35    35      NA  7.4   85     8   5
&gt; 36    66      NA  4.6   87     8   6
&gt; 37    NA     222  8.6   92     8  10
&gt; 38    NA     137 11.5   86     8  11
&gt; 39    NA      64 11.5   79     8  15
&gt; 40    NA     255 12.6   75     8  23
&gt; 41    NA     153  5.7   88     8  27
&gt; 42    NA     145 13.2   77     9  27</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="8">8</button><span id="annotated-cell-14-1" class="code-annotation-target"><a href="#annotated-cell-14-1"></a>airquality <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">if_all</span>(Ozone<span class="sc">:</span>Temp, is.na))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="8">8</dt>
<dd>
<span data-code-annotation="8" data-code-cell="annotated-cell-14" data-code-lines="1">This is the same as <code>airquality |&gt; filter(is.na(Ozone) &amp; is.na(Solar.R) &amp; is.na(Wind) &amp; is.na(Temp))</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] Ozone   Solar.R Wind    Temp    Month   Day    
&gt; &lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</div>
</section>
<section id="across-in-functions" class="slide level2">
<h2><code>across()</code> in Functions</h2>
<p>Naturally, <code>across()</code> lends itself to functions because it allows you to operate on multiple columns simultaneously.</p>
<div class="fragment">
<p>Just remember to embrace with <code>{{ }}</code> when using an argument for column selection since the first argument of <code>across()</code> uses the tidy evaluation method tidy-select.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>summarize_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">summary_vars =</span> <span class="fu">where</span>(is.numeric)) {</span>
<span id="cb28-2"><a href="#cb28-2"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="fu">summarize</span>(</span>
<span id="cb28-4"><a href="#cb28-4"></a>      <span class="fu">across</span>({{ summary_vars }}, \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb28-5"><a href="#cb28-5"></a>      <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb28-6"><a href="#cb28-6"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>    )</span>
<span id="cb28-8"><a href="#cb28-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:45%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">group_by</span>(cut) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">summarize_means</span>(<span class="fu">c</span>(carat, x<span class="sc">:</span>z))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 6
&gt;   cut       carat     x     y     z     n
&gt;   &lt;ord&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
&gt; 1 Fair      1.05   6.25  6.18  3.98  1610
&gt; 2 Good      0.849  5.84  5.85  3.64  4906
&gt; 3 Very Good 0.806  5.74  5.77  3.56 12082
&gt; 4 Premium   0.892  5.97  5.94  3.65 13791
&gt; 5 Ideal     0.703  5.51  5.52  3.40 21551</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section id="section" class="title-slide slide level1 section-title center" data-menu-title="`purrr``" data-background-image="images/purrr.png" data-background-size="contain" data-background-position="center" data-background-color="#1e4655">
<h1></h1>

</section>

<section>
<section id="reading-in-multiple-files" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Reading in Multiple Files</h1>

</section>
<section id="bad-repetition-redux" class="slide level2">
<h2>Bad repetition redux</h2>
<p>Imagine you have a directory full of excel spreadsheets you want to read into <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>data2019 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/y2019.xlsx"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>data2020 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/y2020.xlsx"</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>data2021 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/y2021.xlsx"</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>data2022 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/y2022.xlsx"</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data2019, data2020, data2021, data2022)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You could <em>technically</em> do it with copy and paste but we know that that’s probably not the most efficient, least error-prone approach.</p>
<div class="fragment">
<p>Not to mention how inconvenient this would be if you had hundreds of files to read in and combine.</p>
</div>
<div class="fragment">
<p>The <strong>iterative approach</strong> involves three broad steps:</p>
<div>
<ul>
<li class="fragment">use <code>list.files()</code> to list all the files in a directory</li>
<li class="fragment">use <code>purrr::map()</code> to read each of them into a list</li>
<li class="fragment">use <code>purrr::list_rbind()</code> to combine them into a single data frame</li>
</ul>
</div>
</div>
</section>
<section id="step-1-listing-files-in-a-directory" class="slide level2">
<h2>Step 1: Listing Files in a Directory</h2>
<p>The first part of this method involves creating a character vector of all the file paths for the files you want to read in. We’ll motivate this example by reading in the gapminder data that’s saved in separate excel sheets by year in my working directory.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1">1</button><span id="annotated-cell-17-1" class="code-annotation-target"><a href="#annotated-cell-17-1"></a>paths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"data/gapminder"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="2">2</button><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2"></a>                    <span class="at">pattern =</span> <span class="st">"[.]xlsx$"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="3">3</button><span id="annotated-cell-17-3" class="code-annotation-target"><a href="#annotated-cell-17-3"></a>                    <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-17-4"><a href="#annotated-cell-17-4"></a>paths</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-cell="annotated-cell-17" data-code-lines="1">The first argument, <code>path</code>, is the directory to look within.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-cell="annotated-cell-17" data-code-lines="2"><code>pattern</code> is a regular expression used to filter the file names. The most common pattern is something like <code>[.]xlsx$</code> or <code>[.]csv$</code> to find all files with a specified extension.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-cell="annotated-cell-17" data-code-lines="3"><code>full.names</code> determines whether or not the directory name should be included in the output. You almost always want this to be <code>TRUE.</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "data/gapminder/1952.xlsx" "data/gapminder/1957.xlsx"
&gt;  [3] "data/gapminder/1962.xlsx" "data/gapminder/1967.xlsx"
&gt;  [5] "data/gapminder/1972.xlsx" "data/gapminder/1977.xlsx"
&gt;  [7] "data/gapminder/1982.xlsx" "data/gapminder/1987.xlsx"
&gt;  [9] "data/gapminder/1992.xlsx" "data/gapminder/1997.xlsx"
&gt; [11] "data/gapminder/2002.xlsx" "data/gapminder/2007.xlsx"</code></pre>
</div>
</div>
</section>
<section id="reading-files-into-a-list" class="slide level2">
<h2>Reading Files into a List</h2>
<p>Now we want to read these excel sheets into a single object so we can use iteration in the next step! A list is the perfect tool for this.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-2"><a href="#cb33-2"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1952.xlsx"</span>),</span>
<span id="cb33-3"><a href="#cb33-3"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1957.xlsx"</span>),</span>
<span id="cb33-4"><a href="#cb33-4"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1962.xlsx"</span>),</span>
<span id="cb33-5"><a href="#cb33-5"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1967.xlsx"</span>),</span>
<span id="cb33-6"><a href="#cb33-6"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1972.xlsx"</span>),</span>
<span id="cb33-7"><a href="#cb33-7"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1977.xlsx"</span>),</span>
<span id="cb33-8"><a href="#cb33-8"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1982.xlsx"</span>),</span>
<span id="cb33-9"><a href="#cb33-9"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1987.xlsx"</span>),</span>
<span id="cb33-10"><a href="#cb33-10"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1992.xlsx"</span>),</span>
<span id="cb33-11"><a href="#cb33-11"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/1997.xlsx"</span>),</span>
<span id="cb33-12"><a href="#cb33-12"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/2002.xlsx"</span>),</span>
<span id="cb33-13"><a href="#cb33-13"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/gapminder/2007.xlsx"</span>)</span>
<span id="cb33-14"><a href="#cb33-14"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Unfortunately, this is just as tedious a method as reading in all the separate file paths and creating individual data frame objects!</p>
</div>
</section>
<section id="step-2-using-map-instead" class="slide level2">
<h2>Step 2: Using <code>map()</code> instead!</h2>
<p>Instead of listing out all the <code>read_excel()</code> calls in our list, we can used the <code>map()</code> function from the tidyverse’s <code>purrr</code> package. <code>map()</code> is similar to <code>across()</code>, but instead of doing something to each column in a data frame, it does something to each element of a vector.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>files <span class="ot">&lt;-</span> <span class="fu">map</span>(paths, readxl<span class="sc">::</span>read_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Now, what does <code>files</code> contain?</p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>files[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:70%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         28.8  8425333      779.
&gt;  2 Albania     Europe       55.2  1282697     1601.
&gt;  3 Algeria     Africa       43.1  9279525     2449.
&gt;  4 Angola      Africa       30.0  4232095     3521.
&gt;  5 Argentina   Americas     62.5 17876956     5911.
&gt;  6 Australia   Oceania      69.1  8691212    10040.
&gt;  7 Austria     Europe       66.8  6927772     6137.
&gt;  8 Bahrain     Asia         50.9   120447     9867.
&gt;  9 Bangladesh  Asia         37.5 46886859      684.
&gt; 10 Belgium     Europe       68    8730405     8343.
&gt; # ℹ 132 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-combine-dataframes-into-one" class="slide level2">
<h2>Step 3: Combine Dataframes into One</h2>
<p>Now that we have all our individual dataframes in an element of a list, we can use <code>list_rbind</code> to combine them into one dataframe.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">list_rbind</span>(files)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 1,704 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         28.8  8425333      779.
&gt;  2 Albania     Europe       55.2  1282697     1601.
&gt;  3 Algeria     Africa       43.1  9279525     2449.
&gt;  4 Angola      Africa       30.0  4232095     3521.
&gt;  5 Argentina   Americas     62.5 17876956     5911.
&gt;  6 Australia   Oceania      69.1  8691212    10040.
&gt;  7 Austria     Europe       66.8  6927772     6137.
&gt;  8 Bahrain     Asia         50.9   120447     9867.
&gt;  9 Bangladesh  Asia         37.5 46886859      684.
&gt; 10 Belgium     Europe       68    8730405     8343.
&gt; # ℹ 1,694 more rows</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>The super efficient, full code for the last two steps would therefore be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>paths <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">map</span>(readxl<span class="sc">::</span>read_excel) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="data-in-the-filepath" class="slide level2">
<h2>Data in the Filepath</h2>
<p>You may have noticed that we’re missing a year indicator in our final dataset. That’s because that information is actually a part of the filename itself.</p>
<div class="fragment">
<p>There’s a way to include the filename in the data but we have to add another step to our <code>paths</code> pipeline:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-22"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-22-1"><a href="#annotated-cell-22-1"></a>files <span class="ot">&lt;-</span> paths <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-22" data-target-annotation="4">4</button><span id="annotated-cell-22-2" class="code-annotation-target"><a href="#annotated-cell-22-2"></a>  <span class="fu">set_names</span>(basename) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-3"><a href="#annotated-cell-22-3"></a>  <span class="fu">map</span>(readxl<span class="sc">::</span>read_excel)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-22" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-cell="annotated-cell-22" data-code-lines="2">The <code>set_names</code> function takes the function <code>basename</code> which extracts just the file name from the full path. This line of code will therefore create a named vector of the file paths where the names are actually the filenames.</span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p>What is this doing?</p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>paths <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">set_names</span>(basename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:70%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                  1952.xlsx                  1957.xlsx 
&gt; "data/gapminder/1952.xlsx" "data/gapminder/1957.xlsx" 
&gt;                  1962.xlsx                  1967.xlsx 
&gt; "data/gapminder/1962.xlsx" "data/gapminder/1967.xlsx" 
&gt;                  1972.xlsx                  1977.xlsx 
&gt; "data/gapminder/1972.xlsx" "data/gapminder/1977.xlsx" 
&gt;                  1982.xlsx                  1987.xlsx 
&gt; "data/gapminder/1982.xlsx" "data/gapminder/1987.xlsx" 
&gt;                  1992.xlsx                  1997.xlsx 
&gt; "data/gapminder/1992.xlsx" "data/gapminder/1997.xlsx" 
&gt;                  2002.xlsx                  2007.xlsx 
&gt; "data/gapminder/2002.xlsx" "data/gapminder/2007.xlsx"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="data-in-the-filepath-1" class="slide level2">
<h2>Data in the Filepath</h2>
<p>You may have noticed that we’re missing a year indicator in our final dataset. That’s because that information is actually a part of the filename itself.</p>
<p>There’s a way to include the filename in the data but we have to add another step to our <code>paths</code> pipeline:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-23"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-23-1"><a href="#annotated-cell-23-1"></a>files <span class="ot">&lt;-</span> paths <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="4">4</button><span id="annotated-cell-23-2" class="code-annotation-target"><a href="#annotated-cell-23-2"></a>  <span class="fu">set_names</span>(basename) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-23-3"><a href="#annotated-cell-23-3"></a>  <span class="fu">map</span>(readxl<span class="sc">::</span>read_excel)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-23" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-cell="annotated-cell-23" data-code-lines="2">The <code>set_names</code> function takes the function <code>basename</code> which extracts just the file name from the full path. This line of code will therefore create a named vector of the file paths where the names are actually the filenames.</span>
</dd>
</dl>
</div>
</div>
<p>What is this doing?</p>
<div class="columns">
<div class="column" style="width:35%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>paths <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">set_names</span>(basename) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">map</span>(readxl<span class="sc">::</span>read_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:65%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&gt; $`1952.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         28.8  8425333      779.
&gt;  2 Albania     Europe       55.2  1282697     1601.
&gt;  3 Algeria     Africa       43.1  9279525     2449.
&gt;  4 Angola      Africa       30.0  4232095     3521.
&gt;  5 Argentina   Americas     62.5 17876956     5911.
&gt;  6 Australia   Oceania      69.1  8691212    10040.
&gt;  7 Austria     Europe       66.8  6927772     6137.
&gt;  8 Bahrain     Asia         50.9   120447     9867.
&gt;  9 Bangladesh  Asia         37.5 46886859      684.
&gt; 10 Belgium     Europe       68    8730405     8343.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1957.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         30.3  9240934      821.
&gt;  2 Albania     Europe       59.3  1476505     1942.
&gt;  3 Algeria     Africa       45.7 10270856     3014.
&gt;  4 Angola      Africa       32.0  4561361     3828.
&gt;  5 Argentina   Americas     64.4 19610538     6857.
&gt;  6 Australia   Oceania      70.3  9712569    10950.
&gt;  7 Austria     Europe       67.5  6965860     8843.
&gt;  8 Bahrain     Asia         53.8   138655    11636.
&gt;  9 Bangladesh  Asia         39.3 51365468      662.
&gt; 10 Belgium     Europe       69.2  8989111     9715.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1962.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         32.0 10267083      853.
&gt;  2 Albania     Europe       64.8  1728137     2313.
&gt;  3 Algeria     Africa       48.3 11000948     2551.
&gt;  4 Angola      Africa       34    4826015     4269.
&gt;  5 Argentina   Americas     65.1 21283783     7133.
&gt;  6 Australia   Oceania      70.9 10794968    12217.
&gt;  7 Austria     Europe       69.5  7129864    10751.
&gt;  8 Bahrain     Asia         56.9   171863    12753.
&gt;  9 Bangladesh  Asia         41.2 56839289      686.
&gt; 10 Belgium     Europe       70.2  9218400    10991.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1967.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         34.0 11537966      836.
&gt;  2 Albania     Europe       66.2  1984060     2760.
&gt;  3 Algeria     Africa       51.4 12760499     3247.
&gt;  4 Angola      Africa       36.0  5247469     5523.
&gt;  5 Argentina   Americas     65.6 22934225     8053.
&gt;  6 Australia   Oceania      71.1 11872264    14526.
&gt;  7 Austria     Europe       70.1  7376998    12835.
&gt;  8 Bahrain     Asia         59.9   202182    14805.
&gt;  9 Bangladesh  Asia         43.5 62821884      721.
&gt; 10 Belgium     Europe       70.9  9556500    13149.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1972.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         36.1 13079460      740.
&gt;  2 Albania     Europe       67.7  2263554     3313.
&gt;  3 Algeria     Africa       54.5 14760787     4183.
&gt;  4 Angola      Africa       37.9  5894858     5473.
&gt;  5 Argentina   Americas     67.1 24779799     9443.
&gt;  6 Australia   Oceania      71.9 13177000    16789.
&gt;  7 Austria     Europe       70.6  7544201    16662.
&gt;  8 Bahrain     Asia         63.3   230800    18269.
&gt;  9 Bangladesh  Asia         45.3 70759295      630.
&gt; 10 Belgium     Europe       71.4  9709100    16672.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1977.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         38.4 14880372      786.
&gt;  2 Albania     Europe       68.9  2509048     3533.
&gt;  3 Algeria     Africa       58.0 17152804     4910.
&gt;  4 Angola      Africa       39.5  6162675     3009.
&gt;  5 Argentina   Americas     68.5 26983828    10079.
&gt;  6 Australia   Oceania      73.5 14074100    18334.
&gt;  7 Austria     Europe       72.2  7568430    19749.
&gt;  8 Bahrain     Asia         65.6   297410    19340.
&gt;  9 Bangladesh  Asia         46.9 80428306      660.
&gt; 10 Belgium     Europe       72.8  9821800    19118.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1982.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp      pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         39.9 12881816      978.
&gt;  2 Albania     Europe       70.4  2780097     3631.
&gt;  3 Algeria     Africa       61.4 20033753     5745.
&gt;  4 Angola      Africa       39.9  7016384     2757.
&gt;  5 Argentina   Americas     69.9 29341374     8998.
&gt;  6 Australia   Oceania      74.7 15184200    19477.
&gt;  7 Austria     Europe       73.2  7574613    21597.
&gt;  8 Bahrain     Asia         69.1   377967    19211.
&gt;  9 Bangladesh  Asia         50.0 93074406      677.
&gt; 10 Belgium     Europe       73.9  9856303    20980.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1987.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp       pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         40.8  13867957      852.
&gt;  2 Albania     Europe       72     3075321     3739.
&gt;  3 Algeria     Africa       65.8  23254956     5681.
&gt;  4 Angola      Africa       39.9   7874230     2430.
&gt;  5 Argentina   Americas     70.8  31620918     9140.
&gt;  6 Australia   Oceania      76.3  16257249    21889.
&gt;  7 Austria     Europe       74.9   7578903    23688.
&gt;  8 Bahrain     Asia         70.8    454612    18524.
&gt;  9 Bangladesh  Asia         52.8 103764241      752.
&gt; 10 Belgium     Europe       75.4   9870200    22526.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1992.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp       pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         41.7  16317921      649.
&gt;  2 Albania     Europe       71.6   3326498     2497.
&gt;  3 Algeria     Africa       67.7  26298373     5023.
&gt;  4 Angola      Africa       40.6   8735988     2628.
&gt;  5 Argentina   Americas     71.9  33958947     9308.
&gt;  6 Australia   Oceania      77.6  17481977    23425.
&gt;  7 Austria     Europe       76.0   7914969    27042.
&gt;  8 Bahrain     Asia         72.6    529491    19036.
&gt;  9 Bangladesh  Asia         56.0 113704579      838.
&gt; 10 Belgium     Europe       76.5  10045622    25576.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`1997.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp       pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         41.8  22227415      635.
&gt;  2 Albania     Europe       73.0   3428038     3193.
&gt;  3 Algeria     Africa       69.2  29072015     4797.
&gt;  4 Angola      Africa       41.0   9875024     2277.
&gt;  5 Argentina   Americas     73.3  36203463    10967.
&gt;  6 Australia   Oceania      78.8  18565243    26998.
&gt;  7 Austria     Europe       77.5   8069876    29096.
&gt;  8 Bahrain     Asia         73.9    598561    20292.
&gt;  9 Bangladesh  Asia         59.4 123315288      973.
&gt; 10 Belgium     Europe       77.5  10199787    27561.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`2002.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp       pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         42.1  25268405      727.
&gt;  2 Albania     Europe       75.7   3508512     4604.
&gt;  3 Algeria     Africa       71.0  31287142     5288.
&gt;  4 Angola      Africa       41.0  10866106     2773.
&gt;  5 Argentina   Americas     74.3  38331121     8798.
&gt;  6 Australia   Oceania      80.4  19546792    30688.
&gt;  7 Austria     Europe       79.0   8148312    32418.
&gt;  8 Bahrain     Asia         74.8    656397    23404.
&gt;  9 Bangladesh  Asia         62.0 135656790     1136.
&gt; 10 Belgium     Europe       78.3  10311970    30486.
&gt; # ℹ 132 more rows
&gt; 
&gt; $`2007.xlsx`
&gt; # A tibble: 142 × 5
&gt;    country     continent lifeExp       pop gdpPercap
&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia         43.8  31889923      975.
&gt;  2 Albania     Europe       76.4   3600523     5937.
&gt;  3 Algeria     Africa       72.3  33333216     6223.
&gt;  4 Angola      Africa       42.7  12420476     4797.
&gt;  5 Argentina   Americas     75.3  40301927    12779.
&gt;  6 Australia   Oceania      81.2  20434176    34435.
&gt;  7 Austria     Europe       79.8   8199783    36126.
&gt;  8 Bahrain     Asia         75.6    708573    29796.
&gt;  9 Bangladesh  Asia         64.1 150448339     1391.
&gt; 10 Belgium     Europe       79.4  10392226    33693.
&gt; # ℹ 132 more rows</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="data-in-the-filepath-2" class="slide level2">
<h2>Data in the Filepath</h2>
<p>To create a <code>year</code> variable we need to tell <code>list_rbind</code> to save the filename information.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-24"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-24-1"><a href="#annotated-cell-24-1"></a>gapminder <span class="ot">&lt;-</span> paths <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-24-2"><a href="#annotated-cell-24-2"></a>  <span class="fu">set_names</span>(basename) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-24-3"><a href="#annotated-cell-24-3"></a>  <span class="fu">map</span>(readxl<span class="sc">::</span>read_excel) <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="5">5</button><span id="annotated-cell-24-4" class="code-annotation-target"><a href="#annotated-cell-24-4"></a>  <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"year"</span>) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="6">6</button><span id="annotated-cell-24-5" class="code-annotation-target"><a href="#annotated-cell-24-5"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">parse_number</span>(year))</span>
<span id="annotated-cell-24-6"><a href="#annotated-cell-24-6"></a>gapminder</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-24" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-cell="annotated-cell-24" data-code-lines="4">The name of each list element (the filename) will be saved as the variable <code>year</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-24" data-target-annotation="6">6</dt>
<dd>
<span data-code-annotation="6" data-code-cell="annotated-cell-24" data-code-lines="5">Extracting just the numeric part of the filename which is the actual year.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 1,704 × 6
&gt;     year country     continent lifeExp      pop gdpPercap
&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
&gt;  1  1952 Afghanistan Asia         28.8  8425333      779.
&gt;  2  1952 Albania     Europe       55.2  1282697     1601.
&gt;  3  1952 Algeria     Africa       43.1  9279525     2449.
&gt;  4  1952 Angola      Africa       30.0  4232095     3521.
&gt;  5  1952 Argentina   Americas     62.5 17876956     5911.
&gt;  6  1952 Australia   Oceania      69.1  8691212    10040.
&gt;  7  1952 Austria     Europe       66.8  6927772     6137.
&gt;  8  1952 Bahrain     Asia         50.9   120447     9867.
&gt;  9  1952 Bangladesh  Asia         37.5 46886859      684.
&gt; 10  1952 Belgium     Europe       68    8730405     8343.
&gt; # ℹ 1,694 more rows</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="7">7</button><span id="annotated-cell-25-1" class="code-annotation-target"><a href="#annotated-cell-25-1"></a><span class="fu">write_csv</span>(gapminder, <span class="st">"gapminder.csv"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="7">7</dt>
<dd>
<span data-code-annotation="7" data-code-cell="annotated-cell-25" data-code-lines="1">Be sure to save your work so you can simply read in one file when working on this project in the future!</span>
</dd>
</dl>
</div>
</div>
</div>
</section>
<section id="more-complex-cases" class="slide level2">
<h2>More Complex Cases</h2>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:blue"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> Complicated Filenames</strong></p>
</div>
<div class="callout-content">
<p>There might be other variables stored in the directory name, or maybe the file name contains multiple bits of data. In that case, use <code>set_names()</code> (without any arguments) to record the full path, and then use <code>separate_wider_delim()</code> and friends to turn them into useful columns. See example at the end of <a href="https://r4ds.hadley.nz/iteration#sec-data-in-the-path">this section</a>.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:green"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> Untidy data of the same structure</strong></p>
</div>
<div class="callout-content">
<p>You can use <code>map</code> many times to perform different tidying and data manipulation tasks before combining datasets. Alternatively you can <code>list_rbind</code> first and then perform data manipulation tasks using a standard <code>dplyr</code> approach. See examples <a href="https://r4ds.hadley.nz/iteration#many-simple-iterations">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:tomato"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> Heterogenous data</strong></p>
</div>
<div class="callout-content">
<p>Read <a href="https://r4ds.hadley.nz/iteration#heterogeneous-data">this section</a> of <em>“R for Data Science”</em></p>
</div>
</div>
</div>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:red"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> Troubleshooting</strong></p>
</div>
<div class="callout-content">
<p>Read <a href="https://r4ds.hadley.nz/iteration#handling-failures">this section</a> of <em>“R for Data Science”</em></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="saving-multiple-outputs" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Saving Multiple Outputs</h1>

</section>
<section id="writing-multiple-csv-files" class="slide level2">
<h2>Writing multiple csv files</h2>
<p>Let’s imagine we want to save multiple datasets based on a feature of the data.</p>
<div class="fragment">
<p>For example, what if we want a different csv for each <code>clarity</code> type in the <code>diamonds</code> dataset?</p>
</div>
<div class="fragment">
<p>The easiest way to make these individual datasets is using <code>group_nest()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-26"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-26-1"><a href="#annotated-cell-26-1"></a>by_clarity <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="1">1</button><span id="annotated-cell-26-2" class="code-annotation-target"><a href="#annotated-cell-26-2"></a>  <span class="fu">group_nest</span>(clarity) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="2">2</button><span id="annotated-cell-26-3" class="code-annotation-target"><a href="#annotated-cell-26-3"></a>  <span class="fu">mutate</span>(<span class="at">path =</span> <span class="fu">str_glue</span>(<span class="st">"diamonds-{clarity}.csv"</span>))</span>
<span id="annotated-cell-26-4"><a href="#annotated-cell-26-4"></a></span>
<span id="annotated-cell-26-5"><a href="#annotated-cell-26-5"></a>by_clarity</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-26" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-cell="annotated-cell-26" data-code-lines="2">Nests a tibble using a grouping specification.</span>
</dd>
<dt data-target-cell="annotated-cell-26" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-cell="annotated-cell-26" data-code-lines="3">Creates a column that gives the name of output file.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 8 × 3
&gt;   clarity               data path             
&gt;   &lt;ord&gt;   &lt;list&lt;tibble[,9]&gt;&gt; &lt;glue&gt;           
&gt; 1 I1               [741 × 9] diamonds-I1.csv  
&gt; 2 SI2            [9,194 × 9] diamonds-SI2.csv 
&gt; 3 SI1           [13,065 × 9] diamonds-SI1.csv 
&gt; 4 VS2           [12,258 × 9] diamonds-VS2.csv 
&gt; 5 VS1            [8,171 × 9] diamonds-VS1.csv 
&gt; 6 VVS2           [5,066 × 9] diamonds-VVS2.csv
&gt; 7 VVS1           [3,655 × 9] diamonds-VVS1.csv
&gt; 8 IF             [1,790 × 9] diamonds-IF.csv</code></pre>
</div>
</div>
</div>
</section>
<section id="writing-multiple-csv-files-1" class="slide level2">
<h2>Writing multiple csv files</h2>
<p>Let’s imagine we want to save multiple datasets based on a feature of the data.</p>
<p>For example, what if we want a different csv for each <code>clarity</code> type in the <code>diamonds</code> dataset?</p>
<p>The easiest way to make these individual datasets is using <code>group_nest()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>by_clarity<span class="sc">$</span>data[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 741 × 9
&gt;    carat cut       color depth table price     x     y     z
&gt;    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
&gt;  1  0.32 Premium   E      60.9    58   345  4.38  4.42  2.68
&gt;  2  1.17 Very Good J      60.2    61  2774  6.83  6.9   4.13
&gt;  3  1.01 Premium   F      61.8    60  2781  6.39  6.36  3.94
&gt;  4  1.01 Fair      E      64.5    58  2788  6.29  6.21  4.03
&gt;  5  0.96 Ideal     F      60.7    55  2801  6.37  6.41  3.88
&gt;  6  1.04 Premium   G      62.2    58  2801  6.46  6.41  4   
&gt;  7  1    Fair      G      66.4    59  2808  6.16  6.09  4.07
&gt;  8  1.2  Fair      F      64.6    56  2809  6.73  6.66  4.33
&gt;  9  0.43 Very Good E      58.4    62   555  4.94  5     2.9 
&gt; 10  1.02 Premium   G      60.3    58  2815  6.55  6.5   3.94
&gt; # ℹ 731 more rows</code></pre>
</div>
</div>
</section>
<section id="using-walk" class="slide level2">
<h2>Using <code>walk()</code></h2>
<p>We basically want to carry out the following but we can’t simply use <code>map()</code> because now we have <em>2</em> arguments that vary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">write_csv</span>(by_clarity<span class="sc">$</span>data[[<span class="dv">1</span>]], by_clarity<span class="sc">$</span>path[[<span class="dv">1</span>]])</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">write_csv</span>(by_clarity<span class="sc">$</span>data[[<span class="dv">2</span>]], by_clarity<span class="sc">$</span>path[[<span class="dv">2</span>]])</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="fu">write_csv</span>(by_clarity<span class="sc">$</span>data[[<span class="dv">3</span>]], by_clarity<span class="sc">$</span>path[[<span class="dv">3</span>]])</span>
<span id="cb48-4"><a href="#cb48-4"></a>...</span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="fu">write_csv</span>(by_clarity<span class="sc">$</span>by_clarity[[<span class="dv">8</span>]], by_clarity<span class="sc">$</span>path[[<span class="dv">8</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>So we could use <code>map2()</code>, which allows us to map over <strong>2</strong> inputs!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">map2</span>(by_clarity<span class="sc">$</span>data, by_clarity<span class="sc">$</span>path, write_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>If we were to run the above, it will apply the first two arguments to the <code>write_csv()</code> function <em>and also print out all the datasets as it saves them</em>.</p>
</div>
<div class="fragment">
<p>Since we don’t actually care about the output (i.e.&nbsp;the printed datasets) and only want the files to be written, there’s an even better function we can use: <code>walk2()</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">walk2</span>(by_clarity<span class="sc">$</span>data, by_clarity<span class="sc">$</span>path, write_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This performs the exact same thing as <code>map2()</code> but throws the output away. Therefore we’re left with just the file-saving behavior which is what we’re after.</p>
</div>
</section>
<section id="saving-multiple-plots" class="slide level2">
<h2>Saving multiple plots</h2>
<p>The same basic approach can be used to save multiple plots.</p>
<div class="fragment">
<p>First let’s create a function that draws the plot we want.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>carat_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> carat)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)  </span>
<span id="cb51-3"><a href="#cb51-3"></a>}</span>
<span id="cb51-4"><a href="#cb51-4"></a></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="fu">carat_histogram</span>(by_clarity<span class="sc">$</span>data[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="CSSS508_Lecture9_files/figure-revealjs/unnamed-chunk-49-1.svg"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="saving-multiple-plots-fa-scroll" class="slide level2 scrollable">
<h2>Saving multiple plots <span style="color:#99a486"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span></h2>
<p>Now we can use <code>map()</code> to create a list of many plots and their eventual file paths:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>by_clarity <span class="ot">&lt;-</span> by_clarity <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="at">plot =</span> <span class="fu">map</span>(data, carat_histogram),</span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="at">path =</span> <span class="fu">str_glue</span>(<span class="st">"clarity-{clarity}.png"</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>  )</span>
<span id="cb52-6"><a href="#cb52-6"></a>by_clarity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 8 × 4
&gt;   clarity               data path             plot  
&gt;   &lt;ord&gt;   &lt;list&lt;tibble[,9]&gt;&gt; &lt;glue&gt;           &lt;list&gt;
&gt; 1 I1               [741 × 9] clarity-I1.png   &lt;gg&gt;  
&gt; 2 SI2            [9,194 × 9] clarity-SI2.png  &lt;gg&gt;  
&gt; 3 SI1           [13,065 × 9] clarity-SI1.png  &lt;gg&gt;  
&gt; 4 VS2           [12,258 × 9] clarity-VS2.png  &lt;gg&gt;  
&gt; 5 VS1            [8,171 × 9] clarity-VS1.png  &lt;gg&gt;  
&gt; 6 VVS2           [5,066 × 9] clarity-VVS2.png &lt;gg&gt;  
&gt; 7 VVS1           [3,655 × 9] clarity-VVS1.png &lt;gg&gt;  
&gt; 8 IF             [1,790 × 9] clarity-IF.png   &lt;gg&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>by_clarity<span class="sc">$</span>plot[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="CSSS508_Lecture9_files/figure-revealjs/unnamed-chunk-51-1.svg"></p>
</div>
</div>
</div>
</section>
<section id="saving-multiple-plots-1" class="slide level2">
<h2>Saving multiple plots</h2>
<p>Then use <code>walk2()</code> with <code>ggsave()</code> to save each plot:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">walk2</span>(</span>
<span id="cb55-2"><a href="#cb55-2"></a>  by_clarity<span class="sc">$</span>path,</span>
<span id="cb55-3"><a href="#cb55-3"></a>  by_clarity<span class="sc">$</span>plot,</span>
<span id="cb55-4"><a href="#cb55-4"></a>  \(path, plot) <span class="fu">ggsave</span>(path, plot, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb55-5"><a href="#cb55-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</div>
<div class="fragment">
<p>Which is shorthand for:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">ggsave</span>(by_clarity<span class="sc">$</span>path[[<span class="dv">1</span>]], by_clarity<span class="sc">$</span>plot[[<span class="dv">1</span>]], <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="fu">ggsave</span>(by_clarity<span class="sc">$</span>path[[<span class="dv">2</span>]], by_clarity<span class="sc">$</span>plot[[<span class="dv">2</span>]], <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="fu">ggsave</span>(by_clarity<span class="sc">$</span>path[[<span class="dv">3</span>]], by_clarity<span class="sc">$</span>plot[[<span class="dv">3</span>]], <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb56-4"><a href="#cb56-4"></a>...</span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="fu">ggsave</span>(by_clarity<span class="sc">$</span>path[[<span class="dv">8</span>]], by_clarity<span class="sc">$</span>plot[[<span class="dv">8</span>]], <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section>
<section>
<section id="apply-family" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Apply Family</h1>

</section>
<section id="lapply" class="slide level2">
<h2><code>lapply</code></h2>
<p>Base <code>R</code> has it’s own family of iterative functions: the apply family of functions.</p>
<div class="fragment">
<p>The most one-to-one translation in this family is <code>lapply</code> (list apply) to <code>map</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-36"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-36" data-target-annotation="1">1</button><span id="annotated-cell-36-1" class="code-annotation-target"><a href="#annotated-cell-36-1"></a><span class="fu">lapply</span>(swiss, <span class="at">FUN =</span> median)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-36" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-cell="annotated-cell-36" data-code-lines="1">Since all of the examples of <code>map</code> in today’s lecture are fairly simple, you can swap in <code>lapply</code> for any of them.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; $Fertility
&gt; [1] 70.4
&gt; 
&gt; $Agriculture
&gt; [1] 54.1
&gt; 
&gt; $Examination
&gt; [1] 16
&gt; 
&gt; $Education
&gt; [1] 8
&gt; 
&gt; $Catholic
&gt; [1] 15.14
&gt; 
&gt; $Infant.Mortality
&gt; [1] 20</code></pre>
</div>
</div>
<p>Simply, <code>lapply()</code> is used to apply a function over a list of any kind (e.g.&nbsp;a data frame) and return a list.</p>
</div>
</section>
<section id="sapply-simple-lapply" class="slide level2">
<h2><code>sapply()</code>: Simple <code>lapply()</code></h2>
<p>A downside to <code>lapply()</code> is that lists can be hard to work with. <code>sapply()</code>, therefore, always tries to simplify the result.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">sapply</span>(swiss, <span class="at">FUN =</span> median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;        Fertility      Agriculture      Examination        Education 
&gt;            70.40            54.10            16.00             8.00 
&gt;         Catholic Infant.Mortality 
&gt;            15.14            20.00</code></pre>
</div>
</div>
<p>In this case, our list was simplified to a named numeric vector. However, the simplification can fail and give you an unexpected type so proceed with caution if you intend to use <code>sapply()</code>.</p>
</div>
<div class="fragment">
<h4 id="vapply-vector-apply"><code>vapply()</code>: vector apply</h4>
<p>This version takes an additional argument that specifies the expected type, ensuring that simplification occurs the same way regardless of the input.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">vapply</span>(swiss, median, <span class="fu">double</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;        Fertility      Agriculture      Examination        Education 
&gt;            70.40            54.10            16.00             8.00 
&gt;         Catholic Infant.Mortality 
&gt;            15.14            20.00</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tapply" class="slide level2">
<h2><code>tapply()</code></h2>
<p>Another important member of the apply family is <code>tapply()</code> which computes a single grouped summary.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb62" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">price =</span> <span class="fu">mean</span>(price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; # A tibble: 5 × 2
&gt;   cut       price
&gt;   &lt;ord&gt;     &lt;dbl&gt;
&gt; 1 Fair      4359.
&gt; 2 Good      3929.
&gt; 3 Very Good 3982.
&gt; 4 Premium   4584.
&gt; 5 Ideal     3458.</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb64" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(diamonds<span class="sc">$</span>price, diamonds<span class="sc">$</span>cut, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;      Fair      Good Very Good   Premium     Ideal 
&gt;      4359      3929      3982      4584      3458</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>Unfortunately <code>tapply()</code> returns its results in a named vector which requires some gymnastics if you want to collect multiple summaries and grouping variables into a data frame.</p>
</div>
</section>
<section id="apply" class="slide level2">
<h2><code>apply()</code></h2>
<p>Lastly, there’s <code>apply()</code>, which works over matrices or data frames. You can apply the function to each row <code>(MARGIN = 1)</code> or column <code>(MARGIN = 2)</code>.</p>
<div class="fragment">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">apply</span>(swiss, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;         Fertility Agriculture Examination Education Catholic Infant.Mortality
&gt; Min.        35.00        1.20        3.00      1.00    2.150            10.80
&gt; 1st Qu.     64.70       35.90       12.00      6.00    5.195            18.15
&gt; Median      70.40       54.10       16.00      8.00   15.140            20.00
&gt; Mean        70.14       50.66       16.49     10.98   41.144            19.94
&gt; 3rd Qu.     78.45       67.65       22.00     12.00   93.125            21.70
&gt; Max.        92.50       89.70       37.00     53.00  100.000            26.60</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="for-loops" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1><code>for</code> loops</h1>

</section>
<section id="anatomy-of-a-for-loop" class="slide level2">
<h2>Anatomy of a <code>for</code> loop</h2>
<p><code>for</code> loops are the fundamental building block of iteration that both the apply and map families use under the hood.</p>
<div class="fragment">
<p>As you become a more experienced <code>R</code> programmer, <code>for</code> loops are a powerful and general tool that will be important to learn.</p>
</div>
<div class="fragment">
<p><br></p>
<p>The basic structure of a for loop looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="cf">for</span> (element <span class="cf">in</span> vector) {</span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="co"># do something with element</span></span>
<span id="cb68-3"><a href="#cb68-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="parallel-with-walk" class="slide level2">
<h2>Parallel with <code>walk()</code></h2>
<p>The most straightforward use of for loops is to achieve the same effect as <code>walk()</code>: call some function with a side-effect on each element of a vector/list.</p>
<div class="fragment">
<p>A <em>very</em> basic example:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb69-2"><a href="#cb69-2"></a>    <span class="fu">print</span>(i)</span>
<span id="cb69-3"><a href="#cb69-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 1
&gt; [1] 2
&gt; [1] 3
&gt; [1] 4
&gt; [1] 5
&gt; [1] 6
&gt; [1] 7
&gt; [1] 8
&gt; [1] 9
&gt; [1] 10</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">|&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="fu">walk</span>(\(x) <span class="fu">print</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 1
&gt; [1] 2
&gt; [1] 3
&gt; [1] 4
&gt; [1] 5
&gt; [1] 6
&gt; [1] 7
&gt; [1] 8
&gt; [1] 9
&gt; [1] 10</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Things get a little trickier if you want to save the output of the for loop.</p>
</div>
<div class="fragment">
<p>When you’re ready to dive into more advanced functional programming topics, including loops, check out the <a href="https://adv-r.hadley.nz/control-flow.html#control-flow">Control Flow</a> and <a href="https://adv-r.hadley.nz/fp.html">Functional Programming</a> chapters of <em>Advanced R</em>.</p>
</div>
</section></section>
<section>
<section id="lab" class="title-slide slide level1 section-title center" data-background-color="#99a486">
<h1>Lab</h1>

</section>
<section id="iteration-with-across" class="slide level2">
<h2>Iteration with <code>across</code></h2>
<ol type="1">
<li><p>Compute the number of unique values in each column of <code>palmerpenguins::penguins</code><sup>1</sup>.</p></li>
<li><p>Compute the mean of every column in <code>mtcars.</code></p></li>
<li><p>Group <code>diamonds</code> by <code>cut</code>, <code>clarity</code>, and <code>color</code> then count the number of observations and compute the mean of each numeric column.</p></li>
<li><p>What happens if you use a list of functions in <code>across()</code>, but don’t name them? How is the output named?</p></li>
</ol>
<aside><ol class="aside-footnotes"><li id="fn1"><p>You’ll need to download the <code>palmerpenguins</code> package in order to use <code>penguins</code> dataset.</p></li></ol></aside></section>



</section>
<section>
<section id="homework" class="title-slide slide level1 section-title center" data-background-color="#1e4655">
<h1>Homework</h1>

</section>
<section id="section-1" class="slide level2" data-menu-title="Homework 9" data-background-iframe="https://vsass.github.io/CSSS508/Homework/HW9/homework9.html" data-background-interactive="TRUE">
<h2></h2>

<div class="footer footer-default">

</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'pointer': {"key":"q","color":"#b18eb1","pointerSize":16,"alwaysVisible":false},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
              // default icon
              link.classList.add("external");
          }
        }
    });
    </script>
    

</body></html>