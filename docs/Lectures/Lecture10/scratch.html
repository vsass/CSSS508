<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>scratch</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-09ad465de797c9fa47eb004b66687419.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a91c5eb92031c01585ac21bee704d2ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://vsass.github.io"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">CS&amp;SS 508</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Lectures/lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Homework/homework.html"> 
<span class="menu-text">Homework</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">scratch</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="topics-for-today" class="level2">
<h2 class="anchored" data-anchor-id="topics-for-today">Topics for Today</h2>
<section id="working-with-model-results" class="level3">
<h3 class="anchored" data-anchor-id="working-with-model-results">Working with Model Results</h3>
<ul>
<li>Tidy model output with <code>broom</code></li>
<li>Visualizing models with <code>ggeffects</code></li>
<li>Tables with <code>gt</code>, <code>modelsummary</code>, and <code>gtsummary</code></li>
</ul>
</section>
<section id="reproducible-research" class="level3">
<h3 class="anchored" data-anchor-id="reproducible-research">Reproducible Research</h3>
</section>
<section id="best-practices" class="level3">
<h3 class="anchored" data-anchor-id="best-practices">Best Practices</h3>
<ul>
<li>Organization</li>
<li>Portability</li>
<li>Version Control</li>
</ul>
</section>
<section id="wrapping-up-the-course" class="level3">
<h3 class="anchored" data-anchor-id="wrapping-up-the-course">Wrapping up the course</h3>
</section>
</section>
<section id="working-with-model-results-1" class="level1 page-columns page-full">
<h1>Working with Model Results</h1>
<section id="broom" class="level2">
<h2 class="anchored" data-anchor-id="broom"><code>broom</code></h2>
<p><code>broom</code> is a package that “tidies up” the output from models such a <code>lm()</code> and <code>glm()</code>.</p>
<p>It has a small number of key functions:</p>
<ul>
<li><code>tidy()</code> - Creates a dataframe summary of a model.</li>
<li><code>augment()</code> - Adds columns—such as fitted values—to the data used in the model.</li>
<li><code>glance()</code> - Provides one row of fit statistics for models.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-output-is-a-list" class="level2">
<h2 class="anchored" data-anchor-id="model-output-is-a-list">Model Output is a List</h2>
<p><code>lm()</code> and <code>summary()</code> produce lists as output, which cannot go directly into tidyverse functions, particularly those in <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yn <span class="sc">~</span> num1 <span class="sc">+</span> fac1, <span class="at">data =</span> ex_dat)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yn ~ num1 + fac1, data = ex_dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.9278 -1.7483  0.0797  1.7133  6.9180 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.2368     0.4023   3.074  0.00241 ** 
num1          0.6080     0.1083   5.616 6.61e-08 ***
fac1B         1.0854     0.5196   2.089  0.03799 *  
fac1C         2.5245     0.5230   4.827 2.78e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.874 on 196 degrees of freedom
Multiple R-squared:  0.2308,    Adjusted R-squared:  0.219 
F-statistic:  19.6 on 3 and 196 DF,  p-value: 3.732e-11
....</code></pre>
</div>
</div>
</section>
<section id="model-output-varies" class="level2">
<h2 class="anchored" data-anchor-id="model-output-varies">Model Output Varies!</h2>
<p>Each type of model also produces somewhat different output, so you can’t just reuse the same code to handle output from every model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>glm_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(yb <span class="sc">~</span> num1 <span class="sc">+</span> fac1, <span class="at">data =</span> ex_dat, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = yb ~ num1 + fac1, family = binomial(link = "logit"), 
    data = ex_dat)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.38172    0.34647  -3.988 6.66e-05 ***
num1         0.34216    0.08952   3.822 0.000132 ***
fac1B        0.84734    0.40377   2.099 0.035853 *  
fac1C        1.56168    0.41602   3.754 0.000174 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 276.76  on 199  degrees of freedom
Residual deviance: 244.41  on 196  degrees of freedom
AIC: 252.41

....</code></pre>
</div>
</div>
</section>
<section id="broomtidy" class="level2">
<h2 class="anchored" data-anchor-id="broomtidy"><code>broom::tidy()</code></h2>
<p><code>tidy()</code> produces similar output, but as a dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term        estimate std.error statistic      p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 (Intercept)    1.24      0.402      3.07 0.00241     
2 num1           0.608     0.108      5.62 0.0000000661
3 fac1B          1.09      0.520      2.09 0.0380      
4 fac1C          2.52      0.523      4.83 0.00000278  </code></pre>
</div>
</div>
<p>Each type of model (e.g.&nbsp;<code>glm</code>, <code>lmer</code>) has a different <em>method</em> with its own additional arguments. See <code>?tidy.lm</code> for an example.</p>
</section>
<section id="broomtidy-1" class="level2">
<h2 class="anchored" data-anchor-id="broomtidy-1"><code>broom::tidy()</code></h2>
<p>This output is also completely identical between different models.</p>
<p>This can be very useful and important if running models with different test statistics… or just running a lot of models!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>glm_1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   -1.38     0.346      -3.99 0.0000666
2 num1           0.342    0.0895      3.82 0.000132 
3 fac1B          0.847    0.404       2.10 0.0359   
4 fac1C          1.56     0.416       3.75 0.000174 </code></pre>
</div>
</div>
</section>
<section id="broomglance" class="level2">
<h2 class="anchored" data-anchor-id="broomglance"><code>broom::glance()</code></h2>
<p><code>glance()</code> produces dataframes of fit statistics for models.</p>
<p>If you run many models, you can compare each model row-by-row in each column… or even plot their different fit statistics to allow holistic comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.231         0.219  2.87      19.6 3.73e-11     3  -493.  996. 1012.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="broomaugment" class="level2">
<h2 class="anchored" data-anchor-id="broomaugment"><code>broom::augment()</code></h2>
<p><code>augment()</code> takes values generated by a model and adds them back to the original data. This includes fitted values, residuals, and leverage statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(lm_1) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
      yn   num1 fac1  .fitted .resid   .hat .sigma    .cooksd .std.resid
   &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1  1.60   0.583 B       2.68  -1.08  0.0141   2.88 0.000512      -0.379 
2 11.5    1.76  C       4.83   6.64  0.0148   2.84 0.0204         2.33  
3  9.26   0.350 C       3.97   5.29  0.0148   2.86 0.0129         1.85  
4  0.826 -0.480 A       0.945 -0.119 0.0209   2.88 0.00000940    -0.0420
5  5.10   1.61  B       3.30   1.80  0.0132   2.88 0.00134        0.632 
6 -2.90  -0.962 C       3.18  -6.08  0.0198   2.85 0.0230        -2.13  </code></pre>
</div>
</div>
<p>See <code>?augment.lm</code> for examples of what <code>augment()</code> can do.</p>
</section>
<section id="the-power-of-broom" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-power-of-broom">The Power of <code>broom</code></h2>
<p>The real advantage of <code>broom</code> becomes apparent when running many models at once. Here we run separate models for each level of <code>fac1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ex_dat <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(fac1) <span class="sc">%&gt;%</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="fu">lm</span>(yn <span class="sc">~</span>  num1 <span class="sc">+</span> fac2, <span class="at">data =</span> data))) <span class="sc">%&gt;%</span>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">tidy</span>(model), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  fac1  term        estimate std.error statistic      p.value
  &lt;fct&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 A     (Intercept)  -0.0447     0.522   -0.0857 0.932       
2 A     num1          0.746      0.167    4.48   0.0000442   
3 A     fac2No        2.24       0.695    3.22   0.00224     
4 B     (Intercept)   1.71       0.417    4.11   0.000104    
5 B     num1          0.788      0.154    5.11   0.00000252  
6 B     fac2No        0.737      0.550    1.34   0.184       
7 C     (Intercept)   3.94       0.635    6.20   0.0000000373
8 C     num1          0.291      0.223    1.30   0.197       
9 C     fac2No        0.306      0.811    0.377  0.708       </code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p><code>nest_by()</code> nests data into a list column by levels of <code>fac1</code>.</p>
</div></div></section>
</section>
<section id="plotting-model-results" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Plotting Model Results</h1>
<section id="geom_smooth" class="level2">
<h2 class="anchored" data-anchor-id="geom_smooth"><code>geom_smooth()</code></h2>
<p>I have used <code>geom_smooth()</code> in many past examples.</p>
<p><code>geom_smooth()</code> generates “smoothed conditional means” including loess curves and generalized additive models (GAMs).</p>
<p>. . .</p>
<p>Note, however, that most regression models are conditional mean models, such as ordinary least squares and generalized linear models.</p>
<p>. . .</p>
<p>We can use <code>geom_smooth()</code> to add a layer depicting common bivariate models.</p>
<p>We’ll look at this with the <code>gapminder</code> data from Week 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
</section>
<section id="default-geom_smooth" class="level2">
<h2 class="anchored" data-anchor-id="default-geom_smooth">Default <code>geom_smooth()</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By default, <code>geom_smooth()</code> chooses either a loess smoother (N &lt; 1000) or a GAM depending on the number of observations.</p>
</section>
<section id="linear-glm" class="level2">
<h2 class="anchored" data-anchor-id="linear-glm">Linear <code>glm</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We could also fit a standard linear model using either <code>method = "glm"</code> or <code>method = "lm"</code> and a formula like <code>y ~ x</code>.</p>
</section>
<section id="polynomial-glm" class="level2">
<h2 class="anchored" data-anchor-id="polynomial-glm">Polynomial <code>glm</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>poly(x, 2)</code> produces a quadratic model which contains a linear term (<code>x</code>) and a quadratic term (<code>x^2</code>).</p>
</section>
<section id="more-complex-models" class="level2">
<h2 class="anchored" data-anchor-id="more-complex-models">More Complex Models</h2>
<p>What if we want something more complex than a bivariate model?</p>
<p>What if we have a statistically complex model, like nonlinear probability model or multilevel model?</p>
<p>We need to go beyond <code>geom_smooth()</code>!</p>
</section>
<section id="but-first-vocab" class="level2">
<h2 class="anchored" data-anchor-id="but-first-vocab">But first, vocab!</h2>
<p>We are often interested in what might happen if some variables take particular values, often ones not seen in the actual data.</p>
<p>. . .</p>
<p>When we set variables to certain values, we refer to them as <strong>counterfactual values</strong> or just <strong>counterfactuals</strong>.</p>
<p>. . .</p>
<p>For example, if we know nothing about a new observation, our prediction for that estimate is often based on assuming every variable is at its mean.</p>
<p>. . .</p>
<p>Sometimes, however, we might have very specific questions which require setting (possibly many) combinations of variables to particular values and making an estimate or prediction.</p>
<p>. . .</p>
<p>Providing specific estimates, conditional on values of covariates, is a nice way to summarize results, particularly for models with unintuitive parameters (e.g.&nbsp;logit models).</p>
</section>
</section>
<section id="ggeffects" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486"><code>ggeffects</code></h1>
<section id="ggeffects-1" class="level2">
<h2 class="anchored" data-anchor-id="ggeffects-1"><code>ggeffects</code></h2>
<p>If we want to look at more complex models, we can use <code>ggeffects</code> to create and plot tidy <em>marginal effects</em>.</p>
<p>That is, tidy dataframes of <em>ranges</em> of predicted values that can be fed straight into <code>ggplot2</code> for plotting model results.</p>
<p>We will focus on two <code>ggeffects</code> functions:</p>
<ul>
<li><code>ggpredict()</code> - Computes predicted values for the outcome variable at margins of specific variables.</li>
<li><code>plot.ggeffects()</code> - A plot method for <code>ggeffects</code> objects (like <code>ggpredict()</code> output)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="quick-simulated-data" class="level2">
<h2 class="anchored" data-anchor-id="quick-simulated-data">Quick Simulated Data</h2>
<p>To best show off <code>ggeffects</code>, I need a data frame with numeric and categorical variables with strong relationships. It is easiest to just simulate it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ex_dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">num1 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fac1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">200</span>, <span class="cn">TRUE</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">num2 =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fac2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yn =</span> num1 <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> fac1 <span class="sc">*</span> <span class="fl">1.1</span> <span class="sc">+</span> num2 <span class="sc">*</span> <span class="fl">0.7</span> <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>              fac2 <span class="sc">-</span> <span class="fl">1.5</span>  <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yb =</span> <span class="fu">as.numeric</span>(yn <span class="sc">&gt;</span> <span class="fu">mean</span>(yn))) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fac1 =</span> <span class="fu">factor</span>(fac1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fac2 =</span> <span class="fu">factor</span>(fac2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ex_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 6
$ num1 &lt;dbl&gt; -0.45014624, 1.03493712, 3.42843174, 1.36083964, 2.76882846, 3.85…
$ fac1 &lt;fct&gt; C, B, A, A, C, B, B, A, B, A, A, C, B, B, B, C, A, C, B, A, B, B,…
$ num2 &lt;dbl&gt; 2.6583679, 0.3557909, -5.2896277, -4.4824902, 3.0269356, 1.738611…
$ fac2 &lt;fct&gt; No, Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes, No…
$ yn   &lt;dbl&gt; 6.5666766, 5.3085002, -1.9277200, -1.3685167, 6.6159192, 3.143335…
$ yb   &lt;dbl&gt; 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0,…</code></pre>
</div>
</div>
<p>Now we can get <code>ggpredict</code>ing!</p>
</section>
<section id="ggpredict" class="level2">
<h2 class="anchored" data-anchor-id="ggpredict"><code>ggpredict()</code></h2>
<p>When you run <code>ggpredict()</code>, it produces a dataframe with a row for every unique value of a supplied predictor (“independent”) variable (<code>term</code>).</p>
<p>Each row contains an expected (estimated) value for the outcome (“dependent”) variable, plus confidence intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yn <span class="sc">~</span> num1 <span class="sc">+</span> fac1, <span class="at">data =</span> ex_dat)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>lm_1_est <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(lm_1, <span class="at">terms =</span> <span class="st">"num1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If desired, the argument <code>interval = "prediction"</code> will give predicted intervals instead.</p>
</section>
<section id="ggpredict-output" class="level2">
<h2 class="anchored" data-anchor-id="ggpredict-output"><code>ggpredict()</code> output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lm_1_est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of yn

num1 | Predicted |      95% CI
------------------------------
  -6 |     -0.01 | -1.59, 1.57
  -4 |      0.39 | -0.83, 1.61
  -2 |      0.79 | -0.12, 1.70
   0 |      1.19 |  0.48, 1.89
   2 |      1.58 |  0.87, 2.30
   4 |      1.98 |  1.05, 2.91
   6 |      2.38 |  1.13, 3.63

Adjusted for:
* fac1 = A</code></pre>
</div>
</div>
</section>
<section id="plot-for-ggpredict" class="level2">
<h2 class="anchored" data-anchor-id="plot-for-ggpredict"><code>plot()</code> for <code>ggpredict()</code></h2>
<p><code>ggeffects</code> features a <code>plot()</code> <em>method</em>, <code>plot.ggeffects()</code>, which produces a ggplot when you give <code>plot()</code> output from <code>ggpredict()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_1_est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="grouping-with-ggpredict" class="level2">
<h2 class="anchored" data-anchor-id="grouping-with-ggpredict">Grouping with <code>ggpredict()</code></h2>
<p>When using a vector of <code>terms</code>, <code>ggeffects</code> will plot the first along the x-axis and use others for <em>grouping</em>. Note we can pipe a model into <code>ggpredict()</code>!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(yb <span class="sc">~</span> num1 <span class="sc">+</span> fac1 <span class="sc">+</span> num2 <span class="sc">+</span> fac2, <span class="at">data =</span> ex_dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"num1"</span>, <span class="st">"fac1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-18-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="faceting-with-ggpredict" class="level2">
<h2 class="anchored" data-anchor-id="faceting-with-ggpredict">Faceting with <code>ggpredict()</code></h2>
<p>You can add <code>facet = TRUE</code> to the <code>plot()</code> call to facet over <em>grouping terms</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(yb <span class="sc">~</span> num1 <span class="sc">+</span> fac1 <span class="sc">+</span> num2 <span class="sc">+</span> fac2, <span class="at">data =</span> ex_dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"num1"</span>, <span class="st">"fac1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">facet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Data were 'prettified'. Consider using `terms="num1 [all]"` to get
  smooth plots.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="counterfactual-values" class="level2">
<h2 class="anchored" data-anchor-id="counterfactual-values">Counterfactual Values</h2>
<p>You can add values in square brackets in the <code>terms =</code> argument to specify counterfactual values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(yb <span class="sc">~</span> num1 <span class="sc">+</span> fac1 <span class="sc">+</span> num2 <span class="sc">+</span> fac2, <span class="at">data =</span> ex_dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"num1 [-1,0,1]"</span>, <span class="st">"fac1 [A,B]"</span>)) <span class="sc">%&gt;%</span> <span class="fu">plot</span>(<span class="at">facet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="representative-values" class="level2">
<h2 class="anchored" data-anchor-id="representative-values">Representative Values</h2>
<p>You can also use <code>[meansd]</code> or <code>[minmax]</code> to set representative values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(yb <span class="sc">~</span> num1 <span class="sc">+</span> fac1 <span class="sc">+</span> num2 <span class="sc">+</span> fac2, <span class="at">data =</span> ex_dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"num1 [meansd]"</span>, <span class="st">"num2 [minmax]"</span>)) <span class="sc">%&gt;%</span> <span class="fu">plot</span>(<span class="at">facet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dot-plots-with-ggpredict" class="level2">
<h2 class="anchored" data-anchor-id="dot-plots-with-ggpredict">Dot plots with <code>ggpredict()</code></h2>
<p><code>ggpredict</code> will produce dot plots with error bars for categorical predictors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(yn <span class="sc">~</span> fac1 <span class="sc">+</span> fac2, <span class="at">data =</span> ex_dat) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"fac1"</span>, <span class="st">"fac2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Ignoring unknown labels:
• linetype : "fac2"
• shape : "fac2"</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="scratch_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="notes-on-ggeffects" class="level2">
<h2 class="anchored" data-anchor-id="notes-on-ggeffects">Notes on <code>ggeffects</code></h2>
<p>There is a lot more to the <code>ggeffects</code> package that you can see in <a href="https://cran.r-project.org/web/packages/ggeffects/vignettes/marginaleffects.html">the package vignette</a> and the <a href="https://github.com/strengejacke/ggeffects">github repository</a>. This includes, but is not limited to:</p>
<ul>
<li>Predicted values for polynomial and interaction terms</li>
<li>Getting predictions from models from dozens of other packages</li>
<li>Sending <code>ggeffects</code> objects to <code>ggplot2</code> to freely modify plots</li>
</ul>
</section>
</section>
<section id="making-tables" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Making Tables</h1>
<section id="pander-regression-tables" class="level2">
<h2 class="anchored" data-anchor-id="pander-regression-tables"><code>pander</code> Regression Tables</h2>
<p>We’ve used <code>pander</code> to create nice tables for dataframes. But <code>pander</code> has <em>methods</em> to handle all sort of objects that you might want displayed nicely.</p>
<p>This includes model output, such as from <code>lm()</code>, <code>glm()</code>, and <code>summary()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pander-and-lm" class="level2">
<h2 class="anchored" data-anchor-id="pander-and-lm"><code>pander()</code> and <code>lm()</code></h2>
<p>You can send an <code>lm()</code> object straight to <code>pander</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(lm_1) <span class="co"># this creates an markdown-formatted chunk of text you can add to your qmd document</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<caption>Fitting linear model: yn ~ num1 + fac1</caption>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Std. Error</th>
<th style="text-align: center;">t value</th>
<th style="text-align: center;">Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">1.003</td>
<td style="text-align: center;">0.3866</td>
<td style="text-align: center;">2.594</td>
<td style="text-align: center;">0.01019</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>num1</strong></td>
<td style="text-align: center;">0.6407</td>
<td style="text-align: center;">0.1047</td>
<td style="text-align: center;">6.118</td>
<td style="text-align: center;">5.06e-09</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>fac1B</strong></td>
<td style="text-align: center;">1.675</td>
<td style="text-align: center;">0.5341</td>
<td style="text-align: center;">3.137</td>
<td style="text-align: center;">0.001972</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>fac1C</strong></td>
<td style="text-align: center;">2.16</td>
<td style="text-align: center;">0.5349</td>
<td style="text-align: center;">4.038</td>
<td style="text-align: center;">7.719e-05</td>
</tr>
</tbody>
</table>
</section>
<section id="pander-and-summary" class="level2">
<h2 class="anchored" data-anchor-id="pander-and-summary"><code>pander()</code> and <code>summary()</code></h2>
<p>You can do this with <code>summary()</code> as well, for added information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(lm_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Std. Error</th>
<th style="text-align: center;">t value</th>
<th style="text-align: center;">Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">1.003</td>
<td style="text-align: center;">0.3866</td>
<td style="text-align: center;">2.594</td>
<td style="text-align: center;">0.01019</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>num1</strong></td>
<td style="text-align: center;">0.6407</td>
<td style="text-align: center;">0.1047</td>
<td style="text-align: center;">6.118</td>
<td style="text-align: center;">5.06e-09</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>fac1B</strong></td>
<td style="text-align: center;">1.675</td>
<td style="text-align: center;">0.5341</td>
<td style="text-align: center;">3.137</td>
<td style="text-align: center;">0.001972</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>fac1C</strong></td>
<td style="text-align: center;">2.16</td>
<td style="text-align: center;">0.5349</td>
<td style="text-align: center;">4.038</td>
<td style="text-align: center;">7.719e-05</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<caption>Fitting linear model: yn ~ num1 + fac1</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Observations</th>
<th style="text-align: center;">Residual Std. Error</th>
<th style="text-align: center;"><span class="math inline">\(R^2\)</span></th>
<th style="text-align: center;">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">200</td>
<td style="text-align: center;">3.093</td>
<td style="text-align: center;">0.2126</td>
<td style="text-align: center;">0.2005</td>
</tr>
</tbody>
</table>
</section>
<section id="advanced-tables" class="level2">
<h2 class="anchored" data-anchor-id="advanced-tables">Advanced Tables</h2>
<p><code>pander</code> tables are great for basic <code>rmarkdown</code> documents, but they’re not generally publication ready.</p>
<p>We’re going to talk about a few different approaches for making nicer tables:</p>
<ul>
<li><p><code>gt</code> from RStudio for general table construction</p></li>
<li><p><code>modelsummary</code> for creating model tables</p></li>
<li><p><code>gtsummary</code> for creating data summaries</p></li>
</ul>
</section>
<section id="gt" class="level2">
<h2 class="anchored" data-anchor-id="gt"><code>gt</code></h2>
<p>If you need to more customizability or different output types, <a href="https://gt.rstudio.com/">RStudio’s <code>gt</code> package</a> is a new and powerful system for creating tables from dataframes. We’ll use <code>dplyr</code>’s built-in <code>starwars</code> data for some examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tes_chars <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(films) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(starships, <span class="at">keep_empty =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(films <span class="sc">==</span> <span class="st">"The Empire Strikes Back"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, species, starships, mass, height) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(name, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starships =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"Obi-Wan Kenobi"</span> <span class="sc">|</span> <span class="fu">is.na</span>(starships), </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"No Ship"</span>, starships))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tes_chars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 16
Columns: 5
$ name      &lt;chr&gt; "Luke Skywalker", "C-3PO", "R2-D2", "Darth Vader", "Leia Org…
$ species   &lt;chr&gt; "Human", "Droid", "Droid", "Human", "Human", "Human", "Wooki…
$ starships &lt;chr&gt; "X-wing", "No Ship", "No Ship", "TIE Advanced x1", "No Ship"…
$ mass      &lt;dbl&gt; 77.0, 75.0, 32.0, 136.0, 49.0, 77.0, 112.0, 80.0, 77.0, 17.0…
$ height    &lt;int&gt; 172, 167, 96, 202, 150, 182, 228, 180, 170, 66, 170, 183, 20…</code></pre>
</div>
</div>
</section>
<section id="initialize" class="level2">
<h2 class="anchored" data-anchor-id="initialize">Initialize</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>tes_chars <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>gt()</code> just renders the dataframe as a table using markdown.</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="wuxuhjphua" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wuxuhjphua table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wuxuhjphua thead, #wuxuhjphua tbody, #wuxuhjphua tfoot, #wuxuhjphua tr, #wuxuhjphua td, #wuxuhjphua th {
  border-style: none;
}

#wuxuhjphua p {
  margin: 0;
  padding: 0;
}

#wuxuhjphua .gt_table {
  display: table;
....

:::
:::

:::
::::

## Grouping {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt()
</div>
<p>If we <code>group_by()</code> first, the levels of the grouping variable become grouping rows in the table.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="hugbfppnkx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hugbfppnkx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hugbfppnkx thead, #hugbfppnkx tbody, #hugbfppnkx tfoot, #hugbfppnkx tr, #hugbfppnkx td, #hugbfppnkx th {
  border-style: none;
}

#hugbfppnkx p {
  margin: 0;
  padding: 0;
}

#hugbfppnkx .gt_table {
  display: table;
....

:::
:::

:::
::::

## Rownames {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name")
</div>
<p>Designating a <code>rowname_col</code> removes that column’s name and divides the values from the measures to the right.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="hpcshnnykn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hpcshnnykn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hpcshnnykn thead, #hpcshnnykn tbody, #hpcshnnykn tfoot, #hpcshnnykn tr, #hpcshnnykn td, #hpcshnnykn th {
  border-style: none;
}

#hpcshnnykn p {
  margin: 0;
  padding: 0;
}

#hpcshnnykn .gt_table {
  display: table;
....

:::
:::


:::
::::

## Header {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) 
</div>
<p><code>tab_header()</code> can add titles and subtitles.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="bvtkvulznr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bvtkvulznr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bvtkvulznr thead, #bvtkvulznr tbody, #bvtkvulznr tfoot, #bvtkvulznr tr, #bvtkvulznr td, #bvtkvulznr th {
  border-style: none;
}

#bvtkvulznr p {
  margin: 0;
  padding: 0;
}

#bvtkvulznr .gt_table {
  display: table;
....

:::
:::


:::
::::

## Spanner {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) %>%
  tab_spanner(
    label = "Vitals",
    columns = vars(mass, height)
  ) 
</div>
<p>A <code>tab_spanner()</code> lets us group columns together.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="pfujhpuiew" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pfujhpuiew table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pfujhpuiew thead, #pfujhpuiew tbody, #pfujhpuiew tfoot, #pfujhpuiew tr, #pfujhpuiew td, #pfujhpuiew th {
  border-style: none;
}

#pfujhpuiew p {
  margin: 0;
  padding: 0;
}

#pfujhpuiew .gt_table {
  display: table;
....

:::
:::

:::
::::

## Column Labels {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) %>%
  tab_spanner(
    label = "Vitals",
    columns = vars(mass, height)
  ) %>%
  cols_label(
    mass = "Mass (kg)",
    height = "Height (cm)",
    species = "Species"
  )
</div>
<p>We can directly change column names with <code>cols_label()</code></p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="zbkvlqpmmy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zbkvlqpmmy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zbkvlqpmmy thead, #zbkvlqpmmy tbody, #zbkvlqpmmy tfoot, #zbkvlqpmmy tr, #zbkvlqpmmy td, #zbkvlqpmmy th {
  border-style: none;
}

#zbkvlqpmmy p {
  margin: 0;
  padding: 0;
}

#zbkvlqpmmy .gt_table {
  display: table;
....

:::
:::


:::
::::

## Number Format {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) %>%
  tab_spanner(
    label = "Vitals",
    columns = vars(mass, height)
  ) %>%
  cols_label(
    mass = "Mass (kg)",
    height = "Height (cm)",
    species = "Species"
  ) %>%
  fmt_number(
    columns = vars(mass),
    decimals = 0) 
</div>
<p>We can adjust cell formats too.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.
Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="mgmnusftee" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mgmnusftee table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mgmnusftee thead, #mgmnusftee tbody, #mgmnusftee tfoot, #mgmnusftee tr, #mgmnusftee td, #mgmnusftee th {
  border-style: none;
}

#mgmnusftee p {
  margin: 0;
  padding: 0;
}

#mgmnusftee .gt_table {
  display: table;
....

:::
:::

:::
::::

## Align Columns {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) %>%
  tab_spanner(
    label = "Vitals",
    columns = vars(mass, height)
  ) %>%
  cols_label(
    mass = "Mass (kg)",
    height = "Height (cm)",
    species = "Species"
  ) %>%
  fmt_number(
    columns = vars(mass),
    decimals = 0
  ) %>%
  cols_align(
    align = "center",
    columns = vars(species, mass, height)
  )
</div>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.
Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.
Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="yowpwhytqm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yowpwhytqm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yowpwhytqm thead, #yowpwhytqm tbody, #yowpwhytqm tfoot, #yowpwhytqm tr, #yowpwhytqm td, #yowpwhytqm th {
  border-style: none;
}

#yowpwhytqm p {
  margin: 0;
  padding: 0;
}

#yowpwhytqm .gt_table {
  display: table;
....

:::
:::

:::
::::

## Reorder Groups {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}

```{.r .cell-code}
tes_chars %>% 
  group_by(starships) %>%
  gt(rowname_col = "name") %>%
  tab_header(
    title = "Star Wars Characters", 
    subtitle = "The Empire Strikes Back"
  ) %>%
  tab_spanner(
    label = "Vitals",
    columns = vars(mass, height)
  ) %>%
  cols_label(
    mass = "Mass (kg)",
    height = "Height (cm)",
    species = "Species"
  ) %>%
  fmt_number(
    columns = vars(mass),
    decimals = 0
  ) %>%
  cols_align(
    align = "center",
    columns = vars(species, mass, height)
  ) %>%
  row_group_order(
    groups = c("X-wing", 
               "Millennium Falcon")
  )
</div>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.
Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.
Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div id="ilktwfxdbh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ilktwfxdbh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ilktwfxdbh thead, #ilktwfxdbh tbody, #ilktwfxdbh tfoot, #ilktwfxdbh tr, #ilktwfxdbh td, #ilktwfxdbh th {
  border-style: none;
}

#ilktwfxdbh p {
  margin: 0;
  padding: 0;
}

#ilktwfxdbh .gt_table {
  display: table;
....

:::
:::

:::
::::

## Big Improvement! {.scrollable}

:::: {.columns}
::: {.column width="50%"}

::: {.cell}
::: {.cell-output-display}

```{=html}
<div id="qaqyqhtndj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qaqyqhtndj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qaqyqhtndj thead, #qaqyqhtndj tbody, #qaqyqhtndj tfoot, #qaqyqhtndj tr, #qaqyqhtndj td, #qaqyqhtndj th {
  border-style: none;
}

#qaqyqhtndj p {
  margin: 0;
  padding: 0;
}

#qaqyqhtndj .gt_table {
  display: table;
....

:::
:::

:::
::: {.column width="50%"}

::: {.cell}
::: {.cell-output .cell-output-stderr}

<p>Warning: Since gt v0.3.0, <code>columns = vars(...)</code> has been deprecated. • Please use <code>columns = c(...)</code> instead. Since gt v0.3.0, <code>columns = vars(...)</code> has been deprecated. • Please use <code>columns = c(...)</code> instead. Since gt v0.3.0, <code>columns = vars(...)</code> has been deprecated. • Please use <code>columns = c(...)</code> instead.</p>
<pre><code>

:::

::: {.cell-output-display}

```{=html}
&lt;div id=&quot;qholhjviwx&quot; style=&quot;padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;&quot;&gt;
&lt;style&gt;#qholhjviwx table {
  font-family: system-ui, &#39;Segoe UI&#39;, Roboto, Helvetica, Arial, sans-serif, &#39;Apple Color Emoji&#39;, &#39;Segoe UI Emoji&#39;, &#39;Segoe UI Symbol&#39;, &#39;Noto Color Emoji&#39;;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qholhjviwx thead, #qholhjviwx tbody, #qholhjviwx tfoot, #qholhjviwx tr, #qholhjviwx td, #qholhjviwx th {
  border-style: none;
}

#qholhjviwx p {
  margin: 0;
  padding: 0;
}

#qholhjviwx .gt_table {
  display: table;
....

:::
:::

:::
::::

## $\LaTeX$ Tables

`gt` is a very new package and is somewhat finicky when used in `.pdf` documents.

For tables in $\LaTeX$—as is needed for `.pdf` files—I recommend also looking into the `kableExtra` or `flextable` packages.

. . . 

Like `gt`, `kableExtra` and `flextable` allow the construction of complex tables in either HTML or $\LaTeX$ using
additive syntax similar to `ggplot2` and `dplyr`. `flextable` is also great for Word tables.

. . . 

If you want to edit $\LaTeX$ documents, you can do it in R using Sweave documents (.Rnw).
Alternatively, you may want to work in a dedicated $\LaTeX$ editor. I recommend [Overleaf](http://www.overleaf.com)
for this purpose.

. . . 

RMarkdown has support for a fair amount of basic $\LaTeX$ syntax if you aren&#39;t trying to 
get too fancy!

## `flextable` {.scrollable}

:::: {.columns}
::: {.column width=&quot;50%&quot;}
This is a table produced by `flextable` in Word format--including the embedded density images^[Embedding summary plots is a bit complicated and requires [list columns](https://ardata-fr.github.io/flextable-book/cell-content.html#mini-charts)]!

Look into `flextable` if you&#39;ll be working in Word or want a table package that handles just about every format.

:::
::: {.column width=&quot;50%&quot;}
![](images/flextable.png)
:::
::::

## `modelsummary`

The `modelsummary` package combines `broom`, `gt`, `flextable`, and `kableExtra` to produce tabular summaries of almost any model fit in R.

An advantage of this package is that it can produce output in every common format: HTML, Markdown, $\LaTeX$, raw text, and even images (`.png` or `.jpg`).


::: {.cell}

```{.r .cell-code}
library(modelsummary)</code></pre>
</div>
<p>Its key function is <code>msummary()</code> or <code>modelsummary()</code> which creates summary tables of models.</p>
<p>You can then build on it using <code>gt</code>, <code>flextable</code>, or <code>kableExtra</code> functions, depending on the selected output format.</p>
<section id="msummary" class="level2">
<h2><code>msummary</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Like <code>pander()</code>, <code>msummary()</code> takes a model as an object to make a table.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(mod_1)</span></code></pre></div>
</div>
<p>Note default <code>modelsummary</code> look like <code>pander</code> tables because they use Markdown.</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_vldkuvcsygjy76a5xj0o(i, j, css_id) {
          var table = document.getElementById("tinytable_vldkuvcsygjy76a5xj0o");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_vldkuvcsygjy76a5xj0o(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_vldkuvcsygjy76a5xj0o");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
....

:::
:::

:::
::::

## `msummary` {.scrollable}

:::: {.columns}
::: {.column width="50%"}
You can present multiple models in `msummary` using named lists:


::: {.cell}

```{.r .cell-code}
mod_1 <- lm(mpg ~ wt, data = mtcars)
mod_2 <- lm(mpg ~ hp + wt, data = mtcars)
mod_3 <- lm(mpg ~ hp + wt + factor(am), 
            data = mtcars)
model_list <- list("Model 1" = mod_1, 
                   "Model 2" = mod_2, 
                   "Model 3" = mod_3)
msummary(model_list)
</div>
<p>This allows you to produce the common (and often bad) journal format where one starts with a nonsensical “naive model” then works up to the “full model” justified by the front end of the paper.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_id28x5d2gzl9rafl1ihg(i, j, css_id) {
          var table = document.getElementById("tinytable_id28x5d2gzl9rafl1ihg");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_id28x5d2gzl9rafl1ihg(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_id28x5d2gzl9rafl1ihg");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
....

:::
:::


:::
::::

## PDF Output

`output = "latex"` produces `kableExtra` based output well-suited to PDFs.<sup>1</sup>


::: {.cell}

```{.r .cell-code}
msummary(model_list, output = "latex")
</div>
<p><img src="images/ex_table_latex.PNG" class="img-fluid" /></p>
<p>For customization, I recommend referring to <a href="https://modelsummary.com/articles/appearance.html"><code>modelsummary</code>’s documentation</a>.</p>
<section id="saving-a-modelsummary" class="level2">
<h2>Saving a <code>modelsummary</code></h2>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(model_list, <span class="at">output =</span> <span class="st">&quot;ex_table.png&quot;</span>)</span></code></pre></div>
</div>
<p>To save a <code>modelsummary</code> object as a file, just provide a path to the <code>output =</code> argument.</p>
<p>Specifying a suffix (e.g., <code>.png</code> or <code>.pdf</code>) will control the output format.</p>
</section>
<section id="modelsummary-and-gt" class="level2">
<h2><code>modelsummary</code> and <code>gt</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>You can select <code>gt</code> output to enable modifying summaries with <code>gt</code> functions.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">msummary</span>(model_list, <span class="at">output =</span> <span class="st">&quot;gt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Table 1. Linear Models&quot;</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;DV: Miles per Gallon&quot;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<p>Note that <code>gt</code>’s support for PDF output is immature–this format is better for HTML or image output.</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="dmedafkgxl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dmedafkgxl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dmedafkgxl thead, #dmedafkgxl tbody, #dmedafkgxl tfoot, #dmedafkgxl tr, #dmedafkgxl td, #dmedafkgxl th {
  border-style: none;
}

#dmedafkgxl p {
  margin: 0;
  padding: 0;
}

#dmedafkgxl .gt_table {
  display: table;
....

:::
:::

:::
::::
## `gtsummary`

The `gtsummary` package is similar to `modelsummary` in that it takes advantage of `broom`, `gt`, and `kableExtra` to provide a flexible table-making framework.

While `gtsummary` can also produce model tables like `modelsummary`, it also produces descriptive statistic tables for dataframes^[I prefer `modelsummary`'s syntax (or manual table building) for most model tables.].


::: {.cell}

```{.r .cell-code}
library(gtsummary)
</div>
<section id="tbl_summary" class="level2">
<h2><code>tbl_summary()</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>By default, <code>gtsummary</code> tables provide:</p>
<ul>
<li>Frequencies for categorical and binary variables</li>
<li>Quantiles of the form “50% (25%, 75%)” for continuous variables</li>
<li>Sample size</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>() </span></code></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="qjskbmqliq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qjskbmqliq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qjskbmqliq thead, #qjskbmqliq tbody, #qjskbmqliq tfoot, #qjskbmqliq tr, #qjskbmqliq td, #qjskbmqliq th {
  border-style: none;
}

#qjskbmqliq p {
  margin: 0;
  padding: 0;
}

#qjskbmqliq .gt_table {
  display: table;
....

:::
:::

:::
::::

## Grouping

:::: {.columns}
::: {.column width="50%"}
You can provide a `by = ` argument to do grouped descriptives.


::: {.cell}

```{.r .cell-code}
mtcars %>% 
  select(1:9) %>%
  tbl_summary(by = "am") 
</div>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="emhzktzptr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#emhzktzptr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#emhzktzptr thead, #emhzktzptr tbody, #emhzktzptr tfoot, #emhzktzptr tr, #emhzktzptr td, #emhzktzptr th {
  border-style: none;
}

#emhzktzptr p {
  margin: 0;
  padding: 0;
}

#emhzktzptr .gt_table {
  display: table;
....

:::
:::

:::
::::

## Adding `gt`
:::: {.columns}
::: {.column width="50%"}
If you select `gt` output, you can dress it up with `gt` functions.


::: {.cell}

```{.r .cell-code}
mtcars %>% 
  select(1:9) %>%
  tbl_summary(by = "am") %>%
  as_gt() %>%
  tab_spanner(
    label = "Transmission", 
    columns = starts_with("stat_")
  ) %>%
  tab_header(
    title = "Motor Trend Cars", 
    subtitle = "Descriptive Statistics"
  )
</div>
<p><code>starts\_with("stat\_")</code> here selects the statistic columns created by <code>tbl_summary()</code>.</p>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="vxdswekmsm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vxdswekmsm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vxdswekmsm thead, #vxdswekmsm tbody, #vxdswekmsm tfoot, #vxdswekmsm tr, #vxdswekmsm td, #vxdswekmsm th {
  border-style: none;
}

#vxdswekmsm p {
  margin: 0;
  padding: 0;
}

#vxdswekmsm .gt_table {
  display: table;
....

:::
:::

:::
::::

## Bonus: `corrplot`

The `corrplot` package has functions for displaying correlograms.

These make interpreting the correlations between variables in a data set easier than conventional correlation tables.

The first argument is a call to `cor()`, the base R function for generating a correlation matrix.

[See the vignette for customization options.](https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html)


::: {.cell}

```{.r .cell-code}
library(corrplot)
corrplot(
  cor(mtcars),
  addCoef.col = "white",
  addCoefasPercent=T,
  type="upper", 
  order="AOE")
</div>
<section id="correlogram" class="level2">
<h2>Correlogram</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="scratch_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reproducibility-next-steps" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Reproducibility Next Steps</h1>
<section id="research-compendia" class="level2">
<h2>Research Compendia</h2>
<p>A <strong>research compendium</strong> is a portable, reproducible distribution of an article or other project.</p>
<p>. . .</p>
<p>Research compendia feature:</p>
<ul>
<li><p>An interactive document as the foundation</p></li>
<li><p>Files organized in a recognizable structure (e.g. an R package)</p></li>
<li><p>Clear separation of data, method, and output. <em>Data are read only</em>.</p></li>
<li><p>A well-documented or even <em>preserved</em> computational environment (e.g. Docker)</p></li>
</ul>
<p>. . .</p>
<p><code>rrtools</code> by UW’s <a href="https://github.com/benmarwick">Ben Markwick</a> provides a simplified workflow to accomplish this in R.</p>
</section>
<section id="bookdown" class="level2">
<h2>Bookdown</h2>
<p><a href="https://bookdown.org/yihui/bookdown/"><code>bookdown</code></a> — which is integrated into <code>rrtools</code> — can generate documents in the proper format for articles, theses, books, or dissertations.</p>
<p>. . .</p>
<p><code>bookdown</code> provides an accessible alternative to writing <span class="math inline">\(\LaTeX\)</span> for typesetting and reference management.</p>
<p>. . .</p>
<p>You can integrate citations and automate reference page generation using bibtex files (such as produced by Zotero).</p>
<p>. . .</p>
<p><code>bookdown</code> supports <code>.html</code> output for ease and speed and also renders <code>.pdf</code> files through <span class="math inline">\(\LaTeX\)</span> for publication-ready documents.</p>
<p>. . .</p>
<p>For University of Washington theses and dissertations, consider Ben Marwick’s <a href="https://github.com/benmarwick/huskydown"><code>huskydown</code> package</a> which uses Markdown but renders via a UW approved <span class="math inline">\(\LaTeX\)</span> template.</p>
</section>
</section>
<section id="best-practices-1" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Best Practices</h1>
</section>
<section id="tools-some-opinionated-advice" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Tools (<em>some opinionated advice</em>)</h1>
<section id="on-formats" class="level2">
<h2>On Formats</h2>
<p>Avoid “closed” or commercial software and file formats except where absolutely necessary.</p>
<p>. . .</p>
<p>Use open source software and file formats.</p>
<p>. . .</p>
<ul>
<li><p>It is always better for <em>science</em>:</p>
<ul>
<li>People should be able to explore your research without buying commercial software.</li>
<li>You do not want your research to be inaccessible when software is updated.</li>
</ul></li>
</ul>
<p>. . .</p>
<ul>
<li><p>It is often just <em>better</em>.</p>
<ul>
<li>It is usually updated more quickly</li>
<li>It tends to be more secure</li>
<li>It is rarely abandoned</li>
</ul></li>
</ul>
<p>. . .</p>
<p><strong>The ideal:</strong> Use software that reads and writes <em>raw text</em>.</p>
</section>
<section id="text" class="level2">
<h2>Text</h2>
<p>Writing and formatting documents are two completely separate jobs.</p>
<ul>
<li>Write first</li>
<li>Format later</li>
<li><a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> was made for this</li>
</ul>
<p>. . .</p>
<p>Word processors — like Microsoft Word — try to do both at the same time, usually badly.</p>
<p>They waste time by leading you to format instead of writing.</p>
<p>. . .</p>
<p>Find a good modular text editor and learn to use it:</p>
<ul>
<li><a href="https://atom.io/">Atom</a></li>
<li><a href="https://www.sublimetext.com/">Sublime</a> (Commercial)</li>
<li>Emacs</li>
<li>Vim</li>
</ul>
</section>
</section>
<section id="version-control" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Version Control</h1>
<section id="version-control-1" class="level2">
<h2>Version Control</h2>
<p>Version control originates in collaborative software development.</p>
<p><strong>The Idea:</strong> All changes ever made to a piece of software are documented, saved automatically, and revertible.</p>
<p>. . .</p>
<p>Version control allows all decisions ever made in a research project to be documented automatically.</p>
<p>. . .</p>
<p>Version control can:</p>
<ol type="1">
<li>Protect your work from destructive changes</li>
<li>Simplify collaboration by merging changes</li>
<li>Document design decisions</li>
<li>Make your research process transparent</li>
</ol>
</section>
<section id="git-and-github" class="level2">
<h2>Git and GitHub</h2>
<p><a href="https://en.wikipedia.org/wiki/Git"><code>git</code></a> is the dominant platform for version control, and <a href="https://github.com/">GitHub</a> is a free (and now Microsoft owned) platform for hosting <strong>repositories</strong>.</p>
<p>. . .</p>
<p><strong>Repositories</strong> are folders on your computer where all changes are tracked by Git.</p>
<p>. . .</p>
<p>Once satisfied with changes, you “commit” them then “push” them to a remote repository that stores your project.</p>
<p>. . .</p>
<p>Others can copy your project (“pull”), and if you permit, make suggestions for changes.</p>
<p>. . .</p>
<p>Constantly committing and pulling changes automatically generates a running “history” that documents the evolution of a project.</p>
<p>. . .</p>
<p><code>git</code> is integrated into RStudio under the <em>Tools</em> menu. <a href="http://happygitwithr.com/">It requires some setup.</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
<section id="github-as-a-cv" class="level2">
<h2>GitHub as a CV</h2>
<p>Beyond archiving projects and allowing sharing, GitHub also serves as a sort of curriculum vitae for the programmer.</p>
<p>. . .</p>
<p>By allowing others to view your projects, you can display competence in programming and research.</p>
<p>. . .</p>
<p>If you are planning on working in the private sector, an active GitHub profile will give you a leg up on the competition.</p>
<p>. . .</p>
<p>If you are aiming for academia, a GitHub account signals technical competence and an interest in research transparency.</p>
</section>
</section>
<section id="wrapping-up-the-course-1" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Wrapping up the Course</h1>
<section id="what-youve-learned" class="level2">
<h2>What You’ve Learned</h2>
<p>A lot!</p>
<ul>
<li>How to get data into R from a variety of formats</li>
<li>How to do “data custodian” work to manipulate and clean data</li>
<li>How to make pretty visualizations</li>
<li>How to automate with loops and functions</li>
<li>How to combine text, calculations, plots, and tables into dynamic R Markdown reports</li>
</ul>
</section>
<section id="what-comes-next" class="level2">
<h2>What Comes Next?</h2>
<ul>
<li>Statistical inference (e.g. more CSSS courses)
<ul>
<li>Functions for hypothesis testing, hierarchical/mixed effect models, machine learning, survey design, etc. are straightforward to use… once data are clean</li>
<li>Access output by working with list structures (like from regression models) or using <code>broom</code> and <code>ggeffects</code></li>
</ul></li>
<li>Practice, practice, practice!
<ul>
<li>Replicate analyses you’ve done in Excel, SPSS, or Stata</li>
<li>Think about data using <code>dplyr</code> verbs, tidy data principles</li>
<li>Quarto for reproducibility</li>
</ul></li>
<li>More advanced projects
<ul>
<li>Using version control (git) in RStudio</li>
<li>Interactive Shiny web apps</li>
<li>Write your own functions and put them in a package</li>
</ul></li>
</ul>
</section>
<section id="course-plugs" class="level2">
<h2>Course Plugs</h2>
<p>If you…</p>
<ul>
<li>have no stats background yet - <strong>SOC504: Applied Social Statistics</strong></li>
<li>have (only) finished SOC506 - <strong>CSSS510: Maximum Likelihood</strong></li>
<li>want to master visualization - <strong>CSSS569: Visualizing Data</strong></li>
<li>study events or durations - <strong>CSSS544: Event History Analysis</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>want to use network data - <strong>CSSS567: Social Network Analysis</strong></li>
<li>want to work with spatial data - <strong>CSSS554: Spatial Statistics</strong></li>
<li>want to work with time series - <strong>CSSS512: Time Series and Panel Data</strong></li>
</ul>
</section>
</section>
<section id="thank-you" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Thank you!</h1>
</section>
<section id="supplementary-material" class="level1 section-title" data-background-color="#99a486">
<h1 class="section-title" data-background-color="#99a486">Supplementary Material</h1>
<section id="sjplot" class="level2">
<h2><code>sjPlot</code></h2>
<p><code>pander</code> tables are great for basic <code>rmarkdown</code> documents, but they’re not generally publication ready.</p>
<p>The <code>sjPlot</code> package produces <code>html</code> tables that look more like those you may find in journal articles.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: &#39;sjPlot&#39;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from &#39;package:ggplot2&#39;:

    set_theme</code></pre>
</div>
</div>
</section>
<section id="sjplot-tables" class="level2">
<h2><code>sjPlot</code> Tables</h2>
<p><code>tab_model()</code> will produce tables for most models.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(model_1)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
mpg
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
37.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
33.45 – 41.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
wt
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-5.34
</td>
<p>….</p>
<p>:::</p>
<p>:::</p>
<section id="multi-model-tables-with-sjtable" class="level2">
<h2>Multi-Model Tables with <code>sjTable</code></h2>
<p>Often in journal articles you will see a single table that compares multiple models.</p>
<p>Typically, authors will start with a simple model on the left, then add variables, until they have their most complex model on the right.</p>
<p>The <code>sjPlot</code> package makes this easy to do: just give <code>tab_model()</code> more models!</p>
</section>
<section id="multiple-tab_model" class="level2">
<h2>Multiple <code>tab_model()</code></h2>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> <span class="fu">factor</span>(am), <span class="at">data =</span> mtcars)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(model_1, model_2, model_3)</span></code></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
mpg
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
mpg
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
mpg
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
p
</td>
</tr>
<tr>
<p>….</p>
<p>:::</p>
<p>:::</p>
<section id="sjplot-does-a-lot-more" class="level2">
<h2><code>sjPlot</code> does a lot more</h2>
<p>The <code>sjPlot</code> package does <em>a lot</em> more than just make pretty tables. It is a rabbit holeof <em>incredibly</em> powerful and useful functions for displaying descriptive and inferential results.</p>
<p>View the <a href="http://www.strengejacke.de/sjPlot/">package website</a> for extensive documentation.</p>
<p><code>sjPlot</code> is a bit more complicated than <code>ggeffects</code> but can do just about everything it can do as well; they were written by the same author!</p>
<p><code>sjPlot</code> is fairly new but offers a fairly comprehensive solution for <code>ggplot</code> based publication-ready social science data visualization. All graphical functions in <code>sjPlot</code> are based on <code>ggplot2</code>, so it should not take terribly long to figure out.</p>
</section>
<section id="sjplot-example-likert-plots" class="level2">
<h2><code>sjPlot</code> Example: Likert plots</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img src="images/sjPlot_likert.PNG" class="img-fluid" width="600" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sjplot-example-crosstabs" class="level2">
<h2><code>sjPlot</code> Example: Crosstabs</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img src="images/sjPlot_crosstab.PNG" class="img-fluid" width="500" /></p>
</figure>
</div>
</div>
</div>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyLXRpdGxl">scratch</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXItdGl0bGU=">scratch</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6SG9tZQ==">Home</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6aHR0cDovL3ZzYXNzLmdpdGh1Yi5pbw==">http://vsass.github.io</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6Q1MmU1MgNTA4">CS&amp;SS 508</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L2luZGV4Lmh0bWw=">/index.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6U3lsbGFidXM=">Syllabus</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L3N5bGxhYnVzLmh0bWw=">/syllabus.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6TGVjdHVyZXM=">Lectures</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L0xlY3R1cmVzL2xlY3R1cmVzLmh0bWw=">/Lectures/lectures.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6SG9tZXdvcms=">Homework</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L0hvbWV3b3JrL2hvbWV3b3JrLmh0bWw=">/Homework/homework.html</span></p>
<div class="hidden quarto-markdown-envelope-contents" data-render-id="Zm9vdGVyLWxlZnQ=">
<p>Created with <a href="https://quarto.org/">Quarto</a> • <a href="https://creativecommons.org/licenses/by-nc/4.0/">License</a></p>
</div>
<div class="hidden quarto-markdown-envelope-contents" data-render-id="Zm9vdGVyLWNlbnRlcg==">
<p>Copyright © 2023 Victoria Sass <br> Course content adapted from <a href="https://clanfear.github.io/CSSS508/">Chuck Lanfear</a> and <a href="https://pearce790.github.io/CSSS508/index.html">Michael Pearce</a></p>
</div>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGF0aXRsZQ==">scratch</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=">scratch</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZHRpdGxl">scratch</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw=="></span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZGRkZXNj"></span></p>
</div>
</section>
</div>
</div>
</section>
</div>
</div>
</section>
</section>
</div>
</div>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>You can also use the <a href="https://desktop.github.com/">GitHub desktop application</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Also a great maximum likelihood introduction.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <div class='footer-contents'>Created with [Quarto](https://quarto.org/) • [License](https://creativecommons.org/licenses/by-nc/4.0/)</div>  
    </div>   
    <div class="nav-footer-center">
      <div class='footer-contents'>Copyright © 2023 Victoria Sass <br> Course content adapted from [Chuck Lanfear](https://clanfear.github.io/CSSS508/) and [Michael Pearce](https://pearce790.github.io/CSSS508/index.html)</div>  
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:vsass@uw.edu">
      <i 
  class="bi bi-envelope-at" 
  role="img" 
>
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=A3lEdiIAAAAJ&amp;hl=en">
      <i 
  class="bi bi-google" 
  role="img" 
>
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vsass">
      <i 
  class="bi bi-github" 
  role="img" 
>
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="http://vsass.github.io/Sass_Victoria_CV_2023.pdf">
      <i 
  class="bi bi-file-person" 
  role="img" 
>
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>

</body>

</html>
</style></div></div></div></div></div></section></section></main></div></body></html>